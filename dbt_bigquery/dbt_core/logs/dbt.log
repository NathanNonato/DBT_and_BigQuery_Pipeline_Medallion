[0m12:35:00.931134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34130>]}


============================== 12:35:00.935273 | 6f5e4488-f6c8-4bf1-8bfe-88f6a2a4e2f5 ==============================
[0m12:35:00.935273 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:35:00.935847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:35:00.949999 [info ] [MainThread]: dbt version: 1.10.5
[0m12:35:00.950445 [info ] [MainThread]: python version: 3.9.6
[0m12:35:00.950778 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m12:35:00.951094 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m12:35:03.416325 [info ] [MainThread]: Using profiles dir at /Users/bi006217/.dbt
[0m12:35:03.416815 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/.dbt/profiles.yml
[0m12:35:03.417156 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m12:35:03.417491 [info ] [MainThread]: adapter type: bigquery
[0m12:35:03.417801 [info ] [MainThread]: adapter version: 1.10.0
[0m12:35:03.520264 [info ] [MainThread]: Configuration:
[0m12:35:03.520742 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:35:03.521074 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:35:03.521382 [info ] [MainThread]: Required dependencies:
[0m12:35:03.521914 [debug] [MainThread]: Executing "git --help"
[0m12:35:03.549581 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:35:03.550461 [debug] [MainThread]: STDERR: "b''"
[0m12:35:03.550860 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:35:03.551219 [info ] [MainThread]: Connection:
[0m12:35:03.551660 [info ] [MainThread]:   method: service-account
[0m12:35:03.551973 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m12:35:03.552384 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m12:35:03.552795 [info ] [MainThread]:   schema: raw
[0m12:35:03.553119 [info ] [MainThread]:   location: US
[0m12:35:03.553429 [info ] [MainThread]:   priority: interactive
[0m12:35:03.553729 [info ] [MainThread]:   maximum_bytes_billed: None
[0m12:35:03.554026 [info ] [MainThread]:   impersonate_service_account: None
[0m12:35:03.554315 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m12:35:03.554603 [info ] [MainThread]:   job_retries: 1
[0m12:35:03.554893 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m12:35:03.555182 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m12:35:03.555468 [info ] [MainThread]:   timeout_seconds: 300
[0m12:35:03.555753 [info ] [MainThread]:   client_id: None
[0m12:35:03.556647 [info ] [MainThread]:   token_uri: None
[0m12:35:03.557129 [info ] [MainThread]:   compute_region: None
[0m12:35:03.557497 [info ] [MainThread]:   dataproc_cluster_name: None
[0m12:35:03.557812 [info ] [MainThread]:   gcs_bucket: None
[0m12:35:03.558110 [info ] [MainThread]:   dataproc_batch: None
[0m12:35:03.558747 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:35:03.828796 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m12:35:03.829367 [debug] [MainThread]: On debug: select 1 as id
[0m12:35:03.829733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:05.476236 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:US:b05a83c8-92f5-4e23-a919-56df2afca588&page=queryresults
[0m12:35:06.279312 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:35:06.280552 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:35:06.288395 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.435867, "process_in_blocks": "0", "process_kernel_time": 0.707154, "process_mem_max_rss": "342441984", "process_out_blocks": "0", "process_user_time": 3.327144}
[0m12:35:06.289233 [debug] [MainThread]: Command `dbt debug` succeeded at 12:35:06.289061 after 5.44 seconds
[0m12:35:06.289750 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:35:06.290292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135fc7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135fc77c0>]}
[0m12:35:06.290933 [debug] [MainThread]: Flushing usage events
[0m12:35:07.636692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:30.856988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033761f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043eab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ea160>]}


============================== 12:36:30.861540 | 1be1cb2f-7db6-42ed-9407-68b563bbe44f ==============================
[0m12:36:30.861540 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:36:30.862164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:36:33.678947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cdf100>]}
[0m12:36:33.738496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc7310>]}
[0m12:36:33.739137 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:36:34.015926 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:36:34.016983 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:36:34.017445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1362420a0>]}
[0m12:36:35.371939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369c9130>]}
[0m12:36:35.466364 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:36:35.469462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:36:35.492965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a0c340>]}
[0m12:36:35.493490 [info ] [MainThread]: Found 2 models, 4 data tests, 494 macros
[0m12:36:35.493858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a01250>]}
[0m12:36:35.495131 [info ] [MainThread]: 
[0m12:36:35.495509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:35.495821 [info ] [MainThread]: 
[0m12:36:35.496304 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:35.500995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m12:36:35.501421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:36.535673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m12:36:36.536969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:37.943953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369c9910>]}
[0m12:36:37.945643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:37.958557 [debug] [Thread-1  ]: Began running node model.dbt_core.my_first_dbt_model
[0m12:36:37.959653 [info ] [Thread-1  ]: 1 of 2 START sql table model raw.my_first_dbt_model ............................ [RUN]
[0m12:36:37.960488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.my_first_dbt_model)
[0m12:36:37.961006 [debug] [Thread-1  ]: Began compiling node model.dbt_core.my_first_dbt_model
[0m12:36:37.974656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.my_first_dbt_model"
[0m12:36:37.976227 [debug] [Thread-1  ]: Began executing node model.dbt_core.my_first_dbt_model
[0m12:36:38.020370 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.my_first_dbt_model"
[0m12:36:38.022101 [debug] [Thread-1  ]: On model.dbt_core.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.my_first_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:36:38.022564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:39.814857 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:eba7b078-df2c-4fcb-88ed-4f8f3455fae2&page=queryresults
[0m12:36:42.459325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13698e460>]}
[0m12:36:42.460297 [info ] [Thread-1  ]: 1 of 2 OK created sql table model raw.my_first_dbt_model ....................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.50s]
[0m12:36:42.461016 [debug] [Thread-1  ]: Finished running node model.dbt_core.my_first_dbt_model
[0m12:36:42.461860 [debug] [Thread-1  ]: Began running node model.dbt_core.my_second_dbt_model
[0m12:36:42.462509 [info ] [Thread-1  ]: 2 of 2 START sql view model raw.my_second_dbt_model ............................ [RUN]
[0m12:36:42.463086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.my_first_dbt_model, now model.dbt_core.my_second_dbt_model)
[0m12:36:42.463517 [debug] [Thread-1  ]: Began compiling node model.dbt_core.my_second_dbt_model
[0m12:36:42.467990 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.my_second_dbt_model"
[0m12:36:42.468887 [debug] [Thread-1  ]: Began executing node model.dbt_core.my_second_dbt_model
[0m12:36:42.490580 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.my_second_dbt_model"
[0m12:36:42.491511 [debug] [Thread-1  ]: On model.dbt_core.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.my_second_dbt_model"} */


  create or replace view `dbtandbigquery-467100`.`raw`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbtandbigquery-467100`.`raw`.`my_first_dbt_model`
where id = 1;


[0m12:36:42.491962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:43.608063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:65900693-4f36-43ff-94b6-4858aab3c727&page=queryresults
[0m12:36:44.139091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be1cb2f-7db6-42ed-9407-68b563bbe44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136af3fa0>]}
[0m12:36:44.140908 [info ] [Thread-1  ]: 2 of 2 OK created sql view model raw.my_second_dbt_model ....................... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m12:36:44.142056 [debug] [Thread-1  ]: Finished running node model.dbt_core.my_second_dbt_model
[0m12:36:44.143839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:36:44.146322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:44.147190 [debug] [MainThread]: Connection 'model.dbt_core.my_second_dbt_model' was properly closed.
[0m12:36:44.147746 [info ] [MainThread]: 
[0m12:36:44.148186 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m12:36:44.149039 [debug] [MainThread]: Command end result
[0m12:36:44.298556 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:36:44.300586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:36:44.307094 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m12:36:44.307434 [info ] [MainThread]: 
[0m12:36:44.307879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:44.308202 [info ] [MainThread]: 
[0m12:36:44.308536 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:36:44.312588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.533753, "process_in_blocks": "0", "process_kernel_time": 0.841075, "process_mem_max_rss": "356466688", "process_out_blocks": "0", "process_user_time": 5.357014}
[0m12:36:44.313013 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:44.312931 after 13.53 seconds
[0m12:36:44.313370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033761f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a0c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103609be0>]}
[0m12:36:44.313741 [debug] [MainThread]: Flushing usage events
[0m12:36:46.156512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:31.338873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104646190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8130>]}


============================== 12:41:31.343169 | 3c4d233d-9e0c-43fd-8a8e-b0e37011682d ==============================
[0m12:41:31.343169 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:41:31.343730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:31.358433 [info ] [MainThread]: dbt version: 1.10.5
[0m12:41:31.358891 [info ] [MainThread]: python version: 3.9.6
[0m12:41:31.359227 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m12:41:31.359545 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m12:41:34.065823 [info ] [MainThread]: Using profiles dir at /Users/bi006217/.dbt
[0m12:41:34.066320 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/.dbt/profiles.yml
[0m12:41:34.066657 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m12:41:34.066990 [info ] [MainThread]: adapter type: bigquery
[0m12:41:34.067297 [info ] [MainThread]: adapter version: 1.10.0
[0m12:41:34.172107 [info ] [MainThread]: Configuration:
[0m12:41:34.172630 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:41:34.172973 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:41:34.173286 [info ] [MainThread]: Required dependencies:
[0m12:41:34.173860 [debug] [MainThread]: Executing "git --help"
[0m12:41:34.205055 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:41:34.206135 [debug] [MainThread]: STDERR: "b''"
[0m12:41:34.206557 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:41:34.206940 [info ] [MainThread]: Connection:
[0m12:41:34.207402 [info ] [MainThread]:   method: service-account
[0m12:41:34.207709 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m12:41:34.208018 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m12:41:34.208309 [info ] [MainThread]:   schema: raw
[0m12:41:34.208602 [info ] [MainThread]:   location: us-central1
[0m12:41:34.208890 [info ] [MainThread]:   priority: interactive
[0m12:41:34.209179 [info ] [MainThread]:   maximum_bytes_billed: None
[0m12:41:34.209474 [info ] [MainThread]:   impersonate_service_account: None
[0m12:41:34.209761 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m12:41:34.210045 [info ] [MainThread]:   job_retries: 1
[0m12:41:34.210338 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m12:41:34.210620 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m12:41:34.210907 [info ] [MainThread]:   timeout_seconds: 300
[0m12:41:34.211189 [info ] [MainThread]:   client_id: None
[0m12:41:34.212140 [info ] [MainThread]:   token_uri: None
[0m12:41:34.212555 [info ] [MainThread]:   compute_region: None
[0m12:41:34.212882 [info ] [MainThread]:   dataproc_cluster_name: None
[0m12:41:34.213183 [info ] [MainThread]:   gcs_bucket: None
[0m12:41:34.213485 [info ] [MainThread]:   dataproc_batch: None
[0m12:41:34.214144 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:41:34.483341 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m12:41:34.483945 [debug] [MainThread]: On debug: select 1 as id
[0m12:41:34.484331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:36.475012 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1224053c-d9b0-4620-a5da-2f980c03e883&page=queryresults
[0m12:41:37.225751 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:41:37.226795 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:41:37.235369 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.9731135, "process_in_blocks": "0", "process_kernel_time": 0.758433, "process_mem_max_rss": "342228992", "process_out_blocks": "0", "process_user_time": 3.376597}
[0m12:41:37.236581 [debug] [MainThread]: Command `dbt debug` succeeded at 12:41:37.236319 after 5.97 seconds
[0m12:41:37.237102 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:41:37.237542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104646190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138205430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382226d0>]}
[0m12:41:37.238223 [debug] [MainThread]: Flushing usage events
[0m12:41:38.775326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:43.747277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105207160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627a220>]}


============================== 12:41:43.750962 | 9bc051ba-444b-4de3-a792-0db2f56349e7 ==============================
[0m12:41:43.750962 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:41:43.751546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:41:46.121794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bc051ba-444b-4de3-a792-0db2f56349e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039811c0>]}
[0m12:41:46.181334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bc051ba-444b-4de3-a792-0db2f56349e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b0bfa0>]}
[0m12:41:46.181965 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:41:46.456836 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:41:46.629458 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m12:41:46.630017 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m12:41:46.630435 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/schema.yml
[0m12:41:46.630824 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_second_dbt_model.sql
[0m12:41:46.631124 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_first_dbt_model.sql
[0m12:41:46.874525 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'raw' in the 'models' section of file 'models/raw/schema.yml'
[0m12:41:46.875258 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_core.food_reviews_dbt_model' (models/raw/food_reviews_dbt_model.sql) depends on a source named 'raw.food_reviews_dbt_model' which was not found
[0m12:41:46.879460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.202507, "process_in_blocks": "0", "process_kernel_time": 0.586241, "process_mem_max_rss": "349913088", "process_out_blocks": "0", "process_user_time": 3.620641}
[0m12:41:46.879913 [debug] [MainThread]: Command `dbt run` failed at 12:41:46.879825 after 3.20 seconds
[0m12:41:46.880305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105207160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a954a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a954a00>]}
[0m12:41:46.880688 [debug] [MainThread]: Flushing usage events
[0m12:41:47.767309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:37.721498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110038b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110038160>]}


============================== 12:44:37.725707 | 5e828b12-ab52-4694-a838-2e68efc7e400 ==============================
[0m12:44:37.725707 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:44:37.726309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:37.741234 [info ] [MainThread]: dbt version: 1.10.5
[0m12:44:37.741679 [info ] [MainThread]: python version: 3.9.6
[0m12:44:37.742011 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m12:44:37.742331 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m12:44:40.439166 [info ] [MainThread]: Using profiles dir at /Users/bi006217/.dbt
[0m12:44:40.439659 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/.dbt/profiles.yml
[0m12:44:40.440004 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m12:44:40.440344 [info ] [MainThread]: adapter type: bigquery
[0m12:44:40.440676 [info ] [MainThread]: adapter version: 1.10.0
[0m12:44:40.543012 [info ] [MainThread]: Configuration:
[0m12:44:40.543516 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:44:40.543850 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:44:40.544159 [info ] [MainThread]: Required dependencies:
[0m12:44:40.544679 [debug] [MainThread]: Executing "git --help"
[0m12:44:40.566959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:44:40.567798 [debug] [MainThread]: STDERR: "b''"
[0m12:44:40.568209 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:44:40.568579 [info ] [MainThread]: Connection:
[0m12:44:40.569007 [info ] [MainThread]:   method: service-account
[0m12:44:40.569308 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m12:44:40.569598 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m12:44:40.569889 [info ] [MainThread]:   schema: raw
[0m12:44:40.570195 [info ] [MainThread]:   location: us-central1
[0m12:44:40.570482 [info ] [MainThread]:   priority: interactive
[0m12:44:40.570768 [info ] [MainThread]:   maximum_bytes_billed: None
[0m12:44:40.571053 [info ] [MainThread]:   impersonate_service_account: None
[0m12:44:40.571339 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m12:44:40.571631 [info ] [MainThread]:   job_retries: 1
[0m12:44:40.571916 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m12:44:40.572199 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m12:44:40.572481 [info ] [MainThread]:   timeout_seconds: 300
[0m12:44:40.572765 [info ] [MainThread]:   client_id: None
[0m12:44:40.573048 [info ] [MainThread]:   token_uri: None
[0m12:44:40.573745 [info ] [MainThread]:   compute_region: None
[0m12:44:40.574087 [info ] [MainThread]:   dataproc_cluster_name: None
[0m12:44:40.574396 [info ] [MainThread]:   gcs_bucket: None
[0m12:44:40.574692 [info ] [MainThread]:   dataproc_batch: None
[0m12:44:40.575305 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:44:40.845205 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m12:44:40.845796 [debug] [MainThread]: On debug: select 1 as id
[0m12:44:40.846167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:42.332118 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:24d4fdc5-25de-4c70-b24e-e7fda1e6526b&page=queryresults
[0m12:44:43.035007 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:44:43.036253 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:44:43.040759 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.394914, "process_in_blocks": "0", "process_kernel_time": 0.756987, "process_mem_max_rss": "336281600", "process_out_blocks": "0", "process_user_time": 3.351207}
[0m12:44:43.042371 [debug] [MainThread]: Command `dbt debug` succeeded at 12:44:43.042014 after 5.40 seconds
[0m12:44:43.043071 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:44:43.043506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1413ae0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1413ae070>]}
[0m12:44:43.043952 [debug] [MainThread]: Flushing usage events
[0m12:44:44.620088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:48.201550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10322b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429e130>]}


============================== 12:44:48.205626 | 46b719bd-7af9-4f11-b866-33a2b0c3ca60 ==============================
[0m12:44:48.205626 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:44:48.206176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:50.698332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b719bd-7af9-4f11-b866-33a2b0c3ca60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b99100>]}
[0m12:44:50.757843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46b719bd-7af9-4f11-b866-33a2b0c3ca60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422b940>]}
[0m12:44:50.758447 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:44:51.045847 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:44:51.216856 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m12:44:51.217466 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/schema.yml
[0m12:44:51.217863 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m12:44:51.218275 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_second_dbt_model.sql
[0m12:44:51.218586 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_first_dbt_model.sql
[0m12:44:51.510323 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_core.food_reviews_dbt_model' (models/raw/food_reviews_dbt_model.sql) depends on a source named 'raw.food_reviews_dbt_model' which was not found
[0m12:44:51.514676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3846924, "process_in_blocks": "0", "process_kernel_time": 0.601572, "process_mem_max_rss": "350912512", "process_out_blocks": "0", "process_user_time": 3.686183}
[0m12:44:51.515164 [debug] [MainThread]: Command `dbt run` failed at 12:44:51.515071 after 3.39 seconds
[0m12:44:51.515558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10322b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117406f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117406040>]}
[0m12:44:51.515947 [debug] [MainThread]: Flushing usage events
[0m12:44:52.485537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:52.541296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9e160>]}


============================== 12:45:52.545551 | 0216b4c8-199a-4359-b31d-531109d5b111 ==============================
[0m12:45:52.545551 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:45:52.546139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:55.289928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13729ea90>]}
[0m12:45:55.348961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6d100>]}
[0m12:45:55.349572 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:45:55.626519 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:45:55.805970 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m12:45:55.806617 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/schema.yml
[0m12:45:55.807014 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m12:45:55.807419 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_first_dbt_model.sql
[0m12:45:55.807721 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/example/my_second_dbt_model.sql
[0m12:45:56.166638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m12:45:56.182539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ec7130>]}
[0m12:45:56.269055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:45:56.271447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:45:56.289159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ec5e20>]}
[0m12:45:56.289661 [info ] [MainThread]: Found 1 model, 1 source, 494 macros
[0m12:45:56.290017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a33400>]}
[0m12:45:56.291204 [info ] [MainThread]: 
[0m12:45:56.291584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:56.291888 [info ] [MainThread]: 
[0m12:45:56.292359 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:56.293109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m12:45:56.293515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:57.712940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m12:45:57.714023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:58.658140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a5c730>]}
[0m12:45:58.660497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:58.668561 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_dbt_model
[0m12:45:58.669265 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_dbt_model ........................ [RUN]
[0m12:45:58.669827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_dbt_model)
[0m12:45:58.670222 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_dbt_model
[0m12:45:58.680280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_dbt_model"
[0m12:45:58.681517 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_dbt_model
[0m12:45:58.726136 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_dbt_model"
[0m12:45:58.727634 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      -- models/staging/external_source.sql



WITH source_data AS (
  SELECT *
  FROM `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
)

SELECT * FROM source_data
    );
  
[0m12:45:58.728087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:02.806756 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:70a1ff2c-396d-433d-be8a-d3da8b782aee&page=queryresults
[0m12:46:02.808480 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:70a1ff2c-396d-433d-be8a-d3da8b782aee&page=queryresults
[0m12:46:02.861164 [debug] [Thread-1  ]: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews_dbt_model was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:46:02.863255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0216b4c8-199a-4359-b31d-531109d5b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ea51c0>]}
[0m12:46:02.863944 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_dbt_model ............... [[31mERROR[0m in 4.19s]
[0m12:46:02.864588 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_dbt_model
[0m12:46:02.865176 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews_dbt_model was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql.
[0m12:46:02.866114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:02.867812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:02.868180 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_dbt_model' was properly closed.
[0m12:46:02.868515 [info ] [MainThread]: 
[0m12:46:02.868851 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m12:46:02.869911 [debug] [MainThread]: Command end result
[0m12:46:02.895818 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:46:02.897757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:46:02.904318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m12:46:02.904661 [info ] [MainThread]: 
[0m12:46:02.905051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:46:02.905383 [info ] [MainThread]: 
[0m12:46:02.905776 [error] [MainThread]: [31mFailure in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)[0m
[0m12:46:02.906155 [error] [MainThread]:   Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews_dbt_model was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:46:02.906468 [info ] [MainThread]: 
[0m12:46:02.906816 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:46:02.907115 [info ] [MainThread]: 
[0m12:46:02.907443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:46:02.911934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.445354, "process_in_blocks": "0", "process_kernel_time": 0.742355, "process_mem_max_rss": "351649792", "process_out_blocks": "0", "process_user_time": 4.279728}
[0m12:46:02.912378 [debug] [MainThread]: Command `dbt run` failed at 12:46:02.912301 after 10.45 seconds
[0m12:46:02.912752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13729ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026a58b0>]}
[0m12:46:02.913125 [debug] [MainThread]: Flushing usage events
[0m12:46:04.702559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:49.051493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b37bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b37190>]}


============================== 12:56:49.056555 | 9359683e-5b33-413f-9aa1-0625d972e01d ==============================
[0m12:56:49.056555 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:56:49.057219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:56:49.073464 [info ] [MainThread]: dbt version: 1.10.5
[0m12:56:49.073981 [info ] [MainThread]: python version: 3.9.6
[0m12:56:49.074367 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m12:56:49.074736 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m12:56:51.762143 [info ] [MainThread]: Using profiles dir at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core
[0m12:56:51.762663 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/profiles.yml
[0m12:56:51.763008 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m12:56:51.763350 [info ] [MainThread]: adapter type: bigquery
[0m12:56:51.763664 [info ] [MainThread]: adapter version: 1.10.0
[0m12:56:51.865762 [info ] [MainThread]: Configuration:
[0m12:56:51.866290 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:56:51.866639 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:56:51.866964 [info ] [MainThread]: Required dependencies:
[0m12:56:51.867455 [debug] [MainThread]: Executing "git --help"
[0m12:56:51.888824 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:56:51.889710 [debug] [MainThread]: STDERR: "b''"
[0m12:56:51.890128 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:56:51.890519 [info ] [MainThread]: Connection:
[0m12:56:51.890966 [info ] [MainThread]:   method: service-account
[0m12:56:51.891278 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m12:56:51.891582 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m12:56:51.891876 [info ] [MainThread]:   schema: raw
[0m12:56:51.892169 [info ] [MainThread]:   location: us-central1
[0m12:56:51.892462 [info ] [MainThread]:   priority: interactive
[0m12:56:51.892756 [info ] [MainThread]:   maximum_bytes_billed: None
[0m12:56:51.893051 [info ] [MainThread]:   impersonate_service_account: None
[0m12:56:51.893346 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m12:56:51.893637 [info ] [MainThread]:   job_retries: 1
[0m12:56:51.893928 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m12:56:51.894216 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m12:56:51.894510 [info ] [MainThread]:   timeout_seconds: 300
[0m12:56:51.894802 [info ] [MainThread]:   client_id: None
[0m12:56:51.895090 [info ] [MainThread]:   token_uri: None
[0m12:56:51.895380 [info ] [MainThread]:   compute_region: None
[0m12:56:51.895971 [info ] [MainThread]:   dataproc_cluster_name: None
[0m12:56:51.896275 [info ] [MainThread]:   gcs_bucket: None
[0m12:56:51.896571 [info ] [MainThread]:   dataproc_batch: None
[0m12:56:51.897186 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:56:52.162353 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m12:56:52.162962 [debug] [MainThread]: On debug: select 1 as id
[0m12:56:52.163343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:54.032764 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2bd5ab0e-aa54-4b5d-80da-a4fef377f532&page=queryresults
[0m12:56:54.875090 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:56:54.876589 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:56:54.887029 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.9251747, "process_in_blocks": "0", "process_kernel_time": 0.798473, "process_mem_max_rss": "334807040", "process_out_blocks": "0", "process_user_time": 3.375771}
[0m12:56:54.887960 [debug] [MainThread]: Command `dbt debug` succeeded at 12:56:54.887768 after 5.93 seconds
[0m12:56:54.888420 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:56:54.888895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11959fa30>]}
[0m12:56:54.889361 [debug] [MainThread]: Flushing usage events
[0m12:56:56.627841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:00.260600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26370>]}


============================== 12:57:00.264596 | 00aec9bf-d74d-4873-a65f-d191f99d9ac2 ==============================
[0m12:57:00.264596 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:57:00.265155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:57:02.777390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e564130>]}
[0m12:57:02.836209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167178b0>]}
[0m12:57:02.836814 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:57:03.119514 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:57:03.284588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:57:03.285341 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/schema.yml
[0m12:57:03.285713 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m12:57:03.652352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m12:57:03.670468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8b3ee0>]}
[0m12:57:03.757940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:57:03.760444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:57:03.777420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3afaf0>]}
[0m12:57:03.777930 [info ] [MainThread]: Found 1 model, 1 source, 494 macros
[0m12:57:03.778297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f399d00>]}
[0m12:57:03.779515 [info ] [MainThread]: 
[0m12:57:03.779904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:03.780215 [info ] [MainThread]: 
[0m12:57:03.780696 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:03.781479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m12:57:03.781894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:04.986173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m12:57:04.987540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:06.095596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542abb0>]}
[0m12:57:06.096736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:06.103935 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_dbt_model
[0m12:57:06.105134 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_dbt_model ........................ [RUN]
[0m12:57:06.105867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_dbt_model)
[0m12:57:06.106303 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_dbt_model
[0m12:57:06.116600 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_dbt_model"
[0m12:57:06.118271 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_dbt_model
[0m12:57:06.224749 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_dbt_model"
[0m12:57:06.226447 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



WITH source_data AS (
  SELECT 
    ReviewId,
    RecipeId,
    AuthorId,
    AuthorName,
    Rating,
    Review,
    PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DateSubmitted) AS date_submitted,
    PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DateModified) AS date_modified
  FROM `dbtandbigquery-467100`.`raw`.`reviews`
)

SELECT * FROM source_data
    );
  
[0m12:57:06.227207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:07.970894 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:62f53cf7-cf67-4b5a-9510-1145a18e64e2&page=queryresults
[0m12:57:07.972712 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:62f53cf7-cf67-4b5a-9510-1145a18e64e2&page=queryresults
[0m12:57:08.022722 [debug] [Thread-1  ]: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:57:08.024817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aec9bf-d74d-4873-a65f-d191f99d9ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f849cd0>]}
[0m12:57:08.025545 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_dbt_model ............... [[31mERROR[0m in 1.92s]
[0m12:57:08.026142 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_dbt_model
[0m12:57:08.026634 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql.
[0m12:57:08.027549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:08.029256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:08.029595 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_dbt_model' was properly closed.
[0m12:57:08.029952 [info ] [MainThread]: 
[0m12:57:08.030303 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m12:57:08.030926 [debug] [MainThread]: Command end result
[0m12:57:08.057474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:57:08.059272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:57:08.065771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m12:57:08.066104 [info ] [MainThread]: 
[0m12:57:08.066493 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:57:08.066831 [info ] [MainThread]: 
[0m12:57:08.067240 [error] [MainThread]: [31mFailure in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)[0m
[0m12:57:08.067625 [error] [MainThread]:   Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  Not found: Table dbtandbigquery-467100:raw.reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:57:08.067948 [info ] [MainThread]: 
[0m12:57:08.068305 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:57:08.068603 [info ] [MainThread]: 
[0m12:57:08.068929 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:57:08.073547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.88624, "process_in_blocks": "0", "process_kernel_time": 0.644187, "process_mem_max_rss": "346112000", "process_out_blocks": "0", "process_user_time": 4.285696}
[0m12:57:08.074052 [debug] [MainThread]: Command `dbt run` failed at 12:57:08.073962 after 7.89 seconds
[0m12:57:08.074447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7fc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fba760>]}
[0m12:57:08.074838 [debug] [MainThread]: Flushing usage events
[0m12:57:09.364514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:45.225431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d43160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db6220>]}


============================== 12:59:45.229703 | ddedc6df-c461-45f0-82f3-50e5a9b79c2e ==============================
[0m12:59:45.229703 [info ] [MainThread]: Running with dbt=1.10.5
[0m12:59:45.230259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:59:48.044007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024be1c0>]}
[0m12:59:48.102597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104018ee0>]}
[0m12:59:48.103201 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m12:59:48.393533 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m12:59:48.562068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:59:48.562838 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/schema.yml
[0m12:59:48.563230 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m12:59:48.873582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m12:59:48.879259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f5deb0>]}
[0m12:59:49.012844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:59:49.015751 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:59:49.035233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ec6c70>]}
[0m12:59:49.035802 [info ] [MainThread]: Found 1 model, 494 macros
[0m12:59:49.036227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f5ddf0>]}
[0m12:59:49.037558 [info ] [MainThread]: 
[0m12:59:49.037982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:49.038341 [info ] [MainThread]: 
[0m12:59:49.038882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:59:49.039774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m12:59:49.040240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:50.390166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m12:59:50.391359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:51.739705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046711f0>]}
[0m12:59:51.741498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:51.749680 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_dbt_model
[0m12:59:51.750733 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_dbt_model ........................ [RUN]
[0m12:59:51.751773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_dbt_model)
[0m12:59:51.752440 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_dbt_model
[0m12:59:51.766683 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_dbt_model"
[0m12:59:51.767996 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_dbt_model
[0m12:59:51.789173 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m12:59:51.789657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:55.267243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:c0ebf8d3-6407-4e8d-897f-506001aa7fa5&page=queryresults
[0m12:59:56.521136 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_dbt_model"
[0m12:59:56.522002 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DateSubmitted) AS date_submitted,
  PARSE_DATETIME('%Y-%m-%dT%H:%M:%SZ', DateModified) AS date_modified
FROM `dbtandbigquery-467100.raw.reviews_external`
    );
  
[0m12:59:57.022288 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5f195bf7-5d1f-4910-9d8f-345faf2322a7&page=queryresults
[0m12:59:57.244321 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5f195bf7-5d1f-4910-9d8f-345faf2322a7&page=queryresults
[0m12:59:57.301258 [debug] [Thread-1  ]: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  No matching signature for function PARSE_DATETIME
    Argument types: STRING, TIMESTAMP
    Signature: PARSE_DATETIME(STRING, STRING)
      Argument 2: Unable to coerce type TIMESTAMP to expected type STRING at [25:3]
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:59:57.303398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddedc6df-c461-45f0-82f3-50e5a9b79c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11806df70>]}
[0m12:59:57.304130 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_dbt_model ............... [[31mERROR[0m in 5.55s]
[0m12:59:57.304742 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_dbt_model
[0m12:59:57.305308 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  No matching signature for function PARSE_DATETIME
    Argument types: STRING, TIMESTAMP
    Signature: PARSE_DATETIME(STRING, STRING)
      Argument 2: Unable to coerce type TIMESTAMP to expected type STRING at [25:3]
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql.
[0m12:59:57.306272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:57.307999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:57.308328 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_dbt_model' was properly closed.
[0m12:59:57.308651 [info ] [MainThread]: 
[0m12:59:57.308986 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m12:59:57.309636 [debug] [MainThread]: Command end result
[0m12:59:57.336392 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m12:59:57.338464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m12:59:57.345091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m12:59:57.345441 [info ] [MainThread]: 
[0m12:59:57.345847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:59:57.346192 [info ] [MainThread]: 
[0m12:59:57.346592 [error] [MainThread]: [31mFailure in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)[0m
[0m12:59:57.346982 [error] [MainThread]:   Database Error in model food_reviews_dbt_model (models/raw/food_reviews_dbt_model.sql)
  No matching signature for function PARSE_DATETIME
    Argument types: STRING, TIMESTAMP
    Signature: PARSE_DATETIME(STRING, STRING)
      Argument 2: Unable to coerce type TIMESTAMP to expected type STRING at [25:3]
  compiled code at target/run/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:59:57.347295 [info ] [MainThread]: 
[0m12:59:57.347643 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_dbt_model.sql
[0m12:59:57.347939 [info ] [MainThread]: 
[0m12:59:57.348267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:59:57.353346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.204809, "process_in_blocks": "0", "process_kernel_time": 0.823895, "process_mem_max_rss": "345423872", "process_out_blocks": "0", "process_user_time": 4.293924}
[0m12:59:57.353847 [debug] [MainThread]: Command `dbt run` failed at 12:59:57.353756 after 12.21 seconds
[0m12:59:57.354259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d43160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104018ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c66a00>]}
[0m12:59:57.354658 [debug] [MainThread]: Flushing usage events
[0m13:00:02.580393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:53.330749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105147160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ba220>]}


============================== 13:01:53.335007 | 0f1f2f02-e949-4117-b2df-92c495b8d86f ==============================
[0m13:01:53.335007 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:01:53.335597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:56.197520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf3460>]}
[0m13:01:56.256225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e248e0>]}
[0m13:01:56.256845 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:01:56.541635 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:01:56.694671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:56.695311 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m13:01:57.006066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:01:57.011659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fc6130>]}
[0m13:01:57.129323 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:01:57.141321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:01:57.159943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d6c8e0>]}
[0m13:01:57.160479 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:01:57.160852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fb5c10>]}
[0m13:01:57.162046 [info ] [MainThread]: 
[0m13:01:57.162440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:57.162754 [info ] [MainThread]: 
[0m13:01:57.163236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:57.164041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:01:57.164478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:59.335155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:01:59.336466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:00.407048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b83e20>]}
[0m13:02:00.408589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:00.417663 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_dbt_model
[0m13:02:00.418472 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_dbt_model ........................ [RUN]
[0m13:02:00.419244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_dbt_model)
[0m13:02:00.419674 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_dbt_model
[0m13:02:00.431369 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_dbt_model"
[0m13:02:00.432716 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_dbt_model
[0m13:02:00.453752 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:02:00.454261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:01.848736 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:66738d05-63d3-44e8-b5c3-86ab8a760b25&page=queryresults
[0m13:02:03.052987 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_dbt_model"
[0m13:02:03.053986 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.reviews_external`
    );
  
[0m13:02:03.811504 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a6c0375c-53af-4654-9edb-eba67c53ff3f&page=queryresults
[0m13:02:14.700872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f1f2f02-e949-4117-b2df-92c495b8d86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a092be0>]}
[0m13:02:14.701943 [info ] [Thread-1  ]: 1 of 1 OK created sql table model raw.food_reviews_dbt_model ................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 14.28s]
[0m13:02:14.702592 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_dbt_model
[0m13:02:14.703642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:14.705731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:14.706067 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_dbt_model' was properly closed.
[0m13:02:14.706398 [info ] [MainThread]: 
[0m13:02:14.706754 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.54 seconds (17.54s).
[0m13:02:14.708508 [debug] [MainThread]: Command end result
[0m13:02:14.740437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:02:14.742674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:02:14.749286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:02:14.749630 [info ] [MainThread]: 
[0m13:02:14.750047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:14.750363 [info ] [MainThread]: 
[0m13:02:14.750702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:02:14.755229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.502531, "process_in_blocks": "0", "process_kernel_time": 0.81874, "process_mem_max_rss": "337592320", "process_out_blocks": "0", "process_user_time": 4.282547}
[0m13:02:14.755669 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:14.755590 after 21.50 seconds
[0m13:02:14.756162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105147160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b51700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c21c0>]}
[0m13:02:14.757159 [debug] [MainThread]: Flushing usage events
[0m13:02:16.360074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:55.022806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875a190>]}


============================== 13:08:55.027146 | 52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca ==============================
[0m13:08:55.027146 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:08:55.027700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select food_reviews_dbt_model', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:08:57.867299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b630730>]}
[0m13:08:57.925956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b622910>]}
[0m13:08:57.926597 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:08:58.207827 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:08:58.360528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:58.361206 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m13:08:58.671345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:08:58.677052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d00a130>]}
[0m13:08:58.748410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:08:58.750825 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:08:58.768124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cc92ac0>]}
[0m13:08:58.768614 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:08:58.768982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d0823d0>]}
[0m13:08:58.769961 [info ] [MainThread]: 
[0m13:08:58.770334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:58.770645 [info ] [MainThread]: 
[0m13:08:58.771177 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:58.771934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:08:58.772345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:59.903448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:08:59.904096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:00.862233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b667460>]}
[0m13:09:00.863132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:00.869975 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_dbt_model
[0m13:09:00.870884 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_dbt_model ........................ [RUN]
[0m13:09:00.871755 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_dbt_model)
[0m13:09:00.872307 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_dbt_model
[0m13:09:00.883867 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_dbt_model"
[0m13:09:00.885070 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_dbt_model
[0m13:09:00.906187 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:09:00.906713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:09:02.041488 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:19bc8cc8-9e44-42f5-9f70-ed37e5d90e18&page=queryresults
[0m13:09:02.984053 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_dbt_model"
[0m13:09:02.984911 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_dbt_model"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:09:04.102832 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:cfe38ebd-67a4-4cf5-aaf6-14dea8c7b412&page=queryresults
[0m13:09:14.511737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52f60bd5-31c5-4fd6-bc67-4e12d7cc11ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d1afac0>]}
[0m13:09:14.512824 [info ] [Thread-1  ]: 1 of 1 OK created sql table model raw.food_reviews_dbt_model ................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 13.64s]
[0m13:09:14.513477 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_dbt_model
[0m13:09:14.514507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:14.516797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:14.517142 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_dbt_model' was properly closed.
[0m13:09:14.517482 [info ] [MainThread]: 
[0m13:09:14.518416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.75 seconds (15.75s).
[0m13:09:14.519254 [debug] [MainThread]: Command end result
[0m13:09:14.550991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:09:14.554193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:09:14.560753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:09:14.561145 [info ] [MainThread]: 
[0m13:09:14.561620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:14.562011 [info ] [MainThread]: 
[0m13:09:14.562414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:09:14.566903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.621466, "process_in_blocks": "0", "process_kernel_time": 0.827932, "process_mem_max_rss": "338444288", "process_out_blocks": "0", "process_user_time": 4.253285}
[0m13:09:14.567343 [debug] [MainThread]: Command `dbt run` succeeded at 13:09:14.567265 after 19.62 seconds
[0m13:09:14.567711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b622910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b7fa490>]}
[0m13:09:14.568495 [debug] [MainThread]: Flushing usage events
[0m13:09:16.048878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:23.463604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7a220>]}


============================== 13:10:23.467994 | b894fb19-9f73-4870-8f57-6526dccdd979 ==============================
[0m13:10:23.467994 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:10:23.468556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:26.313337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d13340>]}
[0m13:10:26.372301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136dfbee0>]}
[0m13:10:26.372895 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:10:26.656020 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:10:26.811463 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:10:26.812051 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/food_reviews.sql
[0m13:10:26.812412 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/raw/food_reviews_dbt_model.sql
[0m13:10:27.077853 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'food_reviews_dbt_model' in the 'models' section of file 'models/raw/schema.yml'
[0m13:10:27.122442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:10:27.128350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376e3130>]}
[0m13:10:27.200221 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:10:27.202744 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:10:27.220038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13747d940>]}
[0m13:10:27.220524 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:10:27.220889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13747b7f0>]}
[0m13:10:27.222001 [info ] [MainThread]: 
[0m13:10:27.222375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:27.222679 [info ] [MainThread]: 
[0m13:10:27.223209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:10:27.223972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:10:27.224384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:28.750175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:10:28.751941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:32.701592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1371c3af0>]}
[0m13:10:32.702345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:32.706850 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:10:32.707412 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:10:32.707877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews)
[0m13:10:32.708260 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:10:32.718690 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:10:32.719792 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:10:32.773205 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:10:32.792074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:35.038261 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5069a53e-8794-4af1-95bf-edbdc3e9c076&page=queryresults
[0m13:10:35.997357 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:10:35.998380 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:10:36.636671 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:dfd6107d-0ecc-456e-ad56-c9a52333a2b7&page=queryresults
[0m13:10:36.854697 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:dfd6107d-0ecc-456e-ad56-c9a52333a2b7&page=queryresults
[0m13:10:36.901604 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:10:36.903928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b894fb19-9f73-4870-8f57-6526dccdd979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379d4be0>]}
[0m13:10:36.904688 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 4.19s]
[0m13:10:36.905295 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:10:36.905855 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:10:36.906838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:36.908664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:36.909049 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:10:36.909398 [info ] [MainThread]: 
[0m13:10:36.909950 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m13:10:36.910905 [debug] [MainThread]: Command end result
[0m13:10:36.935987 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:10:36.938166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:10:36.944942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:10:36.945295 [info ] [MainThread]: 
[0m13:10:36.945693 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:10:36.946040 [info ] [MainThread]: 
[0m13:10:36.946438 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:10:36.946828 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:10:36.947142 [info ] [MainThread]: 
[0m13:10:36.947494 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:10:36.947793 [info ] [MainThread]: 
[0m13:10:36.948124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:10:36.952974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.56579, "process_in_blocks": "0", "process_kernel_time": 0.825741, "process_mem_max_rss": "335986688", "process_out_blocks": "0", "process_user_time": 4.220693}
[0m13:10:36.953440 [debug] [MainThread]: Command `dbt run` failed at 13:10:36.953354 after 13.57 seconds
[0m13:10:36.953820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136dfbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecb490>]}
[0m13:10:36.954198 [debug] [MainThread]: Flushing usage events
[0m13:10:38.276463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:45.334273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfe1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e72cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e722b0>]}


============================== 13:10:45.338374 | cefdcd85-9e8b-4a16-8e3a-739f96a24cf4 ==============================
[0m13:10:45.338374 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:10:45.338922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:47.855611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087087c0>]}
[0m13:10:47.915011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e72df0>]}
[0m13:10:47.915670 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:10:48.193781 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:10:48.337734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:48.338383 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/schema.yml
[0m13:10:48.485254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:10:48.491037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bee4130>]}
[0m13:10:48.565771 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:10:48.568028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:10:48.584703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bccac40>]}
[0m13:10:48.585186 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:10:48.585549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11befa0d0>]}
[0m13:10:48.586672 [info ] [MainThread]: 
[0m13:10:48.587048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:48.587354 [info ] [MainThread]: 
[0m13:10:48.587881 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:10:48.588650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:10:48.589051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:49.861022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:10:49.862252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:50.867746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b965670>]}
[0m13:10:50.869216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:50.877826 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:10:50.878532 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:10:50.879299 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.dbt_core.food_reviews'
[0m13:10:50.879693 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:10:50.889569 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:10:50.890727 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:10:50.911772 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:10:50.912246 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:10:52.197749 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4d4245eb-a646-401e-b480-d13cc48aee67&page=queryresults
[0m13:10:53.637032 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:10:53.638581 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:10:54.022766 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e912a88c-4df0-49e8-a403-72e4f70be23b&page=queryresults
[0m13:10:54.025034 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e912a88c-4df0-49e8-a403-72e4f70be23b&page=queryresults
[0m13:10:54.079508 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:10:54.081505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefdcd85-9e8b-4a16-8e3a-739f96a24cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bff60d0>]}
[0m13:10:54.082162 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 3.20s]
[0m13:10:54.082740 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:10:54.083224 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:10:54.084112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:54.085846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:54.086182 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw' was properly closed.
[0m13:10:54.086488 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:10:54.086805 [info ] [MainThread]: 
[0m13:10:54.087147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m13:10:54.088217 [debug] [MainThread]: Command end result
[0m13:10:54.114106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:10:54.115916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:10:54.122272 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:10:54.122603 [info ] [MainThread]: 
[0m13:10:54.123010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:10:54.123462 [info ] [MainThread]: 
[0m13:10:54.123951 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:10:54.124349 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  Not found: Table dbtandbigquery-467100:raw.food_reviews was not found in location us-central1
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:10:54.124662 [info ] [MainThread]: 
[0m13:10:54.125019 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:10:54.125328 [info ] [MainThread]: 
[0m13:10:54.125661 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:10:54.130051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.869677, "process_in_blocks": "0", "process_kernel_time": 0.714238, "process_mem_max_rss": "357974016", "process_out_blocks": "0", "process_user_time": 4.083141}
[0m13:10:54.130494 [debug] [MainThread]: Command `dbt run` failed at 13:10:54.130412 after 8.87 seconds
[0m13:10:54.130872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfe1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b776310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bea3880>]}
[0m13:10:54.131243 [debug] [MainThread]: Flushing usage events
[0m13:10:55.062022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:33.646306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae2c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae2220>]}


============================== 13:11:33.651014 | 125c0698-823e-4227-8773-613aaa82ba4a ==============================
[0m13:11:33.651014 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:11:33.651683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:11:36.480680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142b4a00>]}
[0m13:11:36.539573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f7cd0>]}
[0m13:11:36.540158 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:11:36.824381 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:11:36.978192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:36.978625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:36.985750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:11:37.015565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13340aeb0>]}
[0m13:11:37.088833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:11:37.091303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:11:37.108810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13335c220>]}
[0m13:11:37.109307 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:11:37.109668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133369d90>]}
[0m13:11:37.110787 [info ] [MainThread]: 
[0m13:11:37.111151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:37.111453 [info ] [MainThread]: 
[0m13:11:37.111924 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:37.112796 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:11:37.113197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:38.268315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:11:38.269794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:45.349041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107012700>]}
[0m13:11:45.352043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:45.361305 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:11:45.362427 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:11:45.363428 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.dbt_core.food_reviews'
[0m13:11:45.364095 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:11:45.379188 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:11:45.380310 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:11:45.402556 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:11:45.403161 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:11:46.483633 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:48980a00-ebd0-4971-b387-beee334da75d&page=queryresults
[0m13:11:47.770850 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:11:47.771785 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:11:48.250441 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2d66e424-b8e0-47b5-bef0-9bbae5a242f4&page=queryresults
[0m13:11:48.481127 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2d66e424-b8e0-47b5-bef0-9bbae5a242f4&page=queryresults
[0m13:11:48.537558 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:11:48.540669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '125c0698-823e-4227-8773-613aaa82ba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13352b220>]}
[0m13:11:48.541453 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 3.18s]
[0m13:11:48.542069 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:11:48.542579 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:11:48.543619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:48.545741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:48.546322 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw' was properly closed.
[0m13:11:48.546916 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:11:48.547268 [info ] [MainThread]: 
[0m13:11:48.549014 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.44 seconds (11.44s).
[0m13:11:48.550861 [debug] [MainThread]: Command end result
[0m13:11:48.578814 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:11:48.580809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:11:48.587376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:11:48.587715 [info ] [MainThread]: 
[0m13:11:48.588117 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:11:48.588836 [info ] [MainThread]: 
[0m13:11:48.589388 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:11:48.589815 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:11:48.590136 [info ] [MainThread]: 
[0m13:11:48.590507 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:11:48.590814 [info ] [MainThread]: 
[0m13:11:48.591150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:11:48.595938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.028749, "process_in_blocks": "0", "process_kernel_time": 0.782089, "process_mem_max_rss": "345948160", "process_out_blocks": "0", "process_user_time": 4.026726}
[0m13:11:48.596387 [debug] [MainThread]: Command `dbt run` failed at 13:11:48.596306 after 15.03 seconds
[0m13:11:48.596762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083606a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142b4a00>]}
[0m13:11:48.597140 [debug] [MainThread]: Flushing usage events
[0m13:11:49.438740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:18.419104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106976c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106976220>]}


============================== 13:15:18.423476 | 5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a ==============================
[0m13:15:18.423476 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:15:18.424040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:21.233086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11925e0a0>]}
[0m13:15:21.292210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062132e0>]}
[0m13:15:21.292821 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:15:21.576491 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:15:21.729586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:21.730214 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews.sql
[0m13:15:22.040896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:15:22.046612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a4b130>]}
[0m13:15:22.118837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:15:22.121685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:15:22.139250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197fafa0>]}
[0m13:15:22.139751 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:15:22.140116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b17130>]}
[0m13:15:22.141298 [info ] [MainThread]: 
[0m13:15:22.141693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:22.142002 [info ] [MainThread]: 
[0m13:15:22.142489 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:22.143245 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:15:22.143657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:23.242823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:15:23.243428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:24.725740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a50d60>]}
[0m13:15:24.727555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:24.735309 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:15:24.736353 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:15:24.737070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews)
[0m13:15:24.737482 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:15:24.748256 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:15:24.749421 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:15:24.770824 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:15:24.771356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:26.132460 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6f52d6b1-8d3c-4a01-a856-44c3b3e8a35a&page=queryresults
[0m13:15:26.883520 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:15:26.884578 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.reviews_external`
    );
  
[0m13:15:27.495019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5dde89eb-2029-4121-b7ca-a55955032bb7&page=queryresults
[0m13:15:37.107870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa3f66c-80fc-4f6b-8b60-8b1af0dc504a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106921100>]}
[0m13:15:37.108851 [info ] [Thread-1  ]: 1 of 1 OK created sql table model raw.food_reviews ............................. [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 12.37s]
[0m13:15:37.109515 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:15:37.110589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:37.112816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:37.113153 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:15:37.113493 [info ] [MainThread]: 
[0m13:15:37.113877 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m13:15:37.115025 [debug] [MainThread]: Command end result
[0m13:15:37.143566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:15:37.146044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:15:37.152346 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:15:37.152681 [info ] [MainThread]: 
[0m13:15:37.153091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:37.153412 [info ] [MainThread]: 
[0m13:15:37.153751 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:15:37.158434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.816662, "process_in_blocks": "0", "process_kernel_time": 0.824262, "process_mem_max_rss": "350781440", "process_out_blocks": "0", "process_user_time": 4.240867}
[0m13:15:37.158864 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:37.158787 after 18.82 seconds
[0m13:15:37.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e79f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407e1c0>]}
[0m13:15:37.159999 [debug] [MainThread]: Flushing usage events
[0m13:15:39.388577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:19.880118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d221f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d96d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d96370>]}


============================== 13:16:19.884409 | 3098d0e4-6c1f-4187-acad-9ee4365d7080 ==============================
[0m13:16:19.884409 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:16:19.884972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:22.714615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13842ae80>]}
[0m13:16:22.773467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138407580>]}
[0m13:16:22.774099 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:16:23.053536 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:16:23.205290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:23.205933 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews.sql
[0m13:16:23.517093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:16:23.522756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4cd130>]}
[0m13:16:23.593734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:16:23.596083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:16:23.612935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a193d90>]}
[0m13:16:23.613417 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:16:23.613779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4b400>]}
[0m13:16:23.614983 [info ] [MainThread]: 
[0m13:16:23.615375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:23.615687 [info ] [MainThread]: 
[0m13:16:23.616158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:23.616921 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:16:23.617326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:24.664242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:16:24.665433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:25.627283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1385ee070>]}
[0m13:16:25.631639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:25.638436 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:16:25.639090 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:16:25.639623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews)
[0m13:16:25.640011 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:16:25.650426 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:16:25.651435 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:16:25.673309 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:16:25.673837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:30.680290 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:0e52a55a-71b1-47e9-84c8-16190ca239d6&page=queryresults
[0m13:16:31.329913 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:16:31.330931 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:16:31.901454 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2e8a8d81-eced-4484-92f6-2b6123214d10&page=queryresults
[0m13:16:32.125332 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2e8a8d81-eced-4484-92f6-2b6123214d10&page=queryresults
[0m13:16:32.177704 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:16:32.179760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3098d0e4-6c1f-4187-acad-9ee4365d7080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b002d30>]}
[0m13:16:32.180444 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 6.54s]
[0m13:16:32.181030 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:16:32.181515 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:16:32.182421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:32.184163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:32.184506 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:16:32.184833 [info ] [MainThread]: 
[0m13:16:32.185184 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m13:16:32.186262 [debug] [MainThread]: Command end result
[0m13:16:32.213169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:16:32.215211 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:16:32.221643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:16:32.221983 [info ] [MainThread]: 
[0m13:16:32.222378 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:16:32.222708 [info ] [MainThread]: 
[0m13:16:32.223105 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:16:32.223488 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:16:32.223802 [info ] [MainThread]: 
[0m13:16:32.224162 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:16:32.224466 [info ] [MainThread]: 
[0m13:16:32.224809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:16:32.229686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.42577, "process_in_blocks": "0", "process_kernel_time": 0.83422, "process_mem_max_rss": "347734016", "process_out_blocks": "0", "process_user_time": 4.296001}
[0m13:16:32.230166 [debug] [MainThread]: Command `dbt run` failed at 13:16:32.230080 after 12.43 seconds
[0m13:16:32.230595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d221f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13842ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a193bb0>]}
[0m13:16:32.231006 [debug] [MainThread]: Flushing usage events
[0m13:16:33.456308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:54.123249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ba160>]}


============================== 13:16:54.127496 | 23e378f7-d9d6-4d4b-986b-5137f8feee39 ==============================
[0m13:16:54.127496 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:16:54.128050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:56.887599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ac18b0>]}
[0m13:16:56.946199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cb0520>]}
[0m13:16:56.946810 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:16:57.226452 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:16:57.381090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:57.381524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:57.388667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:16:57.418385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172caf70>]}
[0m13:16:57.489873 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:16:57.492231 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:16:57.509643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117215c40>]}
[0m13:16:57.510193 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:16:57.510586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117227160>]}
[0m13:16:57.511731 [info ] [MainThread]: 
[0m13:16:57.512116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:57.512432 [info ] [MainThread]: 
[0m13:16:57.512906 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:57.513748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:16:57.514167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:58.642617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:16:58.643853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:59.843286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c934c0>]}
[0m13:16:59.845359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:59.854033 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:16:59.855130 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:16:59.856116 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.dbt_core.food_reviews'
[0m13:16:59.856634 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:16:59.868703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:16:59.869706 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:16:59.891493 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:16:59.892006 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:17:01.259348 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1c180285-a159-44db-8555-bcf0efbb6d22&page=queryresults
[0m13:17:01.935456 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:17:01.936332 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_dbt_model.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:17:02.569693 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:99f35474-c517-47db-a57f-94dacb83d792&page=queryresults
[0m13:17:03.409470 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:99f35474-c517-47db-a57f-94dacb83d792&page=queryresults
[0m13:17:03.483380 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:17:03.485389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e378f7-d9d6-4d4b-986b-5137f8feee39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174498e0>]}
[0m13:17:03.486073 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 3.63s]
[0m13:17:03.486656 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:17:03.487148 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:17:03.488063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:03.489833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:03.490178 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw' was properly closed.
[0m13:17:03.490492 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:17:03.490813 [info ] [MainThread]: 
[0m13:17:03.491159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m13:17:03.492145 [debug] [MainThread]: Command end result
[0m13:17:03.521283 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:17:03.523188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:17:03.530640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:17:03.531021 [info ] [MainThread]: 
[0m13:17:03.531425 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:17:03.531771 [info ] [MainThread]: 
[0m13:17:03.532182 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:17:03.532563 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:17:03.532875 [info ] [MainThread]: 
[0m13:17:03.533226 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:17:03.533535 [info ] [MainThread]: 
[0m13:17:03.533874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:17:03.538290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.489765, "process_in_blocks": "0", "process_kernel_time": 0.800682, "process_mem_max_rss": "342966272", "process_out_blocks": "0", "process_user_time": 3.952911}
[0m13:17:03.538827 [debug] [MainThread]: Command `dbt run` failed at 13:17:03.538729 after 9.49 seconds
[0m13:17:03.539233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ac18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117215c40>]}
[0m13:17:03.539623 [debug] [MainThread]: Flushing usage events
[0m13:17:04.967831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:40.865139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106973bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106973190>]}


============================== 13:19:40.869506 | de017a9c-a2d5-4f5a-98a1-4f177bd02d23 ==============================
[0m13:19:40.869506 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:19:40.870070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:40.884232 [info ] [MainThread]: dbt version: 1.10.5
[0m13:19:40.884672 [info ] [MainThread]: python version: 3.9.6
[0m13:19:40.885012 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m13:19:40.885340 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m13:19:43.628826 [info ] [MainThread]: Using profiles dir at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core
[0m13:19:43.629401 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/profiles.yml
[0m13:19:43.629756 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m13:19:43.630094 [info ] [MainThread]: adapter type: bigquery
[0m13:19:43.630402 [info ] [MainThread]: adapter version: 1.10.0
[0m13:19:43.733481 [info ] [MainThread]: Configuration:
[0m13:19:43.733989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:19:43.734329 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:19:43.734642 [info ] [MainThread]: Required dependencies:
[0m13:19:43.735173 [debug] [MainThread]: Executing "git --help"
[0m13:19:43.753416 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:19:43.754430 [debug] [MainThread]: STDERR: "b''"
[0m13:19:43.754862 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:19:43.755235 [info ] [MainThread]: Connection:
[0m13:19:43.755669 [info ] [MainThread]:   method: service-account
[0m13:19:43.755977 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m13:19:43.756275 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m13:19:43.756569 [info ] [MainThread]:   schema: raw
[0m13:19:43.756858 [info ] [MainThread]:   location: us-central1
[0m13:19:43.757147 [info ] [MainThread]:   priority: interactive
[0m13:19:43.757440 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:19:43.757732 [info ] [MainThread]:   impersonate_service_account: None
[0m13:19:43.758022 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:19:43.758315 [info ] [MainThread]:   job_retries: 1
[0m13:19:43.758603 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:19:43.758892 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:19:43.759178 [info ] [MainThread]:   timeout_seconds: 300
[0m13:19:43.759463 [info ] [MainThread]:   client_id: None
[0m13:19:43.759750 [info ] [MainThread]:   token_uri: None
[0m13:19:43.760039 [info ] [MainThread]:   compute_region: None
[0m13:19:43.760741 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:19:43.761111 [info ] [MainThread]:   gcs_bucket: None
[0m13:19:43.761431 [info ] [MainThread]:   dataproc_batch: None
[0m13:19:43.762050 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:19:44.031230 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:19:44.031811 [debug] [MainThread]: On debug: select 1 as id
[0m13:19:44.032186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:45.261800 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7e718c32-edf6-4700-b6d8-607643555131&page=queryresults
[0m13:19:45.978034 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:19:45.979346 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:19:45.989862 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.199829, "process_in_blocks": "0", "process_kernel_time": 0.770313, "process_mem_max_rss": "338935808", "process_out_blocks": "0", "process_user_time": 3.359032}
[0m13:19:45.991215 [debug] [MainThread]: Command `dbt debug` succeeded at 13:19:45.990974 after 5.20 seconds
[0m13:19:45.992173 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:19:45.992950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193c8100>]}
[0m13:19:45.993757 [debug] [MainThread]: Flushing usage events
[0m13:19:47.069380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:52.882782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034ab160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451e160>]}


============================== 13:19:52.886873 | 4e5b578c-b176-4f31-b843-41267a04706d ==============================
[0m13:19:52.886873 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:19:52.887436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:55.278683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258a40d0>]}
[0m13:19:55.338177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0fa00>]}
[0m13:19:55.338782 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:19:55.618364 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:19:55.771428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:55.772067 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews.sql
[0m13:19:56.083441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:19:56.089095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12615ceb0>]}
[0m13:19:56.160720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:19:56.163172 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:19:56.179833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dfa520>]}
[0m13:19:56.180322 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:19:56.180696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125970070>]}
[0m13:19:56.181877 [info ] [MainThread]: 
[0m13:19:56.182249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:56.182552 [info ] [MainThread]: 
[0m13:19:56.183044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:56.183798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:19:56.184233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:57.142769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:19:57.143958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:58.083460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261dffd0>]}
[0m13:19:58.085152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:58.094647 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews
[0m13:19:58.095797 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews .................................. [RUN]
[0m13:19:58.096653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews)
[0m13:19:58.097287 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews
[0m13:19:58.112130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews"
[0m13:19:58.113297 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews
[0m13:19:58.134577 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        DROP TABLE IF EXISTS `dbtandbigquery-467100.raw.food_reviews`
      
[0m13:19:58.135058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:59.615075 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3f317153-b080-46cd-9fab-8637867b6770&page=queryresults
[0m13:20:00.197214 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

        CREATE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:20:00.535321 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:cf54be8d-30e7-44e7-8707-ba961d415b8d&page=queryresults
[0m13:20:01.262600 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews"
[0m13:20:01.264159 [debug] [Thread-1  ]: On model.dbt_core.food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews`
    );
  
[0m13:20:01.787104 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9c391a9c-83a0-4bcd-9f31-2670d9aab89f&page=queryresults
[0m13:20:02.054273 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9c391a9c-83a0-4bcd-9f31-2670d9aab89f&page=queryresults
[0m13:20:02.111730 [debug] [Thread-1  ]: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:20:02.113835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5b578c-b176-4f31-b843-41267a04706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262ecb80>]}
[0m13:20:02.114521 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews ......................... [[31mERROR[0m in 4.02s]
[0m13:20:02.115104 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews
[0m13:20:02.115647 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql.
[0m13:20:02.116597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:02.118278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:02.118602 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews' was properly closed.
[0m13:20:02.118929 [info ] [MainThread]: 
[0m13:20:02.119359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m13:20:02.120349 [debug] [MainThread]: Command end result
[0m13:20:02.147346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:20:02.149435 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:20:02.156492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:20:02.156885 [info ] [MainThread]: 
[0m13:20:02.157305 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:20:02.157654 [info ] [MainThread]: 
[0m13:20:02.158061 [error] [MainThread]: [31mFailure in model food_reviews (models/raw/food_reviews.sql)[0m
[0m13:20:02.158447 [error] [MainThread]:   Database Error in model food_reviews (models/raw/food_reviews.sql)
  dbtandbigquery-467100:raw.food_reviews is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews.sql
[0m13:20:02.158759 [info ] [MainThread]: 
[0m13:20:02.159114 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews.sql
[0m13:20:02.159421 [info ] [MainThread]: 
[0m13:20:02.159757 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:20:02.164371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.353499, "process_in_blocks": "0", "process_kernel_time": 0.659726, "process_mem_max_rss": "361054208", "process_out_blocks": "0", "process_user_time": 4.22838}
[0m13:20:02.164932 [debug] [MainThread]: Command `dbt run` failed at 13:20:02.164851 after 9.35 seconds
[0m13:20:02.165340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034ab160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f43b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a4e820>]}
[0m13:20:02.165733 [debug] [MainThread]: Flushing usage events
[0m13:20:03.038822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:23.870880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a06220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a47ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a47a220>]}


============================== 13:21:23.875162 | 26a9e1a2-661a-47be-ac06-fda088b3c0f5 ==============================
[0m13:21:23.875162 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:21:23.875817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:26.680035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3d8e20>]}
[0m13:21:26.739483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a20a460>]}
[0m13:21:26.740106 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:21:27.018887 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:21:27.174356 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m13:21:27.174894 [debug] [MainThread]: Partial parsing: added file: dbt_core://models/raw/food_reviews_external.sql
[0m13:21:27.175408 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/schema.yml
[0m13:21:27.175728 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://models/raw/food_reviews.sql
[0m13:21:27.487826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:21:27.493445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14540b130>]}
[0m13:21:27.565511 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:21:27.568044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:21:27.585474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1447d2fd0>]}
[0m13:21:27.585988 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:21:27.586367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453fdf40>]}
[0m13:21:27.587559 [info ] [MainThread]: 
[0m13:21:27.587937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:27.588258 [info ] [MainThread]: 
[0m13:21:27.588758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:27.589544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:21:27.589959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.714527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:21:28.715762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:30.281874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144603b20>]}
[0m13:21:30.282561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:30.287024 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:21:30.287638 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_external ......................... [RUN]
[0m13:21:30.288262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_external)
[0m13:21:30.288651 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:21:30.299335 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:21:30.300521 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:21:30.322093 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        DROP TABLE IF EXISTS `dbtandbigquery-467100.raw.food_reviews_external`
      
[0m13:21:30.322634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:31.377111 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:45092ac8-fa5e-4ee0-af55-8a84dc4b14e9&page=queryresults
[0m13:21:31.966014 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:21:32.349877 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6e20afc1-b2ef-4dce-9147-1de4ddcf4019&page=queryresults
[0m13:21:33.165669 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_external"
[0m13:21:33.166874 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_external`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_external.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews_external`
    );
  
[0m13:21:33.623595 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1440f197-f0ec-4c0a-a7d4-b4be5d2345d2&page=queryresults
[0m13:21:33.875386 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1440f197-f0ec-4c0a-a7d4-b4be5d2345d2&page=queryresults
[0m13:21:33.931760 [debug] [Thread-1  ]: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:21:33.933883 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a9e1a2-661a-47be-ac06-fda088b3c0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1454e1130>]}
[0m13:21:33.934590 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_external ................ [[31mERROR[0m in 3.64s]
[0m13:21:33.935189 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:21:33.935696 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_external' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql.
[0m13:21:33.936605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:33.938267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:33.938586 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:21:33.938911 [info ] [MainThread]: 
[0m13:21:33.939352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m13:21:33.940327 [debug] [MainThread]: Command end result
[0m13:21:33.968445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:21:33.970476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:21:33.977100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:21:33.977457 [info ] [MainThread]: 
[0m13:21:33.977854 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:21:33.978189 [info ] [MainThread]: 
[0m13:21:33.978590 [error] [MainThread]: [31mFailure in model food_reviews_external (models/raw/food_reviews_external.sql)[0m
[0m13:21:33.978973 [error] [MainThread]:   Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:21:33.979293 [info ] [MainThread]: 
[0m13:21:33.979647 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_external.sql
[0m13:21:33.979947 [info ] [MainThread]: 
[0m13:21:33.980276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:21:33.985302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.190295, "process_in_blocks": "0", "process_kernel_time": 0.816254, "process_mem_max_rss": "344965120", "process_out_blocks": "0", "process_user_time": 4.251574}
[0m13:21:33.985821 [debug] [MainThread]: Command `dbt run` failed at 13:21:33.985727 after 10.19 seconds
[0m13:21:33.986234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a06220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3d8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ccb730>]}
[0m13:21:33.986632 [debug] [MainThread]: Flushing usage events
[0m13:21:35.545812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:43.918396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878e1f0>]}


============================== 13:22:43.922672 | 1fe59af7-8554-4e8f-8d22-dbac10daf719 ==============================
[0m13:22:43.922672 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:22:43.923215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:22:46.797894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e95220>]}
[0m13:22:46.856530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143da0850>]}
[0m13:22:46.857135 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:22:47.136761 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:22:47.293163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:47.293612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:47.300616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:22:47.330796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453c2130>]}
[0m13:22:47.404060 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:22:47.406419 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:22:47.423785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453ab250>]}
[0m13:22:47.424292 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:22:47.424652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145500190>]}
[0m13:22:47.425769 [info ] [MainThread]: 
[0m13:22:47.426152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:22:47.426458 [info ] [MainThread]: 
[0m13:22:47.426938 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:47.427736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:22:47.428101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:48.691446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:22:48.692556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:52.401049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108756d90>]}
[0m13:22:52.402511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:52.406283 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:22:52.406865 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_external ......................... [RUN]
[0m13:22:52.407417 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.dbt_core.food_reviews_external'
[0m13:22:52.407790 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:22:52.418681 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:22:52.419820 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:22:52.441571 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        DROP TABLE IF EXISTS `dbtandbigquery-467100.raw.food_reviews_external`
      
[0m13:22:52.442086 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:22:53.469861 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6577ddc7-cf85-4831-9e70-9d6568bf3a08&page=queryresults
[0m13:22:54.084686 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE EXTERNAL TABLE `dbtandbigquery-467100.raw.food_reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:22:54.431648 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:68aebb53-8337-487a-a393-49b5b0c8475a&page=queryresults
[0m13:22:55.227298 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_external"
[0m13:22:55.228621 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_external`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_external.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews_external`
    );
  
[0m13:22:55.680115 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3ddeccbf-0c2e-4db2-b516-50047e566f39&page=queryresults
[0m13:22:55.889119 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3ddeccbf-0c2e-4db2-b516-50047e566f39&page=queryresults
[0m13:22:55.948390 [debug] [Thread-1  ]: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:22:55.950532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe59af7-8554-4e8f-8d22-dbac10daf719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14561b4f0>]}
[0m13:22:55.951221 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_external ................ [[31mERROR[0m in 3.54s]
[0m13:22:55.951909 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:22:55.952442 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_external' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql.
[0m13:22:55.953380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:55.955146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:55.955480 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw' was properly closed.
[0m13:22:55.955785 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:22:55.956108 [info ] [MainThread]: 
[0m13:22:55.956509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m13:22:55.957381 [debug] [MainThread]: Command end result
[0m13:22:55.983137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:22:55.985345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:22:55.992080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:22:55.992426 [info ] [MainThread]: 
[0m13:22:55.992828 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:22:55.993165 [info ] [MainThread]: 
[0m13:22:55.993569 [error] [MainThread]: [31mFailure in model food_reviews_external (models/raw/food_reviews_external.sql)[0m
[0m13:22:55.993960 [error] [MainThread]:   Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:22:55.994274 [info ] [MainThread]: 
[0m13:22:55.994627 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_external.sql
[0m13:22:55.994927 [info ] [MainThread]: 
[0m13:22:55.995262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:22:56.000289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.158204, "process_in_blocks": "0", "process_kernel_time": 0.837463, "process_mem_max_rss": "353615872", "process_out_blocks": "0", "process_user_time": 4.040899}
[0m13:22:56.000813 [debug] [MainThread]: Command `dbt run` failed at 13:22:56.000720 after 12.16 seconds
[0m13:22:56.001223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453ab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c26a0>]}
[0m13:22:56.001620 [debug] [MainThread]: Flushing usage events
[0m13:22:57.937560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:11.494366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031961f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420a160>]}


============================== 13:24:11.498991 | 16dc1fcc-5911-41de-ba0d-8ca3afba1795 ==============================
[0m13:24:11.498991 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:24:11.499640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:14.348915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16dc1fcc-5911-41de-ba0d-8ca3afba1795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153194e80>]}
[0m13:24:14.408319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16dc1fcc-5911-41de-ba0d-8ca3afba1795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1581d1a60>]}
[0m13:24:14.409097 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:24:14.692425 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:24:14.847651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:14.848315 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_external.sql
[0m13:24:15.031580 [error] [MainThread]: Encountered an error:
Compilation Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  bad operand type for unary -: 'str'
[0m13:24:15.036261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.619382, "process_in_blocks": "0", "process_kernel_time": 0.73667, "process_mem_max_rss": "347488256", "process_out_blocks": "0", "process_user_time": 3.571202}
[0m13:24:15.036741 [debug] [MainThread]: Command `dbt run` failed at 13:24:15.036648 after 3.62 seconds
[0m13:24:15.037142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031961f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158441bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158983be0>]}
[0m13:24:15.037531 [debug] [MainThread]: Flushing usage events
[0m13:24:17.139918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:43.040921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103caa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1e1f0>]}


============================== 13:24:43.046230 | 7d1db064-9204-403d-abd0-1bf764a73b11 ==============================
[0m13:24:43.046230 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:24:43.047216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:45.829581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102425220>]}
[0m13:24:45.889635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463a970>]}
[0m13:24:45.890314 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:24:46.171179 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:24:46.325493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:46.326228 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_external.sql
[0m13:24:46.642549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:24:46.648336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b53130>]}
[0m13:24:46.719633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:24:46.721984 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:24:46.739812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137812d60>]}
[0m13:24:46.740329 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:24:46.740693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13737a730>]}
[0m13:24:46.741876 [info ] [MainThread]: 
[0m13:24:46.742265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:46.742575 [info ] [MainThread]: 
[0m13:24:46.743064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:46.743846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:24:46.744267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:50.553497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:24:50.555354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:52.024269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a97490>]}
[0m13:24:52.025967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:52.034915 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:24:52.035721 [info ] [Thread-1  ]: 1 of 1 START sql table model raw.food_reviews_external ......................... [RUN]
[0m13:24:52.036295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_external)
[0m13:24:52.036688 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:24:52.047525 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:24:52.048516 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:24:52.069715 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE EXTERNAL TABLE IF NOT EXISTS `dbtandbigquery-467100.raw.food_reviews_external` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:24:52.070224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:58.511641 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f18bce4c-4bb1-4417-83df-89099f589a11&page=queryresults
[0m13:24:59.676428 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_external"
[0m13:24:59.677361 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw`.`food_reviews_external`
      
    
    

    
    OPTIONS()
    as (
      -- models/raw/food_reviews_external.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.food_reviews_external`
    );
  
[0m13:25:00.183076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9ccbfbc6-b69a-448a-9525-da4efb218a7f&page=queryresults
[0m13:25:00.694747 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9ccbfbc6-b69a-448a-9525-da4efb218a7f&page=queryresults
[0m13:25:00.754332 [debug] [Thread-1  ]: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:25:00.756368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1db064-9204-403d-abd0-1bf764a73b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d2c790>]}
[0m13:25:00.757062 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model raw.food_reviews_external ................ [[31mERROR[0m in 8.72s]
[0m13:25:00.757654 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:25:00.758217 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_external' to be skipped because of status 'error'.  Reason: Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql.
[0m13:25:00.759219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:00.760973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:00.761309 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:25:00.761634 [info ] [MainThread]: 
[0m13:25:00.761969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m13:25:00.762884 [debug] [MainThread]: Command end result
[0m13:25:00.789671 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:25:00.791739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:25:00.798278 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:25:00.798628 [info ] [MainThread]: 
[0m13:25:00.799027 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:25:00.799364 [info ] [MainThread]: 
[0m13:25:00.799775 [error] [MainThread]: [31mFailure in model food_reviews_external (models/raw/food_reviews_external.sql)[0m
[0m13:25:00.800157 [error] [MainThread]:   Database Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  dbtandbigquery-467100:raw.food_reviews_external is not allowed for this operation because it currently has type EXTERNAL.
  compiled code at target/run/dbt_core/models/raw/food_reviews_external.sql
[0m13:25:00.800463 [info ] [MainThread]: 
[0m13:25:00.800814 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_external.sql
[0m13:25:00.801117 [info ] [MainThread]: 
[0m13:25:00.801448 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:25:00.805794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.844065, "process_in_blocks": "0", "process_kernel_time": 0.814071, "process_mem_max_rss": "352403456", "process_out_blocks": "0", "process_user_time": 4.263041}
[0m13:25:00.806260 [debug] [MainThread]: Command `dbt run` failed at 13:25:00.806175 after 17.84 seconds
[0m13:25:00.806652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103caa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103229520>]}
[0m13:25:00.807035 [debug] [MainThread]: Flushing usage events
[0m13:25:01.755925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:50.492866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d761f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dea160>]}


============================== 13:27:50.497331 | 5b8bdcf6-e1e5-4887-874e-6edf2b72b55b ==============================
[0m13:27:50.497331 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:27:50.497892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:53.358858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196de1c0>]}
[0m13:27:53.418595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59550>]}
[0m13:27:53.419239 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:27:53.700633 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:27:53.855159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:53.855775 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/food_reviews_external.sql
[0m13:27:54.167722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:27:54.173335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ed2f70>]}
[0m13:27:54.245460 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:27:54.248751 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:27:54.266071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c7e910>]}
[0m13:27:54.266571 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:27:54.266939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dcf550>]}
[0m13:27:54.268117 [info ] [MainThread]: 
[0m13:27:54.268497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:54.268807 [info ] [MainThread]: 
[0m13:27:54.269281 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:54.270044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:27:54.270458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.363690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:27:55.364991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:04.923064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ee4e50>]}
[0m13:28:04.924833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:04.930329 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:28:04.931074 [info ] [Thread-1  ]: 1 of 1 START sql view model raw.food_reviews_external .......................... [RUN]
[0m13:28:04.931785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_external)
[0m13:28:04.932254 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:28:04.943869 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:28:04.945298 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:28:04.967499 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.gcs_reviews_source` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:28:04.967988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:06.076322 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:eecc3b31-0411-4416-aed1-225d8560774c&page=queryresults
[0m13:28:06.996708 [debug] [Thread-1  ]: Compilation Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  Trying to create view `dbtandbigquery-467100`.`raw`.`food_reviews_external`, but it currently exists as a external. Either drop `dbtandbigquery-467100`.`raw`.`food_reviews_external` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model food_reviews_external (models/raw/food_reviews_external.sql)
[0m13:28:06.998732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8bdcf6-e1e5-4887-874e-6edf2b72b55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0a8730>]}
[0m13:28:06.999433 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model raw.food_reviews_external ................. [[31mERROR[0m in 2.07s]
[0m13:28:07.000058 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:28:07.000573 [debug] [Thread-4  ]: Marking all children of 'model.dbt_core.food_reviews_external' to be skipped because of status 'error'.  Reason: Compilation Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  Trying to create view `dbtandbigquery-467100`.`raw`.`food_reviews_external`, but it currently exists as a external. Either drop `dbtandbigquery-467100`.`raw`.`food_reviews_external` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model food_reviews_external (models/raw/food_reviews_external.sql).
[0m13:28:07.001462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:07.003103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:07.003428 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:28:07.003748 [info ] [MainThread]: 
[0m13:28:07.004097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.73 seconds (12.73s).
[0m13:28:07.004751 [debug] [MainThread]: Command end result
[0m13:28:07.030537 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:28:07.032558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:28:07.039087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:28:07.039432 [info ] [MainThread]: 
[0m13:28:07.039834 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:28:07.040171 [info ] [MainThread]: 
[0m13:28:07.040573 [error] [MainThread]: [31mFailure in model food_reviews_external (models/raw/food_reviews_external.sql)[0m
[0m13:28:07.040977 [error] [MainThread]:   Compilation Error in model food_reviews_external (models/raw/food_reviews_external.sql)
  Trying to create view `dbtandbigquery-467100`.`raw`.`food_reviews_external`, but it currently exists as a external. Either drop `dbtandbigquery-467100`.`raw`.`food_reviews_external` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model food_reviews_external (models/raw/food_reviews_external.sql)
[0m13:28:07.041307 [info ] [MainThread]: 
[0m13:28:07.041658 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/food_reviews_external.sql
[0m13:28:07.041959 [info ] [MainThread]: 
[0m13:28:07.042296 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:28:07.047284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.634117, "process_in_blocks": "0", "process_kernel_time": 0.813466, "process_mem_max_rss": "352239616", "process_out_blocks": "0", "process_user_time": 4.213252}
[0m13:28:07.047794 [debug] [MainThread]: Command `dbt run` failed at 13:28:07.047703 after 16.63 seconds
[0m13:28:07.048201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d761f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c7e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ebd400>]}
[0m13:28:07.048591 [debug] [MainThread]: Flushing usage events
[0m13:28:09.498987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:46.733758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103242250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b61c0>]}


============================== 13:28:46.738384 | 3d7ef74a-00cc-46bf-b020-042ee78228c2 ==============================
[0m13:28:46.738384 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:28:46.738978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select food_reviews_external --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:49.605305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019bd8e0>]}
[0m13:28:49.667223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f3fd0>]}
[0m13:28:49.668005 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:28:49.955610 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:28:50.113215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:50.113661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:50.121179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:28:50.151790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eac5130>]}
[0m13:28:50.226052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:28:50.228502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:28:50.247300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eae1880>]}
[0m13:28:50.247849 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:28:50.248226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea61e50>]}
[0m13:28:50.249685 [info ] [MainThread]: 
[0m13:28:50.250117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:50.250442 [info ] [MainThread]: 
[0m13:28:50.250954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:50.251893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:28:50.252317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:55.858786 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_raw'
[0m13:28:55.860138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:57.829331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea61e50>]}
[0m13:28:57.830514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:57.839058 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:28:57.840154 [info ] [Thread-1  ]: 1 of 1 START sql view model raw.food_reviews_external .......................... [RUN]
[0m13:28:57.841045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw, now model.dbt_core.food_reviews_external)
[0m13:28:57.841581 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:28:57.855863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:28:57.856813 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:28:57.880055 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.gcs_reviews_source` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:28:57.880601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:58.991613 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:824f6493-cf71-4fcc-b7fc-1d99304012b7&page=queryresults
[0m13:29:00.176404 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_external"
[0m13:29:00.178063 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */


  create or replace view `dbtandbigquery-467100`.`raw`.`food_reviews_external`
  OPTIONS()
  as -- models/raw/food_reviews_external.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.gcs_reviews_source`;


[0m13:29:00.681646 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:65ff3d4c-8027-4476-8d18-5e5fee8f88cf&page=queryresults
[0m13:29:01.219825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7ef74a-00cc-46bf-b020-042ee78228c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ebec1f0>]}
[0m13:29:01.220585 [info ] [Thread-1  ]: 1 of 1 OK created sql view model raw.food_reviews_external ..................... [[32mCREATE VIEW (0 processed)[0m in 3.38s]
[0m13:29:01.221209 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:29:01.222103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:01.223863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:01.224193 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100' was properly closed.
[0m13:29:01.224485 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:29:01.224801 [info ] [MainThread]: 
[0m13:29:01.225133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m13:29:01.225767 [debug] [MainThread]: Command end result
[0m13:29:01.252933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:29:01.255197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:29:01.261897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:29:01.262235 [info ] [MainThread]: 
[0m13:29:01.262653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:01.262975 [info ] [MainThread]: 
[0m13:29:01.263318 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:29:01.267686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.61123, "process_in_blocks": "0", "process_kernel_time": 0.770038, "process_mem_max_rss": "348995584", "process_out_blocks": "0", "process_user_time": 4.0373}
[0m13:29:01.268246 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:01.268149 after 14.61 seconds
[0m13:29:01.268659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103242250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027e7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dbd9160>]}
[0m13:29:01.269465 [debug] [MainThread]: Flushing usage events
[0m13:29:02.220764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:04.035833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ede190>]}


============================== 13:30:04.040283 | 87cc9ddb-54f8-4168-b67a-218b4c45c7d4 ==============================
[0m13:30:04.040283 [info ] [MainThread]: Running with dbt=1.10.5
[0m13:30:04.040892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select food_reviews_external --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:30:06.945183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120127190>]}
[0m13:30:07.006794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479d070>]}
[0m13:30:07.007487 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m13:30:07.294946 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m13:30:07.452444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:07.452923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:07.460215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.example
[0m13:30:07.491415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120704130>]}
[0m13:30:07.566526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:30:07.569173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:30:07.587145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12067cd60>]}
[0m13:30:07.587670 [info ] [MainThread]: Found 1 model, 494 macros
[0m13:30:07.588030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120741040>]}
[0m13:30:07.588993 [info ] [MainThread]: 
[0m13:30:07.589361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:07.589663 [info ] [MainThread]: 
[0m13:30:07.590125 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:30:07.591000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m13:30:07.591445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:08.861042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now list_dbtandbigquery-467100_raw)
[0m13:30:08.861919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:10.545961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f55a30>]}
[0m13:30:10.548202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:10.554107 [debug] [Thread-1  ]: Began running node model.dbt_core.food_reviews_external
[0m13:30:10.554896 [info ] [Thread-1  ]: 1 of 1 START sql view model raw.food_reviews_external .......................... [RUN]
[0m13:30:10.555663 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.dbt_core.food_reviews_external'
[0m13:30:10.556169 [debug] [Thread-1  ]: Began compiling node model.dbt_core.food_reviews_external
[0m13:30:10.569544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.food_reviews_external"
[0m13:30:10.570492 [debug] [Thread-1  ]: Began executing node model.dbt_core.food_reviews_external
[0m13:30:10.593627 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */

        CREATE OR REPLACE EXTERNAL TABLE `dbtandbigquery-467100.raw.gcs_reviews_source` OPTIONS (format = 'PARQUET', uris = ['gs://raw--dbt-and-bigquery-test/reviews.parquet'])
      
[0m13:30:10.594152 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:30:11.755962 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f73268d7-5963-4e76-9e59-4eba91854a82&page=queryresults
[0m13:30:12.914314 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.food_reviews_external"
[0m13:30:12.915337 [debug] [Thread-1  ]: On model.dbt_core.food_reviews_external: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.food_reviews_external"} */


  create or replace view `dbtandbigquery-467100`.`raw`.`food_reviews_external`
  OPTIONS()
  as -- models/raw/food_reviews_external.sql



SELECT 
  ReviewId,
  RecipeId,
  AuthorId,
  AuthorName,
  Rating,
  Review,
  DateSubmitted AS date_submitted,
  DateModified AS date_modified
FROM `dbtandbigquery-467100.raw.gcs_reviews_source`;


[0m13:30:13.370736 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:bebefdda-9677-4761-bbf4-1f574995b2f7&page=queryresults
[0m13:30:13.937544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87cc9ddb-54f8-4168-b67a-218b4c45c7d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121823c40>]}
[0m13:30:13.938438 [info ] [Thread-1  ]: 1 of 1 OK created sql view model raw.food_reviews_external ..................... [[32mCREATE VIEW (0 processed)[0m in 3.38s]
[0m13:30:13.939288 [debug] [Thread-1  ]: Finished running node model.dbt_core.food_reviews_external
[0m13:30:13.940416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:13.942353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:13.942731 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw' was properly closed.
[0m13:30:13.943043 [debug] [MainThread]: Connection 'model.dbt_core.food_reviews_external' was properly closed.
[0m13:30:13.943376 [info ] [MainThread]: 
[0m13:30:13.943929 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m13:30:13.945060 [debug] [MainThread]: Command end result
[0m13:30:13.972400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m13:30:13.974418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m13:30:13.981642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m13:30:13.982045 [info ] [MainThread]: 
[0m13:30:13.982482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:13.982811 [info ] [MainThread]: 
[0m13:30:13.983155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:30:13.987313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.030037, "process_in_blocks": "0", "process_kernel_time": 0.842329, "process_mem_max_rss": "349224960", "process_out_blocks": "0", "process_user_time": 4.021291}
[0m13:30:13.987772 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:13.987688 after 10.03 seconds
[0m13:30:13.988157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206edac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120127190>]}
[0m13:30:13.988889 [debug] [MainThread]: Flushing usage events
[0m13:30:16.099570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:41.054615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c7a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cecca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cec2b0>]}


============================== 15:10:41.059180 | f6ab5a9c-8a6e-49a1-a168-db93d1c79694 ==============================
[0m15:10:41.059180 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:10:41.059854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:41.074160 [info ] [MainThread]: dbt version: 1.10.5
[0m15:10:41.074594 [info ] [MainThread]: python version: 3.9.6
[0m15:10:41.074945 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m15:10:41.075272 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m15:10:43.887444 [info ] [MainThread]: Using profiles dir at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core
[0m15:10:43.887983 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/profiles.yml
[0m15:10:43.888364 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m15:10:43.888706 [info ] [MainThread]: adapter type: bigquery
[0m15:10:43.889023 [info ] [MainThread]: adapter version: 1.10.0
[0m15:10:44.058911 [info ] [MainThread]: Configuration:
[0m15:10:44.059473 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:10:44.059834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:10:44.060160 [info ] [MainThread]: Required dependencies:
[0m15:10:44.060758 [debug] [MainThread]: Executing "git --help"
[0m15:10:44.091932 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:10:44.092912 [debug] [MainThread]: STDERR: "b''"
[0m15:10:44.093332 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:10:44.093781 [info ] [MainThread]: Connection:
[0m15:10:44.094467 [info ] [MainThread]:   method: service-account
[0m15:10:44.095732 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m15:10:44.096315 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m15:10:44.096733 [info ] [MainThread]:   schema: raw
[0m15:10:44.097066 [info ] [MainThread]:   location: us-central1
[0m15:10:44.097380 [info ] [MainThread]:   priority: interactive
[0m15:10:44.097815 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:10:44.098809 [info ] [MainThread]:   impersonate_service_account: None
[0m15:10:44.099399 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:10:44.099736 [info ] [MainThread]:   job_retries: 1
[0m15:10:44.100040 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:10:44.100345 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:10:44.100645 [info ] [MainThread]:   timeout_seconds: 300
[0m15:10:44.100945 [info ] [MainThread]:   client_id: None
[0m15:10:44.101238 [info ] [MainThread]:   token_uri: None
[0m15:10:44.101532 [info ] [MainThread]:   compute_region: None
[0m15:10:44.101828 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:10:44.102121 [info ] [MainThread]:   gcs_bucket: None
[0m15:10:44.102415 [info ] [MainThread]:   dataproc_batch: None
[0m15:10:44.103064 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m15:10:44.372569 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:10:44.373209 [debug] [MainThread]: On debug: select 1 as id
[0m15:10:44.373601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:46.029962 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:81ab3536-485b-4772-96f7-b75b5d8b2d94&page=queryresults
[0m15:10:46.826648 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:10:46.828412 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:10:46.837135 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.862226, "process_in_blocks": "0", "process_kernel_time": 0.838156, "process_mem_max_rss": "342474752", "process_out_blocks": "0", "process_user_time": 3.46551}
[0m15:10:46.837826 [debug] [MainThread]: Command `dbt debug` succeeded at 15:10:46.837704 after 5.86 seconds
[0m15:10:46.838243 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:10:46.838696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c7a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139645520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395e4100>]}
[0m15:10:46.839170 [debug] [MainThread]: Flushing usage events
[0m15:10:49.600943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:00.690625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9e220>]}


============================== 15:11:00.695530 | 6b6b0235-b69f-4535-b430-5648a1263e90 ==============================
[0m15:11:00.695530 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:11:00.696217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_food_reviews', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:03.823626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b364460>]}
[0m15:11:03.892906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd5c40>]}
[0m15:11:03.893724 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m15:11:04.273960 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:11:04.382081 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:11:04.382822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5aa00>]}
[0m15:11:06.144916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m15:11:06.159240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0e1130>]}
[0m15:11:06.425901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:11:06.429366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:11:06.450772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e71d970>]}
[0m15:11:06.451376 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 494 macros
[0m15:11:06.451814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f28c100>]}
[0m15:11:06.453108 [info ] [MainThread]: 
[0m15:11:06.453540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:06.453905 [info ] [MainThread]: 
[0m15:11:06.454445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:11:06.455401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m15:11:06.455891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:07.480144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_raw_staging)
[0m15:11:07.482375 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "raw_staging"
"
[0m15:11:07.497252 [debug] [ThreadPool]: On create_dbtandbigquery-467100_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_raw_staging"} */
create schema if not exists `dbtandbigquery-467100`.`raw_staging`
  
[0m15:11:07.497843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:08.671049 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1903f3a3-4ec4-4543-a29d-003108bef767&page=queryresults
[0m15:11:09.584437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_raw_staging, now list_dbtandbigquery-467100_raw_marts)
[0m15:11:09.584920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:10.868094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_marts, now list_dbtandbigquery-467100_raw_staging)
[0m15:11:10.869265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:12.390801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026ad460>]}
[0m15:11:12.391974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:12.402000 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m15:11:12.403224 [info ] [Thread-1  ]: 1 of 1 START sql view model raw_staging.stg_food_reviews ....................... [RUN]
[0m15:11:12.404154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_staging, now model.dbt_core.stg_food_reviews)
[0m15:11:12.404843 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m15:11:12.419080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m15:11:12.420680 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m15:11:12.451055 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m15:11:12.452692 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */


  create or replace view `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
  OPTIONS()
  as -- 🥈 STAGING LAYER (Silver)
-- Responsável por: Limpeza, Padronização, Renomeação, Validação



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- IDs padronizados
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- Limpeza de strings
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Padronização de rating
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 é inválido
            ELSE NULL
        END AS rating,
        
        -- Padronização de datas
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Campos calculados
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Flags de qualidade
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filtrar apenas reviews válidos
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL;


[0m15:11:12.453257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:11:13.752866 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:92e8c977-4d33-44fa-87dc-347979dc81fe&page=queryresults
[0m15:11:14.351766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6b0235-b69f-4535-b430-5648a1263e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e564b80>]}
[0m15:11:14.352591 [info ] [Thread-1  ]: 1 of 1 OK created sql view model raw_staging.stg_food_reviews .................. [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m15:11:14.353242 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m15:11:14.354306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:14.356455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:14.356792 [debug] [MainThread]: Connection 'model.dbt_core.stg_food_reviews' was properly closed.
[0m15:11:14.357126 [info ] [MainThread]: 
[0m15:11:14.357474 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m15:11:14.358912 [debug] [MainThread]: Command end result
[0m15:11:14.391551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:11:14.393783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:11:14.400640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m15:11:14.401023 [info ] [MainThread]: 
[0m15:11:14.401448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:14.401780 [info ] [MainThread]: 
[0m15:11:14.402127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:11:14.406230 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.8001995, "process_in_blocks": "0", "process_kernel_time": 0.938132, "process_mem_max_rss": "363675648", "process_out_blocks": "0", "process_user_time": 6.577092}
[0m15:11:14.406685 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:14.406602 after 13.80 seconds
[0m15:11:14.407066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f14160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eee310>]}
[0m15:11:14.407463 [debug] [MainThread]: Flushing usage events
[0m15:11:15.225394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:26.386702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106186280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fb250>]}


============================== 15:11:26.390915 | 08420d12-8ec6-45da-8c97-d2f814b4936c ==============================
[0m15:11:26.390915 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:11:26.391493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_review_metrics mart_author_insights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:11:28.933919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499d4bb0>]}
[0m15:11:28.993788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca33d0>]}
[0m15:11:28.994538 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m15:11:29.278095 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:11:29.470711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:29.472142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:29.479678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m15:11:29.535148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a401130>]}
[0m15:11:29.647807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:11:29.650357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:11:29.669312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2c9040>]}
[0m15:11:29.669842 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 494 macros
[0m15:11:29.670215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a444040>]}
[0m15:11:29.671525 [info ] [MainThread]: 
[0m15:11:29.671937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:29.672256 [info ] [MainThread]: 
[0m15:11:29.672764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:11:29.677715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m15:11:29.678157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:30.710965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_raw_marts)
[0m15:11:30.711783 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "raw_marts"
"
[0m15:11:30.723831 [debug] [ThreadPool]: On create_dbtandbigquery-467100_raw_marts: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_raw_marts"} */
create schema if not exists `dbtandbigquery-467100`.`raw_marts`
  
[0m15:11:30.724291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:31.879601 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a1bb8b27-e602-4bfc-a192-8093c63fb164&page=queryresults
[0m15:11:33.094223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_raw_staging'
[0m15:11:33.094789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:34.324613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_staging, now list_dbtandbigquery-467100_raw_marts)
[0m15:11:34.325827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:35.290959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ba0d0>]}
[0m15:11:35.292556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:35.302799 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m15:11:35.303907 [info ] [Thread-1  ]: 1 of 2 START sql table model raw_marts.mart_author_insights .................... [RUN]
[0m15:11:35.304819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_marts, now model.dbt_core.mart_author_insights)
[0m15:11:35.305472 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m15:11:35.318925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m15:11:35.320563 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m15:11:35.364392 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m15:11:35.365934 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw_marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Insights de Autores - Comportamento e Padrões dos Reviewers



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Métricas de Atividade
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Métricas de Avaliação
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Padrões de Rating
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Categorização de Atividade
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Ativo'
            WHEN COUNT(*) >= 20 THEN 'Muito Ativo'
            WHEN COUNT(*) >= 10 THEN 'Ativo'
            WHEN COUNT(*) >= 5 THEN 'Moderado'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Categorização de Comportamento
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Otimista'
            WHEN AVG(rating) <= 2.5 THEN 'Crítico'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistente'
            ELSE 'Variado'
        END AS rating_behavior,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Apenas autores com pelo menos 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m15:11:35.366546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:11:37.460237 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e3cf8a05-0673-4404-94da-b9f174e0964a&page=queryresults
[0m15:11:50.863747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a72e0>]}
[0m15:11:50.864753 [info ] [Thread-1  ]: 1 of 2 OK created sql table model raw_marts.mart_author_insights ............... [[32mCREATE TABLE (42.2k rows, 440.4 MiB processed)[0m in 15.56s]
[0m15:11:50.865475 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m15:11:50.865924 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m15:11:50.866509 [info ] [Thread-1  ]: 2 of 2 START sql table model raw_marts.mart_review_metrics ..................... [RUN]
[0m15:11:50.867103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m15:11:50.867518 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m15:11:50.872354 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m15:11:50.873318 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m15:11:50.876744 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m15:11:50.877682 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw_marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Métricas de Avaliações por Receita - Pronto para BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Métricas de Volume
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Métricas de Rating
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Distribuição de Ratings
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Categorização de Popularidade
        CASE 
            WHEN COUNT(*) >= 100 THEN 'Alta'
            WHEN COUNT(*) >= 50 THEN 'Média'
            WHEN COUNT(*) >= 10 THEN 'Baixa'
            ELSE 'Muito Baixa'
        END AS popularity_category,
        
        -- Categorização de Qualidade
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excelente'
            WHEN AVG(rating) >= 4.0 THEN 'Muito Boa'
            WHEN AVG(rating) >= 3.5 THEN 'Boa'
            WHEN AVG(rating) >= 3.0 THEN 'Regular'
            ELSE 'Ruim'
        END AS quality_category,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m15:11:50.878243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:11:52.794811 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7cb3f2c8-85e3-4fe3-8672-3a89b2094315&page=queryresults
[0m15:12:06.926315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08420d12-8ec6-45da-8c97-d2f814b4936c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640bd00>]}
[0m15:12:06.927591 [info ] [Thread-1  ]: 2 of 2 OK created sql table model raw_marts.mart_review_metrics ................ [[32mCREATE TABLE (265.8k rows, 424.4 MiB processed)[0m in 16.06s]
[0m15:12:06.928420 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m15:12:06.929542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:06.931820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:06.932211 [debug] [MainThread]: Connection 'create_dbtandbigquery-467100_raw_marts' was properly closed.
[0m15:12:06.932562 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m15:12:06.932992 [info ] [MainThread]: 
[0m15:12:06.933401 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 37.26 seconds (37.26s).
[0m15:12:06.934906 [debug] [MainThread]: Command end result
[0m15:12:06.967057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:12:06.969461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:12:06.976528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m15:12:06.976938 [info ] [MainThread]: 
[0m15:12:06.977378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:06.977725 [info ] [MainThread]: 
[0m15:12:06.978101 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:12:06.984290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.671803, "process_in_blocks": "0", "process_kernel_time": 0.704965, "process_mem_max_rss": "353304576", "process_out_blocks": "0", "process_user_time": 4.338897}
[0m15:12:06.984841 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:06.984746 after 40.67 seconds
[0m15:12:06.985258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106186280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646f160>]}
[0m15:12:06.985672 [debug] [MainThread]: Flushing usage events
[0m15:12:08.899446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:19.954458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106086220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be13a0>]}


============================== 15:12:19.962300 | 406e40c5-f744-4c8d-a9c1-8effbc4a4c89 ==============================
[0m15:12:19.962300 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:12:19.962984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:22.841452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b730>]}
[0m15:12:22.902853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b85d60>]}
[0m15:12:22.903538 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m15:12:23.195549 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:12:23.392213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:23.392697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:23.400106 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m15:12:23.459445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143081130>]}
[0m15:12:23.577465 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:12:23.580293 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:12:23.610940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431ce3d0>]}
[0m15:12:23.611691 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 494 macros
[0m15:12:23.612158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143090160>]}
[0m15:12:23.614318 [info ] [MainThread]: 
[0m15:12:23.614775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:23.615145 [info ] [MainThread]: 
[0m15:12:23.615736 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:12:23.621553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_raw_staging'
[0m15:12:23.622087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:25.510126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_staging, now list_dbtandbigquery-467100_raw_marts)
[0m15:12:25.511868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:26.784832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406e40c5-f744-4c8d-a9c1-8effbc4a4c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143209fa0>]}
[0m15:12:26.786672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:26.794767 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:12:26.795712 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ...... [RUN]
[0m15:12:26.796659 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73'
[0m15:12:26.797224 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:12:26.821630 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m15:12:26.823288 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:12:26.851158 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m15:12:26.852474 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m15:12:26.852987 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:12:28.268145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:fa7f7722-893e-4010-82f0-23e6ab256928&page=queryresults
[0m15:12:28.269640 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:fa7f7722-893e-4010-82f0-23e6ab256928&page=queryresults
[0m15:12:28.321891 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:12:28.322581 [error] [Thread-1  ]: 1 of 12 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ........... [[31mERROR[0m in 1.53s]
[0m15:12:28.323192 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:12:28.323615 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m15:12:28.324146 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m15:12:28.324572 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m15:12:28.325168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m15:12:28.325564 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m15:12:28.334210 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m15:12:28.335334 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m15:12:28.338687 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m15:12:28.339668 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`raw_marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m15:12:28.340093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:30.198404 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9ab79747-b6c4-4986-9c07-12c30c044ed0&page=queryresults
[0m15:12:31.475040 [info ] [Thread-1  ]: 2 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 3.15s]
[0m15:12:31.476354 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m15:12:31.477098 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m15:12:31.477972 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m15:12:31.478920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m15:12:31.479617 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m15:12:31.486983 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m15:12:31.488340 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m15:12:31.492185 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m15:12:31.493238 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`raw_marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m15:12:31.493738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:41.083588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:82385dca-358e-4dea-a575-190cc52c5fbf&page=queryresults
[0m15:12:41.977071 [info ] [Thread-1  ]: 3 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 10.50s]
[0m15:12:41.978945 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m15:12:41.980168 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:12:41.981244 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m15:12:41.982381 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m15:12:41.983181 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:12:41.995093 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m15:12:41.996784 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:12:42.001329 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m15:12:42.002500 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m15:12:42.003066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:44.069754 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:ef8ae2d7-9c25-4aa1-a810-e9e8eae32c79&page=queryresults
[0m15:12:44.961189 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.98s]
[0m15:12:44.964556 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:12:44.965740 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:12:44.966905 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m15:12:44.968144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m15:12:44.968924 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:12:44.975170 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m15:12:44.976440 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:12:44.979886 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m15:12:44.980987 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m15:12:44.981610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:52.346737 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:ea7aeda4-2854-458d-b012-81f2e817d847&page=queryresults
[0m15:12:54.131768 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 9.16s]
[0m15:12:54.132986 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:12:54.133706 [debug] [Thread-1  ]: Began running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m15:12:54.134485 [info ] [Thread-1  ]: 6 of 12 START test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [RUN]
[0m15:12:54.135415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56)
[0m15:12:54.136116 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m15:12:54.144606 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m15:12:54.147048 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m15:12:54.151159 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m15:12:54.152272 [debug] [Thread-1  ]: On test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    group by Rating

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m15:12:54.152735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:55.798062 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:12341b04-972b-4c6f-9a1e-76b4e31e8e85&page=queryresults
[0m15:12:55.799429 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:12341b04-972b-4c6f-9a1e-76b4e31e8e85&page=queryresults
[0m15:12:55.819553 [debug] [Thread-1  ]: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m15:12:55.820309 [error] [Thread-1  ]: 6 of 12 ERROR source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [[31mERROR[0m in 1.68s]
[0m15:12:55.820944 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m15:12:55.821369 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m15:12:55.821880 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql.
[0m15:12:55.822316 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m15:12:55.822980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m15:12:55.823423 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m15:12:55.830453 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m15:12:55.831596 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m15:12:55.834703 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m15:12:55.835517 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m15:12:55.835937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:58.131629 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:fed4955e-b61f-484c-b706-e4a5026f5edc&page=queryresults
[0m15:12:58.966319 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 3.14s]
[0m15:12:58.967949 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m15:12:58.968840 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m15:12:58.969752 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m15:12:58.970853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m15:12:58.971556 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m15:12:58.980392 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m15:12:58.982057 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m15:12:58.986249 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m15:12:58.987317 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m15:12:58.987825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:01.633827 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b6094a4d-8cfe-4830-957e-def0da6abb0c&page=queryresults
[0m15:13:02.516719 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 3.55s]
[0m15:13:02.517651 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m15:13:02.518111 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m15:13:02.518588 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m15:13:02.519163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m15:13:02.519576 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m15:13:02.527250 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m15:13:02.528305 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m15:13:02.531764 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m15:13:02.532647 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:02.533085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:04.657065 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a7f940fc-078b-4539-a003-8eafb86578ae&page=queryresults
[0m15:13:05.744910 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 3.23s]
[0m15:13:05.746800 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m15:13:05.747695 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m15:13:05.748483 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m15:13:05.749502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m15:13:05.750198 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m15:13:05.758062 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m15:13:05.759540 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m15:13:05.763051 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m15:13:05.764014 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`raw_marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:05.764477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:07.660313 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8b7c1038-5c8e-4bf7-b493-1cd7441408da&page=queryresults
[0m15:13:08.631128 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_author_insights_author_id ............................ [[32mPASS[0m in 2.88s]
[0m15:13:08.632854 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m15:13:08.633847 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m15:13:08.634761 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m15:13:08.635970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m15:13:08.636694 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m15:13:08.647528 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m15:13:08.649235 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m15:13:08.654183 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m15:13:08.655415 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`raw_marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:08.655996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:10.909352 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5df57a7e-8813-4e13-94e9-00e1794362fa&page=queryresults
[0m15:13:11.759365 [info ] [Thread-1  ]: 11 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 3.12s]
[0m15:13:11.761056 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m15:13:11.761870 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:13:11.762822 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m15:13:11.763837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m15:13:11.764537 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:13:11.772099 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m15:13:11.773503 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:13:11.777118 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m15:13:11.778175 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:11.778656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:14.333285 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:acff4a5d-3c40-4690-a0fa-c7358f481748&page=queryresults
[0m15:13:15.497462 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 3.73s]
[0m15:13:15.498295 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:13:15.499343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:15.501330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:15.501718 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_raw_marts' was properly closed.
[0m15:13:15.502045 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m15:13:15.502419 [info ] [MainThread]: 
[0m15:13:15.502788 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 51.89 seconds (51.89s).
[0m15:13:15.505312 [debug] [MainThread]: Command end result
[0m15:13:15.537556 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:13:15.540370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:13:15.550329 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m15:13:15.550791 [info ] [MainThread]: 
[0m15:13:15.551255 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:13:15.551645 [info ] [MainThread]: 
[0m15:13:15.552114 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m15:13:15.552568 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:13:15.552930 [info ] [MainThread]: 
[0m15:13:15.553345 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:13:15.553710 [info ] [MainThread]: 
[0m15:13:15.554141 [error] [MainThread]: [31mFailure in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)[0m
[0m15:13:15.554575 [error] [MainThread]:   Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m15:13:15.554944 [info ] [MainThread]: 
[0m15:13:15.555356 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m15:13:15.555722 [info ] [MainThread]: 
[0m15:13:15.556375 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m15:13:15.562656 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 55.697247, "process_in_blocks": "0", "process_kernel_time": 0.848664, "process_mem_max_rss": "352894976", "process_out_blocks": "0", "process_user_time": 5.376466}
[0m15:13:15.563270 [debug] [MainThread]: Command `dbt test` failed at 15:13:15.563169 after 55.70 seconds
[0m15:13:15.563734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106086220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431c6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431c6340>]}
[0m15:13:15.564193 [debug] [MainThread]: Flushing usage events
[0m15:13:17.217540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:15.658665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bafc40>]}


============================== 15:14:15.663614 | 34348f37-09ce-4ee3-b8bf-dc588c7502f8 ==============================
[0m15:14:15.663614 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:14:15.664263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_food_reviews', 'send_anonymous_usage_stats': 'True'}
[0m15:14:19.056430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ae4c10>]}
[0m15:14:19.126695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d6c40>]}
[0m15:14:19.127565 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m15:14:19.528419 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:14:19.776273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:14:19.777458 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/staging/schema.yml
[0m15:14:19.778213 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/sources.yml
[0m15:14:20.481089 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m15:14:20.495679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e82130>]}
[0m15:14:20.620264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:14:20.623366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:14:20.655490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1498cbca0>]}
[0m15:14:20.656152 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 494 macros
[0m15:14:20.656587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ec4610>]}
[0m15:14:20.658082 [info ] [MainThread]: 
[0m15:14:20.658526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:20.658890 [info ] [MainThread]: 
[0m15:14:20.659536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:20.665261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_raw_staging'
[0m15:14:20.665755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:21.661807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_staging, now list_dbtandbigquery-467100_raw_marts)
[0m15:14:21.663395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:23.332459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34348f37-09ce-4ee3-b8bf-dc588c7502f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1498ce190>]}
[0m15:14:23.333842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:23.342422 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:14:23.343091 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ....... [RUN]
[0m15:14:23.344056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_marts, now test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73)
[0m15:14:23.344515 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:14:23.355271 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m15:14:23.356170 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:14:23.575979 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m15:14:23.578066 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m15:14:23.578695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:24.898445 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:65c4a933-2478-47c7-a948-8c9ce97d1f7c&page=queryresults
[0m15:14:24.899081 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:65c4a933-2478-47c7-a948-8c9ce97d1f7c&page=queryresults
[0m15:14:24.950215 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:14:24.950944 [error] [Thread-1  ]: 1 of 4 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ............ [[31mERROR[0m in 1.61s]
[0m15:14:24.951568 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m15:14:24.951983 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:14:24.952511 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m15:14:24.952936 [info ] [Thread-1  ]: 2 of 4 START test not_null_stg_food_reviews_recipe_id .......................... [RUN]
[0m15:14:24.953539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m15:14:24.953936 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:14:24.962337 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m15:14:24.963442 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:14:24.967116 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m15:14:24.967987 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m15:14:24.968445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:26.937094 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4c187b39-3818-495d-967c-fe08a0c2527c&page=queryresults
[0m15:14:28.276262 [info ] [Thread-1  ]: 2 of 4 PASS not_null_stg_food_reviews_recipe_id ................................ [[32mPASS[0m in 3.32s]
[0m15:14:28.277791 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m15:14:28.278599 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:14:28.279310 [info ] [Thread-1  ]: 3 of 4 START test not_null_stg_food_reviews_review_id .......................... [RUN]
[0m15:14:28.280053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m15:14:28.280601 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:14:28.287957 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m15:14:28.289292 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:14:28.294230 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m15:14:28.295263 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m15:14:28.295767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:30.383444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a19c2ae5-a1a4-47b8-8717-8a3d9aac0e24&page=queryresults
[0m15:14:31.210771 [info ] [Thread-1  ]: 3 of 4 PASS not_null_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.93s]
[0m15:14:31.211739 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m15:14:31.212216 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:14:31.212650 [info ] [Thread-1  ]: 4 of 4 START test unique_stg_food_reviews_review_id ............................ [RUN]
[0m15:14:31.213128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m15:14:31.213508 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:14:31.221509 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m15:14:31.222686 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:14:31.226111 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m15:14:31.226997 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:14:31.227478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:34.379154 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9c830275-918a-464b-8014-3424621da86f&page=queryresults
[0m15:14:35.195522 [info ] [Thread-1  ]: 4 of 4 PASS unique_stg_food_reviews_review_id .................................. [[32mPASS[0m in 3.98s]
[0m15:14:35.197373 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m15:14:35.199052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:35.201212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:35.201615 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m15:14:35.202003 [info ] [MainThread]: 
[0m15:14:35.202380 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 14.54 seconds (14.54s).
[0m15:14:35.204061 [debug] [MainThread]: Command end result
[0m15:14:35.234597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m15:14:35.236789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m15:14:35.244492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m15:14:35.244860 [info ] [MainThread]: 
[0m15:14:35.245257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:14:35.245599 [info ] [MainThread]: 
[0m15:14:35.246010 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m15:14:35.246409 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:14:35.246729 [info ] [MainThread]: 
[0m15:14:35.247097 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m15:14:35.247414 [info ] [MainThread]: 
[0m15:14:35.247750 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m15:14:35.252519 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 19.67319, "process_in_blocks": "0", "process_kernel_time": 0.989704, "process_mem_max_rss": "363364352", "process_out_blocks": "0", "process_user_time": 5.721065}
[0m15:14:35.252989 [debug] [MainThread]: Command `dbt test` failed at 15:14:35.252907 after 19.67 seconds
[0m15:14:35.253385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5d040>]}
[0m15:14:35.253779 [debug] [MainThread]: Flushing usage events
[0m15:14:37.273674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:02.777283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ba190>]}


============================== 19:04:02.781617 | a0647691-8060-41cf-b904-f1c39f11deb9 ==============================
[0m19:04:02.781617 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:04:02.782187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:04:05.980517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438a8b0>]}
[0m19:04:06.039662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b8b940>]}
[0m19:04:06.040279 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:04:06.325367 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:04:06.521713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:06.522412 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/staging/stg_food_reviews.sql
[0m19:04:06.957844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m19:04:06.975536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13755d130>]}
[0m19:04:07.085223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:04:07.087505 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:04:07.108277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137186220>]}
[0m19:04:07.108811 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 494 macros
[0m19:04:07.109178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137508940>]}
[0m19:04:07.110640 [info ] [MainThread]: 
[0m19:04:07.111033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:07.111351 [info ] [MainThread]: 
[0m19:04:07.111818 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:07.116730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m19:04:07.117245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:08.226809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:09.985917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_raw_staging)
[0m19:04:09.988516 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "raw_staging"
"
[0m19:04:10.003618 [debug] [ThreadPool]: On create_dbtandbigquery-467100_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_raw_staging"} */
create schema if not exists `dbtandbigquery-467100`.`raw_staging`
  
[0m19:04:10.004260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:11.635320 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8a8d71ec-0360-4ece-8a34-82a80a30d807&page=queryresults
[0m19:04:13.817542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_raw_staging, now list_dbtandbigquery-467100_raw_marts)
[0m19:04:13.818169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:15.254592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_marts, now list_dbtandbigquery-467100_raw_staging)
[0m19:04:15.255815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:16.721351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c39c70>]}
[0m19:04:16.722376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:16.728860 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m19:04:16.729783 [info ] [Thread-1  ]: 1 of 3 START sql table model raw_staging.stg_food_reviews ...................... [RUN]
[0m19:04:16.730507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_raw_staging, now model.dbt_core.stg_food_reviews)
[0m19:04:16.731016 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m19:04:16.743076 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m19:04:16.744425 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m19:04:16.787897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m19:04:16.789212 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- 🥈 STAGING LAYER (Silver)
-- Responsável por: Limpeza, Padronização, Renomeação, Validação



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- IDs padronizados
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- Limpeza de strings
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Padronização de rating
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 é inválido
            ELSE NULL
        END AS rating,
        
        -- Padronização de datas
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Campos calculados
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Flags de qualidade
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filtrar apenas reviews válidos
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL
    );
  
[0m19:04:16.789790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:18.985011 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:59af455b-b3c6-435b-80e5-049d8b4688c8&page=queryresults
[0m19:04:32.695091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a9be0>]}
[0m19:04:32.696011 [info ] [Thread-1  ]: 1 of 3 OK created sql table model raw_staging.stg_food_reviews ................. [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 15.96s]
[0m19:04:32.696618 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m19:04:32.697319 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m19:04:32.697901 [info ] [Thread-1  ]: 2 of 3 START sql table model raw_marts.mart_author_insights .................... [RUN]
[0m19:04:32.698460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.stg_food_reviews, now model.dbt_core.mart_author_insights)
[0m19:04:32.698883 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m19:04:32.703141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m19:04:32.703963 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m19:04:32.707392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:33.800994 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m19:04:33.802489 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw_marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Insights de Autores - Comportamento e Padrões dos Reviewers



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Métricas de Atividade
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Métricas de Avaliação
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Padrões de Rating
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Categorização de Atividade
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Ativo'
            WHEN COUNT(*) >= 20 THEN 'Muito Ativo'
            WHEN COUNT(*) >= 10 THEN 'Ativo'
            WHEN COUNT(*) >= 5 THEN 'Moderado'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Categorização de Comportamento
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Otimista'
            WHEN AVG(rating) <= 2.5 THEN 'Crítico'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistente'
            ELSE 'Variado'
        END AS rating_behavior,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Apenas autores com pelo menos 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m19:04:34.358517 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7500db93-3075-41a1-afd2-7128c633a23e&page=queryresults
[0m19:05:01.035490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375d9c10>]}
[0m19:05:01.038272 [info ] [Thread-1  ]: 2 of 3 OK created sql table model raw_marts.mart_author_insights ............... [[32mCREATE TABLE (42.2k rows, 70.3 MiB processed)[0m in 28.34s]
[0m19:05:01.039351 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m19:05:01.039855 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m19:05:01.040499 [info ] [Thread-1  ]: 3 of 3 START sql table model raw_marts.mart_review_metrics ..................... [RUN]
[0m19:05:01.041125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m19:05:01.041546 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m19:05:01.046819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m19:05:01.047944 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m19:05:01.051653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:02.818234 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m19:05:02.821075 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`raw_marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Métricas de Avaliações por Receita - Pronto para BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Métricas de Volume
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Métricas de Rating
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Distribuição de Ratings
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Categorização de Popularidade
        CASE 
            WHEN COUNT(*) >= 100 THEN 'Alta'
            WHEN COUNT(*) >= 50 THEN 'Média'
            WHEN COUNT(*) >= 10 THEN 'Baixa'
            ELSE 'Muito Baixa'
        END AS popularity_category,
        
        -- Categorização de Qualidade
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excelente'
            WHEN AVG(rating) >= 4.0 THEN 'Muito Boa'
            WHEN AVG(rating) >= 3.5 THEN 'Boa'
            WHEN AVG(rating) >= 3.0 THEN 'Regular'
            ELSE 'Ruim'
        END AS quality_category,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`raw_staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m19:05:04.655841 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b0994aef-3bb4-44bb-8383-3b2c18f1b95c&page=queryresults
[0m19:05:22.612614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0647691-8060-41cf-b904-f1c39f11deb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13729b160>]}
[0m19:05:22.615557 [info ] [Thread-1  ]: 3 of 3 OK created sql table model raw_marts.mart_review_metrics ................ [[32mCREATE TABLE (265.8k rows, 54.2 MiB processed)[0m in 21.57s]
[0m19:05:22.616409 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m19:05:22.618980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:22.622221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:22.622593 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m19:05:22.623631 [info ] [MainThread]: 
[0m19:05:22.624227 [info ] [MainThread]: Finished running 3 table models in 0 hours 1 minutes and 15.51 seconds (75.51s).
[0m19:05:22.625475 [debug] [MainThread]: Command end result
[0m19:05:22.663146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:05:22.667288 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:05:22.675278 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:05:22.675743 [info ] [MainThread]: 
[0m19:05:22.676178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:22.676538 [info ] [MainThread]: 
[0m19:05:22.677073 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:05:22.683450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 79.97869, "process_in_blocks": "0", "process_kernel_time": 0.941248, "process_mem_max_rss": "358498304", "process_out_blocks": "0", "process_user_time": 5.167582}
[0m19:05:22.684035 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:22.683935 after 79.98 seconds
[0m19:05:22.684505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107188a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1371b8430>]}
[0m19:05:22.684917 [debug] [MainThread]: Flushing usage events
[0m19:05:24.023694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:32.129576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338160>]}


============================== 19:10:32.134218 | ce96cce6-4972-493b-a773-a8cdbcaa58d5 ==============================
[0m19:10:32.134218 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:10:32.134784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:32.150156 [info ] [MainThread]: dbt version: 1.10.5
[0m19:10:32.150620 [info ] [MainThread]: python version: 3.9.6
[0m19:10:32.150955 [info ] [MainThread]: python path: /Users/bi006217/Documents/study/dbt_bigquery/.venv/bin/python
[0m19:10:32.151270 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m19:10:35.311179 [info ] [MainThread]: Using profiles dir at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core
[0m19:10:35.311716 [info ] [MainThread]: Using profiles.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/profiles.yml
[0m19:10:35.312056 [info ] [MainThread]: Using dbt_project.yml file at /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/dbt_project.yml
[0m19:10:35.312390 [info ] [MainThread]: adapter type: bigquery
[0m19:10:35.312697 [info ] [MainThread]: adapter version: 1.10.0
[0m19:10:35.418338 [info ] [MainThread]: Configuration:
[0m19:10:35.418930 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:10:35.419342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:10:35.419676 [info ] [MainThread]: Required dependencies:
[0m19:10:35.420225 [debug] [MainThread]: Executing "git --help"
[0m19:10:35.520031 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:10:35.521090 [debug] [MainThread]: STDERR: "b''"
[0m19:10:35.521569 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:10:35.522306 [info ] [MainThread]: Connection:
[0m19:10:35.522974 [info ] [MainThread]:   method: service-account
[0m19:10:35.523355 [info ] [MainThread]:   database: dbtandbigquery-467100
[0m19:10:35.523697 [info ] [MainThread]:   execution_project: dbtandbigquery-467100
[0m19:10:35.524005 [info ] [MainThread]:   schema: dbt_core
[0m19:10:35.524304 [info ] [MainThread]:   location: us-central1
[0m19:10:35.524602 [info ] [MainThread]:   priority: interactive
[0m19:10:35.524893 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:10:35.525184 [info ] [MainThread]:   impersonate_service_account: None
[0m19:10:35.525473 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:10:35.525764 [info ] [MainThread]:   job_retries: 1
[0m19:10:35.526054 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:10:35.526343 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:10:35.527093 [info ] [MainThread]:   timeout_seconds: 300
[0m19:10:35.527548 [info ] [MainThread]:   client_id: None
[0m19:10:35.527881 [info ] [MainThread]:   token_uri: None
[0m19:10:35.528192 [info ] [MainThread]:   compute_region: None
[0m19:10:35.528493 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:10:35.528793 [info ] [MainThread]:   gcs_bucket: None
[0m19:10:35.529086 [info ] [MainThread]:   dataproc_batch: None
[0m19:10:35.530407 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:10:35.814812 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:10:35.815526 [debug] [MainThread]: On debug: select 1 as id
[0m19:10:35.815989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:38.415356 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:22cc39a6-fd47-4c1d-9cf3-0cac37446822&page=queryresults
[0m19:10:39.148284 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:10:39.148975 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:10:39.154730 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 7.105296, "process_in_blocks": "0", "process_kernel_time": 0.812133, "process_mem_max_rss": "332021760", "process_out_blocks": "0", "process_user_time": 3.495459}
[0m19:10:39.155336 [debug] [MainThread]: Command `dbt debug` succeeded at 19:10:39.155209 after 7.11 seconds
[0m19:10:39.155738 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:10:39.156699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b1fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b1fc40>]}
[0m19:10:39.157402 [debug] [MainThread]: Flushing usage events
[0m19:10:40.386108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:21.259188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105152190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6220>]}


============================== 19:11:21.263533 | 17bcec60-c177-490b-a03d-bdf99841e38d ==============================
[0m19:11:21.263533 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:11:21.264110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:24.085656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ce220>]}
[0m19:11:24.144230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae17c0>]}
[0m19:11:24.144806 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:11:24.424441 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:11:24.554409 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:11:24.554919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105482a30>]}
[0m19:11:25.957688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m19:11:25.969819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119789130>]}
[0m19:11:26.074116 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:11:26.078149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:11:26.214966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119755160>]}
[0m19:11:26.215564 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:11:26.218406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119755e20>]}
[0m19:11:26.224066 [info ] [MainThread]: 
[0m19:11:26.224543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:26.224890 [info ] [MainThread]: 
[0m19:11:26.225390 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:26.230206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m19:11:26.230828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:32.117530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:33.632548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_marts)
[0m19:11:33.634655 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "marts"
"
[0m19:11:33.648982 [debug] [ThreadPool]: On create_dbtandbigquery-467100_marts: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_marts"} */
create schema if not exists `dbtandbigquery-467100`.`marts`
  
[0m19:11:33.649518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:34.916943 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:56b5fdca-12ba-422c-89ee-38a32c2f9acf&page=queryresults
[0m19:11:36.244298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_marts, now create_dbtandbigquery-467100_staging)
[0m19:11:36.244921 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "staging"
"
[0m19:11:36.247598 [debug] [ThreadPool]: On create_dbtandbigquery-467100_staging: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_staging"} */
create schema if not exists `dbtandbigquery-467100`.`staging`
  
[0m19:11:36.247984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:37.313750 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5e2949fc-0cc6-430a-b1f6-6d112b86495b&page=queryresults
[0m19:11:38.686828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:11:38.688546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:47.771438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now list_dbtandbigquery-467100_staging)
[0m19:11:47.772904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:48.989340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119670eb0>]}
[0m19:11:48.990580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:48.999581 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m19:11:49.001188 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.stg_food_reviews .......................... [RUN]
[0m19:11:49.003297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now model.dbt_core.stg_food_reviews)
[0m19:11:49.003966 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m19:11:49.018800 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m19:11:49.020245 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m19:11:49.063845 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m19:11:49.065424 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- 🥈 STAGING LAYER (Silver)
-- Responsável por: Limpeza, Padronização, Renomeação, Validação



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- IDs padronizados
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- Limpeza de strings
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Padronização de rating
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 é inválido
            ELSE NULL
        END AS rating,
        
        -- Padronização de datas
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Campos calculados
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Flags de qualidade
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filtrar apenas reviews válidos
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL
    );
  
[0m19:11:49.066036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:11:51.163816 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:ff5765af-ac15-47ba-b7cf-2246dd71122e&page=queryresults
[0m19:12:01.872530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190612b0>]}
[0m19:12:01.873762 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.stg_food_reviews ..................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 12.87s]
[0m19:12:01.874572 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m19:12:01.875847 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m19:12:01.876362 [info ] [Thread-1  ]: 2 of 3 START sql table model marts.mart_author_insights ........................ [RUN]
[0m19:12:01.876842 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.stg_food_reviews, now model.dbt_core.mart_author_insights)
[0m19:12:01.877223 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m19:12:01.884482 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m19:12:01.885809 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m19:12:01.889156 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m19:12:01.889983 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Insights de Autores - Comportamento e Padrões dos Reviewers



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Métricas de Atividade
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Métricas de Avaliação
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Padrões de Rating
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Categorização de Atividade
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Ativo'
            WHEN COUNT(*) >= 20 THEN 'Muito Ativo'
            WHEN COUNT(*) >= 10 THEN 'Ativo'
            WHEN COUNT(*) >= 5 THEN 'Moderado'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Categorização de Comportamento
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Otimista'
            WHEN AVG(rating) <= 2.5 THEN 'Crítico'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistente'
            ELSE 'Variado'
        END AS rating_behavior,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Apenas autores com pelo menos 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m19:12:01.890511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:12:03.616637 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:58d1c9c8-2190-4676-84c4-1a0c7833ab14&page=queryresults
[0m19:12:12.233208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c69400>]}
[0m19:12:12.235616 [info ] [Thread-1  ]: 2 of 3 OK created sql table model marts.mart_author_insights ................... [[32mCREATE TABLE (42.2k rows, 70.3 MiB processed)[0m in 10.36s]
[0m19:12:12.237005 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m19:12:12.237872 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m19:12:12.238935 [info ] [Thread-1  ]: 3 of 3 START sql table model marts.mart_review_metrics ......................... [RUN]
[0m19:12:12.239921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m19:12:12.240638 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m19:12:12.253224 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m19:12:12.254736 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m19:12:12.259760 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m19:12:12.261580 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Métricas de Avaliações por Receita - Pronto para BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Métricas de Volume
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Métricas de Rating
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Distribuição de Ratings
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Métricas de Texto
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Métricas Temporais
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Categorização de Popularidade
        CASE 
            WHEN COUNT(*) >= 100 THEN 'Alta'
            WHEN COUNT(*) >= 50 THEN 'Média'
            WHEN COUNT(*) >= 10 THEN 'Baixa'
            ELSE 'Muito Baixa'
        END AS popularity_category,
        
        -- Categorização de Qualidade
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excelente'
            WHEN AVG(rating) >= 4.0 THEN 'Muito Boa'
            WHEN AVG(rating) >= 3.5 THEN 'Boa'
            WHEN AVG(rating) >= 3.0 THEN 'Regular'
            ELSE 'Ruim'
        END AS quality_category,
        
        -- Metadados
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m19:12:12.262279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:12:14.525286 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:cde828ff-3971-45d5-85c1-a5e548bb977d&page=queryresults
[0m19:12:22.814850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17bcec60-c177-490b-a03d-bdf99841e38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c69400>]}
[0m19:12:22.817122 [info ] [Thread-1  ]: 3 of 3 OK created sql table model marts.mart_review_metrics .................... [[32mCREATE TABLE (265.8k rows, 54.2 MiB processed)[0m in 10.57s]
[0m19:12:22.818206 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m19:12:22.819650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:22.822526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:22.822992 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m19:12:22.823593 [info ] [MainThread]: 
[0m19:12:22.824122 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 56.60 seconds (56.60s).
[0m19:12:22.826047 [debug] [MainThread]: Command end result
[0m19:12:22.861001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:12:22.864631 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:12:22.871676 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:12:22.872014 [info ] [MainThread]: 
[0m19:12:22.872436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:22.872763 [info ] [MainThread]: 
[0m19:12:22.873146 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:12:22.878406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 61.69741, "process_in_blocks": "0", "process_kernel_time": 0.871626, "process_mem_max_rss": "357974016", "process_out_blocks": "0", "process_user_time": 6.068719}
[0m19:12:22.879296 [debug] [MainThread]: Command `dbt run` succeeded at 19:12:22.879194 after 61.70 seconds
[0m19:12:22.879735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105152190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196e02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11965e3a0>]}
[0m19:12:22.880126 [debug] [MainThread]: Flushing usage events
[0m19:12:24.323380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:56.762896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107077580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fec430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fec640>]}


============================== 19:26:56.795938 | 3c5cf357-422f-4150-9115-3b3c0fadfcf9 ==============================
[0m19:26:56.795938 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:26:56.796518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:06.945206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050caac0>]}
[0m19:27:07.004111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203f6a00>]}
[0m19:27:07.004718 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:27:07.291526 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:27:07.424179 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:27:07.424701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120301f10>]}
[0m19:27:08.958671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m19:27:08.971481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1646bd130>]}
[0m19:27:09.076932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:27:09.079966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:27:09.249990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1646de9d0>]}
[0m19:27:09.250569 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:27:09.250938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1646defa0>]}
[0m19:27:09.252725 [info ] [MainThread]: 
[0m19:27:09.253096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:09.253415 [info ] [MainThread]: 
[0m19:27:09.253889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:27:09.258937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:27:09.259394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:14.286316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:27:14.287756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:19.060514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c5cf357-422f-4150-9115-3b3c0fadfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1647fd2e0>]}
[0m19:27:19.063261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:19.074844 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:27:19.075612 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ...... [RUN]
[0m19:27:19.076529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73)
[0m19:27:19.077052 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:27:19.090613 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:27:19.091759 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:27:19.118067 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:27:19.119012 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:27:19.119473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:21.675381 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d08e7486-98d0-45f2-918a-b52f6e7f4100&page=queryresults
[0m19:27:21.677209 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d08e7486-98d0-45f2-918a-b52f6e7f4100&page=queryresults
[0m19:27:21.725140 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:27:21.725814 [error] [Thread-1  ]: 1 of 12 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ........... [[31mERROR[0m in 2.65s]
[0m19:27:21.726401 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:27:21.726799 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:27:21.727304 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m19:27:21.727729 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:27:21.728316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:27:21.728702 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:27:21.736403 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:27:21.737420 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:27:21.740341 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:27:21.741208 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:21.741623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:24.999605 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e896b3f2-928f-4af6-8e61-8cab7cfd9a27&page=queryresults
[0m19:27:25.001104 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e896b3f2-928f-4af6-8e61-8cab7cfd9a27&page=queryresults
[0m19:27:25.019273 [debug] [Thread-1  ]: Database Error in test not_null_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_author_insights_author_id.sql
[0m19:27:25.019954 [error] [Thread-1  ]: 2 of 12 ERROR not_null_mart_author_insights_author_id .......................... [[31mERROR[0m in 3.29s]
[0m19:27:25.020552 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:27:25.020946 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:27:25.021445 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.not_null_mart_author_insights_author_id.9029733503' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_author_insights_author_id.sql.
[0m19:27:25.021852 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:27:25.022418 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:27:25.022801 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:27:25.027751 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:27:25.028622 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:27:25.031508 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:27:25.032316 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:25.033027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:27.645162 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a1d77e5b-bef1-4506-a177-857122a6157e&page=queryresults
[0m19:27:27.648588 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a1d77e5b-bef1-4506-a177-857122a6157e&page=queryresults
[0m19:27:27.675077 [debug] [Thread-1  ]: Database Error in test not_null_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_review_metrics_recipe_id.sql
[0m19:27:27.675894 [error] [Thread-1  ]: 3 of 12 ERROR not_null_mart_review_metrics_recipe_id ........................... [[31mERROR[0m in 2.65s]
[0m19:27:27.676585 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:27:27.677048 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:27:27.677610 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_review_metrics_recipe_id.sql.
[0m19:27:27.678075 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:27:27.678746 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:27:27.679166 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:27:27.684370 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:27:27.685651 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:27:27.689796 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:27:27.690622 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:27.691037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:29.132894 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:12f99827-7dec-4b1e-a6e6-fca16c23b4c3&page=queryresults
[0m19:27:29.135428 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:12f99827-7dec-4b1e-a6e6-fca16c23b4c3&page=queryresults
[0m19:27:29.155992 [debug] [Thread-1  ]: Database Error in test not_null_stg_food_reviews_recipe_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_recipe_id.sql
[0m19:27:29.156718 [error] [Thread-1  ]: 4 of 12 ERROR not_null_stg_food_reviews_recipe_id .............................. [[31mERROR[0m in 1.48s]
[0m19:27:29.157389 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:27:29.157834 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:27:29.158335 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_food_reviews_recipe_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_recipe_id.sql.
[0m19:27:29.158732 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:27:29.159363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:27:29.159768 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:27:29.164675 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:27:29.165635 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:27:29.168845 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:27:29.169679 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:27:29.170104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:30.357929 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2d1f5051-a540-4a84-aca9-db8afe6b0182&page=queryresults
[0m19:27:30.360494 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2d1f5051-a540-4a84-aca9-db8afe6b0182&page=queryresults
[0m19:27:30.380215 [debug] [Thread-1  ]: Database Error in test not_null_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_review_id.sql
[0m19:27:30.380967 [error] [Thread-1  ]: 5 of 12 ERROR not_null_stg_food_reviews_review_id .............................. [[31mERROR[0m in 1.22s]
[0m19:27:30.381585 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:27:30.382009 [debug] [Thread-1  ]: Began running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:27:30.382500 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_review_id.sql.
[0m19:27:30.382904 [info ] [Thread-1  ]: 6 of 12 START test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [RUN]
[0m19:27:30.383518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56)
[0m19:27:30.383932 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:27:30.389109 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:27:30.390688 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:27:30.393612 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:27:30.394436 [debug] [Thread-1  ]: On test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    group by Rating

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:27:30.394866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:31.837041 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9cca1edd-b792-4162-a5c4-9467a49f57f2&page=queryresults
[0m19:27:31.837812 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9cca1edd-b792-4162-a5c4-9467a49f57f2&page=queryresults
[0m19:27:31.852799 [debug] [Thread-1  ]: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:27:31.853454 [error] [Thread-1  ]: 6 of 12 ERROR source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [[31mERROR[0m in 1.47s]
[0m19:27:31.854036 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:27:31.854430 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:27:31.854908 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql.
[0m19:27:31.855308 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:27:31.855944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:27:31.856354 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:27:31.861285 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:27:31.862208 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:27:31.866493 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:27:31.867282 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:27:31.867720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:33.289220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:231ac1b8-328d-4e13-8b47-8f64327439e9&page=queryresults
[0m19:27:34.290175 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.43s]
[0m19:27:34.291944 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:27:34.292757 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:27:34.293573 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:27:34.294533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:27:34.295227 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:27:34.303454 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:27:34.304807 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:27:34.308299 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:27:34.309206 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:27:34.309690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:35.655235 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8e369634-e4d2-4183-a9b6-422327a3545f&page=queryresults
[0m19:27:36.493210 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.20s]
[0m19:27:36.494958 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:27:36.495874 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:27:36.496914 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:27:36.497928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:27:36.498809 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:27:36.510802 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:27:36.512317 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:27:36.516016 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:27:36.517095 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:36.517580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:37.826951 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e65759d9-fd4e-4a26-9581-1969ad3891eb&page=queryresults
[0m19:27:38.701191 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.20s]
[0m19:27:38.702149 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:27:38.702695 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:27:38.703138 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m19:27:38.703601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:27:38.703966 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:27:38.712260 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:27:38.713573 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:27:38.717552 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:27:38.718708 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:38.719275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:39.952357 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:38983cfa-2190-4eea-941b-2356b8d39a80&page=queryresults
[0m19:27:39.954979 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:38983cfa-2190-4eea-941b-2356b8d39a80&page=queryresults
[0m19:27:39.977727 [debug] [Thread-1  ]: Database Error in test unique_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_author_insights_author_id.sql
[0m19:27:39.978527 [error] [Thread-1  ]: 10 of 12 ERROR unique_mart_author_insights_author_id ........................... [[31mERROR[0m in 1.27s]
[0m19:27:39.979199 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:27:39.979609 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:27:39.980122 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d' to be skipped because of status 'error'.  Reason: Database Error in test unique_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_author_insights_author_id.sql.
[0m19:27:39.980542 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:27:39.981288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:27:39.981763 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:27:39.986779 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:27:39.987749 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:27:39.990741 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:27:39.991560 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:39.991981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:41.473150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5b2713e3-ebb3-4db9-8c4f-300cb6bea11b&page=queryresults
[0m19:27:41.475181 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5b2713e3-ebb3-4db9-8c4f-300cb6bea11b&page=queryresults
[0m19:27:41.493895 [debug] [Thread-1  ]: Database Error in test unique_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_review_metrics_recipe_id.sql
[0m19:27:41.494621 [error] [Thread-1  ]: 11 of 12 ERROR unique_mart_review_metrics_recipe_id ............................ [[31mERROR[0m in 1.51s]
[0m19:27:41.495256 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:27:41.495654 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:27:41.496140 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53' to be skipped because of status 'error'.  Reason: Database Error in test unique_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_review_metrics_recipe_id.sql.
[0m19:27:41.496534 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:27:41.497100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:27:41.497481 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:27:41.502529 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:27:41.503475 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:27:41.506476 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:27:41.507245 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:27:41.507663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:45.535578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4d99ae6e-9fc5-4641-869e-11637295ab31&page=queryresults
[0m19:27:45.537825 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4d99ae6e-9fc5-4641-869e-11637295ab31&page=queryresults
[0m19:27:45.560570 [debug] [Thread-1  ]: Database Error in test unique_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/unique_stg_food_reviews_review_id.sql
[0m19:27:45.561576 [error] [Thread-1  ]: 12 of 12 ERROR unique_stg_food_reviews_review_id ............................... [[31mERROR[0m in 4.06s]
[0m19:27:45.562301 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:27:45.562843 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/unique_stg_food_reviews_review_id.sql.
[0m19:27:45.564109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:45.566288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:45.566662 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:27:45.567032 [info ] [MainThread]: 
[0m19:27:45.567557 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 36.31 seconds (36.31s).
[0m19:27:45.569823 [debug] [MainThread]: Command end result
[0m19:27:45.600561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:27:45.603345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:27:45.611324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:27:45.611675 [info ] [MainThread]: 
[0m19:27:45.612081 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m19:27:45.612415 [info ] [MainThread]: 
[0m19:27:45.612810 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m19:27:45.613197 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:27:45.613513 [info ] [MainThread]: 
[0m19:27:45.613864 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:27:45.614280 [info ] [MainThread]: 
[0m19:27:45.614700 [error] [MainThread]: [31mFailure in test not_null_mart_author_insights_author_id (models/marts/schema.yml)[0m
[0m19:27:45.615096 [error] [MainThread]:   Database Error in test not_null_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_author_insights_author_id.sql
[0m19:27:45.615417 [info ] [MainThread]: 
[0m19:27:45.615773 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/marts/schema.yml/not_null_mart_author_insights_author_id.sql
[0m19:27:45.616088 [info ] [MainThread]: 
[0m19:27:45.616450 [error] [MainThread]: [31mFailure in test not_null_mart_review_metrics_recipe_id (models/marts/schema.yml)[0m
[0m19:27:45.617067 [error] [MainThread]:   Database Error in test not_null_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/not_null_mart_review_metrics_recipe_id.sql
[0m19:27:45.617432 [info ] [MainThread]: 
[0m19:27:45.617809 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/marts/schema.yml/not_null_mart_review_metrics_recipe_id.sql
[0m19:27:45.618128 [info ] [MainThread]: 
[0m19:27:45.618500 [error] [MainThread]: [31mFailure in test not_null_stg_food_reviews_recipe_id (models/staging/schema.yml)[0m
[0m19:27:45.618866 [error] [MainThread]:   Database Error in test not_null_stg_food_reviews_recipe_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_recipe_id.sql
[0m19:27:45.619167 [info ] [MainThread]: 
[0m19:27:45.619519 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_recipe_id.sql
[0m19:27:45.619821 [info ] [MainThread]: 
[0m19:27:45.620174 [error] [MainThread]: [31mFailure in test not_null_stg_food_reviews_review_id (models/staging/schema.yml)[0m
[0m19:27:45.620540 [error] [MainThread]:   Database Error in test not_null_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_review_id.sql
[0m19:27:45.621126 [info ] [MainThread]: 
[0m19:27:45.621539 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/not_null_stg_food_reviews_review_id.sql
[0m19:27:45.622052 [info ] [MainThread]: 
[0m19:27:45.622549 [error] [MainThread]: [31mFailure in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)[0m
[0m19:27:45.622952 [error] [MainThread]:   Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:27:45.623264 [info ] [MainThread]: 
[0m19:27:45.623615 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:27:45.623921 [info ] [MainThread]: 
[0m19:27:45.624270 [error] [MainThread]: [31mFailure in test unique_mart_author_insights_author_id (models/marts/schema.yml)[0m
[0m19:27:45.624631 [error] [MainThread]:   Database Error in test unique_mart_author_insights_author_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_author_insights_author_id.sql
[0m19:27:45.624929 [info ] [MainThread]: 
[0m19:27:45.625267 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/marts/schema.yml/unique_mart_author_insights_author_id.sql
[0m19:27:45.625572 [info ] [MainThread]: 
[0m19:27:45.625923 [error] [MainThread]: [31mFailure in test unique_mart_review_metrics_recipe_id (models/marts/schema.yml)[0m
[0m19:27:45.626277 [error] [MainThread]:   Database Error in test unique_mart_review_metrics_recipe_id (models/marts/schema.yml)
  Not found: Dataset dbtandbigquery-467100:marts was not found in location us-central1
  compiled code at target/run/dbt_core/models/marts/schema.yml/unique_mart_review_metrics_recipe_id.sql
[0m19:27:45.626577 [info ] [MainThread]: 
[0m19:27:45.627110 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/marts/schema.yml/unique_mart_review_metrics_recipe_id.sql
[0m19:27:45.627423 [info ] [MainThread]: 
[0m19:27:45.627784 [error] [MainThread]: [31mFailure in test unique_stg_food_reviews_review_id (models/staging/schema.yml)[0m
[0m19:27:45.628142 [error] [MainThread]:   Database Error in test unique_stg_food_reviews_review_id (models/staging/schema.yml)
  Not found: Dataset dbtandbigquery-467100:staging was not found in location us-central1
  compiled code at target/run/dbt_core/models/staging/schema.yml/unique_stg_food_reviews_review_id.sql
[0m19:27:45.628442 [info ] [MainThread]: 
[0m19:27:45.628783 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/unique_stg_food_reviews_review_id.sql
[0m19:27:45.629094 [info ] [MainThread]: 
[0m19:27:45.629436 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=12
[0m19:27:45.635330 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 48.961803, "process_in_blocks": "0", "process_kernel_time": 2.236029, "process_mem_max_rss": "403161088", "process_out_blocks": "0", "process_user_time": 14.103589}
[0m19:27:45.635869 [debug] [MainThread]: Command `dbt test` failed at 19:27:45.635781 after 48.96 seconds
[0m19:27:45.636291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107077580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1648c1af0>]}
[0m19:27:45.636712 [debug] [MainThread]: Flushing usage events
[0m19:27:47.271838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:59.377662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105852220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c6250>]}


============================== 19:27:59.381835 | 1b72f645-bf96-4461-a312-73d511109e10 ==============================
[0m19:27:59.381835 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:27:59.382380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:02.213007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191f0c40>]}
[0m19:28:02.271967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106853d00>]}
[0m19:28:02.272553 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:28:02.557364 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:28:02.748176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:02.748602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:02.755777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m19:28:02.808905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119801130>]}
[0m19:28:02.920436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:28:02.922774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:28:02.943888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c64f0>]}
[0m19:28:02.944396 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:28:02.944766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119841d90>]}
[0m19:28:02.946173 [info ] [MainThread]: 
[0m19:28:02.946555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:02.946871 [info ] [MainThread]: 
[0m19:28:02.947383 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:28:02.952220 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m19:28:02.952813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:04.477362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:05.818996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_staging)
[0m19:28:05.825521 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "staging"
"
[0m19:28:05.836996 [debug] [ThreadPool]: On create_dbtandbigquery-467100_staging: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_staging"} */
create schema if not exists `dbtandbigquery-467100`.`staging`
  
[0m19:28:05.837409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:07.157897 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a72fe761-2108-46d0-a802-587e9ab5a70d&page=queryresults
[0m19:28:08.015270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_staging, now create_dbtandbigquery-467100_marts)
[0m19:28:08.015855 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "marts"
"
[0m19:28:08.018429 [debug] [ThreadPool]: On create_dbtandbigquery-467100_marts: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_marts"} */
create schema if not exists `dbtandbigquery-467100`.`marts`
  
[0m19:28:08.018812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:10.707362 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:42519726-9722-4091-ba51-2e9156f9f0cc&page=queryresults
[0m19:28:11.677616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:28:11.678409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:12.789908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:28:12.791161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:14.446433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119917280>]}
[0m19:28:14.448231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:14.457930 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m19:28:14.459151 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.stg_food_reviews .......................... [RUN]
[0m19:28:14.460265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now model.dbt_core.stg_food_reviews)
[0m19:28:14.460971 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m19:28:14.475694 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m19:28:14.477148 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m19:28:14.518197 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m19:28:14.519209 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- 🥈 STAGING LAYER (Silver)
-- Responsible for: Cleaning, Standardization, Renaming, Validation



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- Standardized IDs
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- String cleaning
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Rating standardization
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 is invalid
            ELSE NULL
        END AS rating,
        
        -- Date standardization
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Calculated fields
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Quality flags
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filter only valid reviews
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL
    );
  
[0m19:28:14.519729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:28:16.528114 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4b33b22c-962e-4823-995c-dc52f24af604&page=queryresults
[0m19:28:28.520493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119829460>]}
[0m19:28:28.521424 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.stg_food_reviews ..................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 14.06s]
[0m19:28:28.522036 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m19:28:28.522717 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m19:28:28.523237 [info ] [Thread-1  ]: 2 of 3 START sql table model marts.mart_author_insights ........................ [RUN]
[0m19:28:28.523774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.stg_food_reviews, now model.dbt_core.mart_author_insights)
[0m19:28:28.524178 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m19:28:28.528527 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m19:28:28.529623 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m19:28:28.533138 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m19:28:28.534294 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Author Insights - Reviewer Behavior and Patterns



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Activity Metrics
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Rating Patterns
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Activity Categorization
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Active'
            WHEN COUNT(*) >= 20 THEN 'Very Active'
            WHEN COUNT(*) >= 10 THEN 'Active'
            WHEN COUNT(*) >= 5 THEN 'Moderate'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Behavior Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Optimistic'
            WHEN AVG(rating) <= 2.5 THEN 'Critical'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistent'
            ELSE 'Varied'
        END AS rating_behavior,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Only authors with at least 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m19:28:28.534812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:28:32.730725 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:34d3d1ee-09e1-4fb4-9943-7fdfb259322b&page=queryresults
[0m19:28:48.234537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dd7ee0>]}
[0m19:28:48.236594 [info ] [Thread-1  ]: 2 of 3 OK created sql table model marts.mart_author_insights ................... [[32mCREATE TABLE (42.2k rows, 70.3 MiB processed)[0m in 19.71s]
[0m19:28:48.237473 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m19:28:48.238066 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m19:28:48.238852 [info ] [Thread-1  ]: 3 of 3 START sql table model marts.mart_review_metrics ......................... [RUN]
[0m19:28:48.239600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m19:28:48.240075 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m19:28:48.245634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m19:28:48.246893 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m19:28:48.250358 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m19:28:48.251758 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Review Metrics by Recipe - Ready for BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Volume Metrics
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Rating Distribution
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Popularity Categorization
        CASE 
            WHEN COUNT(*) >= 100 THEN 'High'
            WHEN COUNT(*) >= 50 THEN 'Medium'
            WHEN COUNT(*) >= 10 THEN 'Low'
            ELSE 'Very Low'
        END AS popularity_category,
        
        -- Quality Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excellent'
            WHEN AVG(rating) >= 4.0 THEN 'Very Good'
            WHEN AVG(rating) >= 3.5 THEN 'Good'
            WHEN AVG(rating) >= 3.0 THEN 'Fair'
            ELSE 'Poor'
        END AS quality_category,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m19:28:48.252305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:28:49.636310 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e34ada33-953f-44a5-8ae0-99ae03511371&page=queryresults
[0m19:28:57.089542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b72f645-bf96-4461-a312-73d511109e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e29fd0>]}
[0m19:28:57.090807 [info ] [Thread-1  ]: 3 of 3 OK created sql table model marts.mart_review_metrics .................... [[32mCREATE TABLE (265.8k rows, 54.2 MiB processed)[0m in 8.85s]
[0m19:28:57.091692 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m19:28:57.093013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:57.095592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:57.096040 [debug] [MainThread]: Connection 'create_dbtandbigquery-467100_marts' was properly closed.
[0m19:28:57.096447 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m19:28:57.096953 [info ] [MainThread]: 
[0m19:28:57.097433 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 54.15 seconds (54.15s).
[0m19:28:57.099113 [debug] [MainThread]: Command end result
[0m19:28:57.130248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:28:57.132762 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:28:57.139700 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:28:57.140069 [info ] [MainThread]: 
[0m19:28:57.140478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:57.140805 [info ] [MainThread]: 
[0m19:28:57.141150 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:28:57.145899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 57.844875, "process_in_blocks": "0", "process_kernel_time": 0.795727, "process_mem_max_rss": "350699520", "process_out_blocks": "0", "process_user_time": 4.729193}
[0m19:28:57.146591 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:57.146500 after 57.85 seconds
[0m19:28:57.146994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105852220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160d4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c6130>]}
[0m19:28:57.147386 [debug] [MainThread]: Flushing usage events
[0m19:28:58.776067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:10.608801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a13a0>]}


============================== 19:29:10.613115 | 215b8f9d-be7d-4a9b-9330-0067dc0e4aba ==============================
[0m19:29:10.613115 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:29:10.613757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:29:13.455083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b891c0>]}
[0m19:29:13.514006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a99160>]}
[0m19:29:13.514603 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:29:13.805426 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:29:13.999978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:14.000402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:14.007561 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_core.raw
[0m19:29:14.060796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132dc1130>]}
[0m19:29:14.172047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:29:14.174350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:29:14.204251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132efc8b0>]}
[0m19:29:14.204774 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:29:14.205136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132dd09a0>]}
[0m19:29:14.206945 [info ] [MainThread]: 
[0m19:29:14.207320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:14.207627 [info ] [MainThread]: 
[0m19:29:14.208098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:29:14.213153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:29:14.213558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:15.969423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:29:15.971128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:19.774040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215b8f9d-be7d-4a9b-9330-0067dc0e4aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133049fd0>]}
[0m19:29:19.776676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:19.784421 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:29:19.785321 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ...... [RUN]
[0m19:29:19.786289 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73'
[0m19:29:19.786941 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:29:19.812554 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:29:19.813934 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:29:19.839981 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:29:19.840892 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:29:19.841366 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:20.995074 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6bef9d73-41f1-45c4-9f71-de0ce3c54b02&page=queryresults
[0m19:29:20.996819 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6bef9d73-41f1-45c4-9f71-de0ce3c54b02&page=queryresults
[0m19:29:21.045906 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:29:21.046541 [error] [Thread-1  ]: 1 of 12 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ........... [[31mERROR[0m in 1.26s]
[0m19:29:21.047117 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:29:21.047512 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:29:21.048030 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m19:29:21.048440 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:29:21.049030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:29:21.049393 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:29:21.057086 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:29:21.058040 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:29:21.060971 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:29:21.061715 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:29:21.062138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:22.414327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1bf57337-e717-4971-8983-99a08904985d&page=queryresults
[0m19:29:23.320186 [info ] [Thread-1  ]: 2 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.27s]
[0m19:29:23.321735 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:29:23.322578 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:29:23.323329 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:29:23.324191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:29:23.324832 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:29:23.332371 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:29:23.333500 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:29:23.337551 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:29:23.338371 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:29:23.338842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:24.684241 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2dff9014-fed4-4bd6-a34d-4ad9a1a75e75&page=queryresults
[0m19:29:25.580900 [info ] [Thread-1  ]: 3 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.26s]
[0m19:29:25.582636 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:29:25.583612 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:29:25.584662 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:29:25.585950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:29:25.586777 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:29:25.598524 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:29:25.600224 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:29:25.604396 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:29:25.605402 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:29:25.605913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:26.993973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e34c84a8-e660-472e-9a1c-7f853490add5&page=queryresults
[0m19:29:27.869102 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.28s]
[0m19:29:27.870757 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:29:27.871522 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:29:27.872293 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:29:27.873215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:29:27.873868 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:29:27.881494 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:29:27.882631 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:29:27.886494 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:29:27.887362 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:29:27.887836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:29.344804 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a993b144-8c6b-4a4e-8d4c-3aa218080224&page=queryresults
[0m19:29:30.275434 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.40s]
[0m19:29:30.277405 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:29:30.278370 [debug] [Thread-1  ]: Began running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:29:30.279289 [info ] [Thread-1  ]: 6 of 12 START test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [RUN]
[0m19:29:30.280304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56)
[0m19:29:30.281046 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:29:30.292830 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:29:30.294669 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:29:30.298912 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:29:30.300146 [debug] [Thread-1  ]: On test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    group by Rating

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:29:30.300686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:31.660292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:461b5ab8-b4ed-404e-a78e-09d49a8337c0&page=queryresults
[0m19:29:31.662023 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:461b5ab8-b4ed-404e-a78e-09d49a8337c0&page=queryresults
[0m19:29:31.688459 [debug] [Thread-1  ]: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:29:31.689253 [error] [Thread-1  ]: 6 of 12 ERROR source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [[31mERROR[0m in 1.41s]
[0m19:29:31.689938 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:29:31.690396 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:29:31.690953 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql.
[0m19:29:31.691420 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:29:31.692090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:29:31.692530 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:29:31.699451 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:29:31.700367 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:29:31.703163 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:29:31.703900 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:29:31.704315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:33.556229 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4c2fbc6f-d258-4a30-84b1-6761185fbbf4&page=queryresults
[0m19:29:34.410090 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.72s]
[0m19:29:34.410915 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:29:34.411363 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:29:34.411833 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:29:34.412391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:29:34.412796 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:29:34.418744 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:29:34.419879 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:29:34.422939 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:29:34.423751 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:29:34.424169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:35.628985 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:bc0d3ee2-bc48-47e0-a9e2-d9011825f0ed&page=queryresults
[0m19:29:36.409850 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.00s]
[0m19:29:36.411625 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:29:36.412567 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:29:36.413479 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:29:36.414499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:29:36.415236 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:29:36.429924 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:29:36.432212 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:29:36.436226 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:29:36.437290 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:29:36.437851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:37.941725 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:70fff026-2c62-4980-8165-332059f366b2&page=queryresults
[0m19:29:38.752572 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.34s]
[0m19:29:38.753724 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:29:38.754405 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:29:38.755128 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m19:29:38.755993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:29:38.756655 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:29:38.765464 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:29:38.767226 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:29:38.770543 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:29:38.771391 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:29:38.771806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:40.192159 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d04fc57d-ff3f-4047-97bb-120d0442ac13&page=queryresults
[0m19:29:41.236629 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_author_insights_author_id ............................ [[32mPASS[0m in 2.48s]
[0m19:29:41.238451 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:29:41.239334 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:29:41.240210 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:29:41.241191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:29:41.241907 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:29:41.252543 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:29:41.255190 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:29:41.259686 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:29:41.261023 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:29:41.261611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:42.742883 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1aeb2f0b-8c2d-4418-9d69-a105287997a7&page=queryresults
[0m19:29:43.584792 [info ] [Thread-1  ]: 11 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.34s]
[0m19:29:43.586454 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:29:43.587323 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:29:43.588044 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:29:43.588908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:29:43.589898 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:29:43.597839 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:29:43.599569 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:29:43.603741 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:29:43.606347 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:29:43.607075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:45.622005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:555aedef-527d-476e-8b37-36c9aff76122&page=queryresults
[0m19:29:46.452049 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.86s]
[0m19:29:46.453842 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:29:46.456156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:46.460870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:46.461655 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_marts' was properly closed.
[0m19:29:46.462214 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:29:46.462949 [info ] [MainThread]: 
[0m19:29:46.463585 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 32.25 seconds (32.25s).
[0m19:29:46.466764 [debug] [MainThread]: Command end result
[0m19:29:46.500199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:29:46.502284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:29:46.510735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:29:46.511109 [info ] [MainThread]: 
[0m19:29:46.511509 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:29:46.511839 [info ] [MainThread]: 
[0m19:29:46.512260 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m19:29:46.512710 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:29:46.513038 [info ] [MainThread]: 
[0m19:29:46.513406 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:29:46.513731 [info ] [MainThread]: 
[0m19:29:46.514099 [error] [MainThread]: [31mFailure in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)[0m
[0m19:29:46.514473 [error] [MainThread]:   Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:29:46.514780 [info ] [MainThread]: 
[0m19:29:46.515132 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:29:46.515443 [info ] [MainThread]: 
[0m19:29:46.515965 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m19:29:46.520644 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 35.98975, "process_in_blocks": "0", "process_kernel_time": 0.834179, "process_mem_max_rss": "350142464", "process_out_blocks": "0", "process_user_time": 5.407637}
[0m19:29:46.521083 [debug] [MainThread]: Command `dbt test` failed at 19:29:46.521004 after 35.99 seconds
[0m19:29:46.521470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13300e0a0>]}
[0m19:29:46.522292 [debug] [MainThread]: Flushing usage events
[0m19:29:48.098043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:32.294930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108606280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a1400>]}


============================== 19:31:32.301240 | 22990523-5c37-47b1-9333-34fec6108a46 ==============================
[0m19:31:32.301240 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:31:32.302077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:31:35.363759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d728e0>]}
[0m19:31:35.424155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cee370>]}
[0m19:31:35.424851 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:31:35.715616 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:31:35.848225 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:31:35.848791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109777a00>]}
[0m19:31:37.642232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459cf130>]}
[0m19:31:37.789392 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:31:37.793615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:31:38.047427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145817100>]}
[0m19:31:38.048200 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:31:38.048686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1452c5160>]}
[0m19:31:38.050805 [info ] [MainThread]: 
[0m19:31:38.051256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:38.051638 [info ] [MainThread]: 
[0m19:31:38.052177 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:31:38.058152 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_marts'
[0m19:31:38.058622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:45.357625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now list_dbtandbigquery-467100_staging)
[0m19:31:45.359371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:52.360492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22990523-5c37-47b1-9333-34fec6108a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189460>]}
[0m19:31:52.363393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:52.371506 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:31:52.372492 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ...... [RUN]
[0m19:31:52.373517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73)
[0m19:31:52.374219 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:31:52.390016 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:31:52.391291 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:31:52.420800 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:31:52.422611 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:31:52.423299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:56.550649 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5c760fec-0af7-4bb2-a02c-33c065364b2d&page=queryresults
[0m19:31:56.552073 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5c760fec-0af7-4bb2-a02c-33c065364b2d&page=queryresults
[0m19:31:56.606699 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:31:56.607407 [error] [Thread-1  ]: 1 of 12 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ........... [[31mERROR[0m in 4.23s]
[0m19:31:56.608031 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:31:56.608449 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:31:56.608966 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m19:31:56.609400 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:31:56.610328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:31:56.610869 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:31:56.619202 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:31:56.620263 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:31:56.623232 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:31:56.624028 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:31:56.624456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:57.942309 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:027f6570-0b94-4f96-99f9-5c3f4ab27873&page=queryresults
[0m19:31:59.118900 [info ] [Thread-1  ]: 2 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.51s]
[0m19:31:59.120162 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:31:59.120674 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:31:59.121137 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:31:59.121681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:31:59.122089 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:31:59.128865 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:31:59.129988 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:31:59.133476 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:31:59.134474 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:31:59.134966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:00.897567 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:fcd20288-19ca-40a0-b5f2-5a975c1d995b&page=queryresults
[0m19:32:01.856837 [info ] [Thread-1  ]: 3 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.73s]
[0m19:32:01.858629 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:32:01.859499 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:32:01.860472 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:32:01.861789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:32:01.863128 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:32:01.872491 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:32:01.874910 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:32:01.879339 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:32:01.880669 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:32:01.881255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:03.117112 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a5b888c8-3b50-4e65-87c6-9f670cd528fa&page=queryresults
[0m19:32:04.438194 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.58s]
[0m19:32:04.439767 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:32:04.440599 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:32:04.441167 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:32:04.441802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:32:04.442236 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:32:04.448275 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:32:04.449302 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:32:04.452351 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:32:04.453152 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:32:04.453582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:05.760525 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:869691d8-234b-4b04-b6ff-3f9c3d02e646&page=queryresults
[0m19:32:06.683668 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.24s]
[0m19:32:06.685959 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:32:06.686927 [debug] [Thread-1  ]: Began running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:32:06.687751 [info ] [Thread-1  ]: 6 of 12 START test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [RUN]
[0m19:32:06.688735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56)
[0m19:32:06.689445 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:32:06.700402 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:32:06.701728 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:32:06.705306 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:32:06.707229 [debug] [Thread-1  ]: On test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    group by Rating

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:32:06.707738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:08.524030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:78dfaefe-53d5-45a7-a4dc-a15eabcb02d7&page=queryresults
[0m19:32:08.524759 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:78dfaefe-53d5-45a7-a4dc-a15eabcb02d7&page=queryresults
[0m19:32:08.540889 [debug] [Thread-1  ]: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:32:08.541614 [error] [Thread-1  ]: 6 of 12 ERROR source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [[31mERROR[0m in 1.85s]
[0m19:32:08.542244 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:32:08.542672 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:32:08.543174 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql.
[0m19:32:08.543635 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:32:08.544570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:32:08.545070 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:32:08.550716 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:32:08.551700 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:32:08.554561 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:32:08.555451 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:32:08.555923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:09.979746 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:12e66b67-f9ee-4750-b80d-8b69c0564ef4&page=queryresults
[0m19:32:10.967057 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.42s]
[0m19:32:10.968662 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:32:10.969545 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:32:10.970335 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:32:10.971687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:32:10.972509 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:32:10.981163 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:32:10.982663 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:32:10.986700 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:32:10.987747 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:32:10.988295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:12.181602 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:bdd1fd3f-a128-4453-b2bf-e8da48ae8ea5&page=queryresults
[0m19:32:13.081422 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.11s]
[0m19:32:13.082949 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:32:13.083745 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:32:13.084556 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:32:13.085389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:32:13.085962 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:32:13.098210 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:32:13.099226 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:32:13.102143 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:32:13.102904 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:32:13.103345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:14.366160 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7ec8b411-96d1-4a73-be74-b39bee1a5dfd&page=queryresults
[0m19:32:15.295697 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.21s]
[0m19:32:15.297243 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:32:15.297983 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:32:15.298991 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m19:32:15.300205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:32:15.300987 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:32:15.308572 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:32:15.309833 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:32:15.313393 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:32:15.314544 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:32:15.315070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:16.512253 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:46128ae6-0c1c-4729-bcd4-5d15c16fd6b6&page=queryresults
[0m19:32:17.639253 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_author_insights_author_id ............................ [[32mPASS[0m in 2.34s]
[0m19:32:17.640805 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:32:17.641536 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:32:17.642312 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:32:17.643258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:32:17.644306 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:32:17.651524 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:32:17.652854 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:32:17.656395 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:32:17.657514 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:32:17.658050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:19.013659 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8402a638-1d35-4b12-a9bf-ba53617cee44&page=queryresults
[0m19:32:19.789596 [info ] [Thread-1  ]: 11 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.15s]
[0m19:32:19.790913 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:32:19.791434 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:32:19.791949 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:32:19.792566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:32:19.792992 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:32:19.800058 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:32:19.801802 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:32:19.804693 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:32:19.805821 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:32:19.806272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:21.320603 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f39ff1af-8dca-40da-be00-8b2f7ef9ff37&page=queryresults
[0m19:32:22.143797 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.35s]
[0m19:32:22.145236 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:32:22.147061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:32:22.150184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:22.150758 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:32:22.151653 [info ] [MainThread]: 
[0m19:32:22.152542 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 44.10 seconds (44.10s).
[0m19:32:22.155335 [debug] [MainThread]: Command end result
[0m19:32:22.188042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:32:22.190880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:32:22.199359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:32:22.199742 [info ] [MainThread]: 
[0m19:32:22.200157 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:32:22.200505 [info ] [MainThread]: 
[0m19:32:22.200917 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m19:32:22.201310 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:32:22.201628 [info ] [MainThread]: 
[0m19:32:22.201997 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:32:22.202318 [info ] [MainThread]: 
[0m19:32:22.202690 [error] [MainThread]: [31mFailure in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)[0m
[0m19:32:22.203071 [error] [MainThread]:   Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:32:22.203385 [info ] [MainThread]: 
[0m19:32:22.203743 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:32:22.204064 [info ] [MainThread]: 
[0m19:32:22.204518 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m19:32:22.210018 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 50.019012, "process_in_blocks": "0", "process_kernel_time": 1.01833, "process_mem_max_rss": "345669632", "process_out_blocks": "0", "process_user_time": 7.442392}
[0m19:32:22.210809 [debug] [MainThread]: Command `dbt test` failed at 19:32:22.210715 after 50.02 seconds
[0m19:32:22.211278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108606280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456efc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456eff70>]}
[0m19:32:22.211785 [debug] [MainThread]: Flushing usage events
[0m19:32:24.094738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:42.534603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c46220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb81c0>]}


============================== 19:32:42.538918 | 7a7caec9-bf2a-4e8f-a972-17faed46cac6 ==============================
[0m19:32:42.538918 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:32:42.539567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:32:42.682777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a7caec9-bf2a-4e8f-a972-17faed46cac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e18820>]}
[0m19:32:42.719021 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.26213768, "process_in_blocks": "0", "process_kernel_time": 0.236922, "process_mem_max_rss": "99942400", "process_out_blocks": "0", "process_user_time": 1.410724}
[0m19:32:42.719552 [debug] [MainThread]: Command `dbt clean` succeeded at 19:32:42.719451 after 0.26 seconds
[0m19:32:42.719963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c46220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106105d60>]}
[0m19:32:42.720389 [debug] [MainThread]: Flushing usage events
[0m19:32:44.615901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:53.912454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107406280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108861df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108861400>]}


============================== 19:32:53.916718 | 0adad909-7668-4615-994d-db3a3f9f6a0e ==============================
[0m19:32:53.916718 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:32:53.917290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:56.801091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085af2b0>]}
[0m19:32:56.861131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088362b0>]}
[0m19:32:56.861927 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:32:57.142515 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:32:57.143771 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:32:57.144249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141ebed00>]}
[0m19:32:58.617964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1439d1130>]}
[0m19:32:58.867130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:32:58.869924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:32:58.902631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e5f610>]}
[0m19:32:58.903198 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:32:58.903593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143b00040>]}
[0m19:32:58.905386 [info ] [MainThread]: 
[0m19:32:58.905794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:58.906120 [info ] [MainThread]: 
[0m19:32:58.906617 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:32:58.911902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_marts'
[0m19:32:58.912366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:00.194849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now list_dbtandbigquery-467100_staging)
[0m19:33:00.196372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:02.566169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adad909-7668-4615-994d-db3a3f9f6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91460>]}
[0m19:33:02.567450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:02.576636 [debug] [Thread-1  ]: Began running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:33:02.577742 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_stg_food_reviews_rating__1__2__3__4__5 ...... [RUN]
[0m19:33:02.578742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73)
[0m19:33:02.579468 [debug] [Thread-1  ]: Began compiling node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:33:02.593759 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:33:02.596149 [debug] [Thread-1  ]: Began executing node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:33:02.700831 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"
[0m19:33:02.703869 [debug] [Thread-1  ]: On test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:33:02.706842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:12.305130 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a01292bd-a807-4be6-a46a-ddac036d06f9&page=queryresults
[0m19:33:12.307967 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a01292bd-a807-4be6-a46a-ddac036d06f9&page=queryresults
[0m19:33:12.368790 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:33:12.369494 [error] [Thread-1  ]: 1 of 12 ERROR accepted_values_stg_food_reviews_rating__1__2__3__4__5 ........... [[31mERROR[0m in 9.79s]
[0m19:33:12.370119 [debug] [Thread-1  ]: Finished running node test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73
[0m19:33:12.370536 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:33:12.371089 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql.
[0m19:33:12.371526 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:33:12.372150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.accepted_values_stg_food_reviews_rating__1__2__3__4__5.ba8e2c6c73, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:33:12.372552 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:33:12.380930 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:33:12.382280 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:33:12.385315 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:33:12.386446 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:33:12.386887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:13.796728 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3c53e28b-0ffd-4f81-a658-c2c611dbba5f&page=queryresults
[0m19:33:14.755206 [info ] [Thread-1  ]: 2 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.38s]
[0m19:33:14.756382 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:33:14.757000 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:33:14.757637 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:33:14.758399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:33:14.759144 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:33:14.765990 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:33:14.767452 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:33:14.771482 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:33:14.772473 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:33:14.773006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:16.417848 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d7e8435a-2a85-405c-8124-6ff909ea1436&page=queryresults
[0m19:33:17.246721 [info ] [Thread-1  ]: 3 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.49s]
[0m19:33:17.248488 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:33:17.249656 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:33:17.250665 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:33:17.251807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:33:17.252477 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:33:17.263153 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:33:17.264733 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:33:17.269172 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:33:17.270341 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:33:17.270884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:18.733992 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:75222e9d-758d-4232-92aa-ba0eecf595b1&page=queryresults
[0m19:33:19.691574 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.44s]
[0m19:33:19.693737 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:33:19.694900 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:33:19.696005 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:33:19.697497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:33:19.698545 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:33:19.707085 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:33:19.708835 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:33:19.713212 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:33:19.714467 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:33:19.715009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:21.628809 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b003096f-69cd-4027-8490-806afb1caccd&page=queryresults
[0m19:33:22.516164 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.82s]
[0m19:33:22.517580 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:33:22.518465 [debug] [Thread-1  ]: Began running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:33:22.519263 [info ] [Thread-1  ]: 6 of 12 START test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [RUN]
[0m19:33:22.520289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56)
[0m19:33:22.520961 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:33:22.530272 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:33:22.532480 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:33:22.536642 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"
[0m19:33:22.538184 [debug] [Thread-1  ]: On test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Rating as value_field,
        count(*) as n_records

    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    group by Rating

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
[0m19:33:22.538739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:24.538236 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:53f976dd-63db-48f6-8bfa-dd67adc9e62c&page=queryresults
[0m19:33:24.539998 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:53f976dd-63db-48f6-8bfa-dd67adc9e62c&page=queryresults
[0m19:33:24.560573 [debug] [Thread-1  ]: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:33:24.561646 [error] [Thread-1  ]: 6 of 12 ERROR source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5  [[31mERROR[0m in 2.04s]
[0m19:33:24.562392 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56
[0m19:33:24.562871 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:33:24.563403 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql.
[0m19:33:24.563835 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:33:24.564504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5.93858b2b56, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:33:24.565062 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:33:24.570246 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:33:24.571247 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:33:24.574073 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:33:24.574897 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:33:24.575389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:25.837377 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:02bcea30-1401-419d-862e-939c379984fb&page=queryresults
[0m19:33:26.744889 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.18s]
[0m19:33:26.746205 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:33:26.746921 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:33:26.747667 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:33:26.748473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:33:26.749060 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:33:26.756233 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:33:26.757463 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:33:26.761107 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:33:26.762212 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:33:26.762697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:28.799853 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5bc791bb-4406-4059-8f4e-f5414e9f544a&page=queryresults
[0m19:33:29.866082 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 3.12s]
[0m19:33:29.867460 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:33:29.868384 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:33:29.869309 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:33:29.870315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:33:29.871035 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:33:29.880393 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:33:29.881596 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:33:29.884757 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:33:29.885748 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:33:29.886250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:31.117491 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:c650934c-facc-44aa-8928-63d291ea6437&page=queryresults
[0m19:33:31.970296 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.10s]
[0m19:33:31.972365 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:33:31.973482 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:33:31.974333 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m19:33:31.977417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:33:31.978752 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:33:31.986711 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:33:31.988202 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:33:31.992520 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:33:31.993876 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:33:31.994589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:33.620636 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e732614c-0540-4d61-bc3a-4933a122f581&page=queryresults
[0m19:33:34.510920 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_author_insights_author_id ............................ [[32mPASS[0m in 2.53s]
[0m19:33:34.513016 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:33:34.514388 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:33:34.515529 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:33:34.516571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:33:34.517265 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:33:34.525194 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:33:34.526823 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:33:34.530971 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:33:34.532077 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:33:34.532581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:35.888865 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:50af0de8-4a65-488b-a98c-1c9293851ebd&page=queryresults
[0m19:33:38.969195 [info ] [Thread-1  ]: 11 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 4.45s]
[0m19:33:38.970897 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:33:38.971917 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:33:38.972693 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:33:38.973504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:33:38.974169 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:33:38.980373 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:33:38.981556 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:33:38.984633 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:33:38.985538 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:33:38.985993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:46.997981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1df89581-466b-4d03-802d-33fcc419ef43&page=queryresults
[0m19:33:47.841545 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 8.87s]
[0m19:33:47.843263 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:33:47.845495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:47.849549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:47.850629 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:33:47.851261 [info ] [MainThread]: 
[0m19:33:47.851823 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 48.94 seconds (48.94s).
[0m19:33:47.854135 [debug] [MainThread]: Command end result
[0m19:33:47.886145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:33:47.892028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:33:47.900225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:33:47.900605 [info ] [MainThread]: 
[0m19:33:47.901031 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:33:47.901388 [info ] [MainThread]: 
[0m19:33:47.901801 [error] [MainThread]: [31mFailure in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)[0m
[0m19:33:47.902202 [error] [MainThread]:   Database Error in test accepted_values_stg_food_reviews_rating__1__2__3__4__5 (models/staging/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:33:47.902524 [info ] [MainThread]: 
[0m19:33:47.902888 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/accepted_values_stg_food_reviews_rating__1__2__3__4__5.sql
[0m19:33:47.903222 [info ] [MainThread]: 
[0m19:33:47.903601 [error] [MainThread]: [31mFailure in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)[0m
[0m19:33:47.904005 [error] [MainThread]:   Database Error in test source_accepted_values_raw_data_food_reviews_Rating__0__1__2__3__4__5 (models/raw/sources.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:33:47.904322 [info ] [MainThread]: 
[0m19:33:47.904710 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_accepted_values_raw_dat_a0bace6142fc7d7861f69bbbfb77bdf5.sql
[0m19:33:47.905036 [info ] [MainThread]: 
[0m19:33:47.905501 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m19:33:47.911151 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 54.07655, "process_in_blocks": "0", "process_kernel_time": 0.921602, "process_mem_max_rss": "354238464", "process_out_blocks": "0", "process_user_time": 6.612419}
[0m19:33:47.912013 [debug] [MainThread]: Command `dbt test` failed at 19:33:47.911902 after 54.08 seconds
[0m19:33:47.912501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107406280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142ee3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb1e430>]}
[0m19:33:47.912926 [debug] [MainThread]: Flushing usage events
[0m19:33:49.357524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:14.501139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12117aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12117a2b0>]}


============================== 19:34:14.505443 | 8f40b920-1d0c-46f4-84c5-7d97de0db88d ==============================
[0m19:34:14.505443 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:34:14.506030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation query --args {sql: "SELECT DISTINCT rating, typeof(rating) FROM staging.stg_food_reviews ORDER BY rating"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:17.446774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f40b920-1d0c-46f4-84c5-7d97de0db88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121114250>]}
[0m19:34:17.507070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f40b920-1d0c-46f4-84c5-7d97de0db88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d88970>]}
[0m19:34:17.507757 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:34:17.793050 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:34:17.990697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:17.991152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:18.050595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f40b920-1d0c-46f4-84c5-7d97de0db88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533c5e50>]}
[0m19:34:18.164499 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:34:18.167031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:34:18.187008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f40b920-1d0c-46f4-84c5-7d97de0db88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533e0cd0>]}
[0m19:34:18.187649 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:34:18.188054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f40b920-1d0c-46f4-84c5-7d97de0db88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152f11c70>]}
[0m19:34:18.188610 [debug] [MainThread]: Acquiring new bigquery connection 'macro_query'
[0m19:34:18.189018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:18.191157 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "query" in any package
[0m19:34:18.199041 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 1271, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "query" in any package

[0m19:34:18.199550 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt could not find a macro with the name 'query' in any package. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:34:18.203659 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 3.7849696, "process_in_blocks": "0", "process_kernel_time": 0.722056, "process_mem_max_rss": "347242496", "process_out_blocks": "0", "process_user_time": 3.727304}
[0m19:34:18.204155 [debug] [MainThread]: Command `dbt run-operation` failed at 19:34:18.204053 after 3.79 seconds
[0m19:34:18.204496 [debug] [MainThread]: Connection 'macro_query' was properly closed.
[0m19:34:18.204886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533dd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533dd8b0>]}
[0m19:34:18.205267 [debug] [MainThread]: Flushing usage events
[0m19:34:19.140090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:44.696925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118621df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118621400>]}


============================== 19:34:44.701108 | 0fa77588-9306-4058-8a1f-45ec9a0b4a97 ==============================
[0m19:34:44.701108 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:34:44.701680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:34:47.781665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152a33520>]}
[0m19:34:47.857554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce3400>]}
[0m19:34:47.858562 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:34:48.328108 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:34:48.657959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:34:48.659225 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/staging/schema.yml
[0m19:34:48.659959 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/sources.yml
[0m19:34:49.311359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153814130>]}
[0m19:34:49.440515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:34:49.443575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:34:49.613516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15360ec40>]}
[0m19:34:49.614166 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 495 macros
[0m19:34:49.614621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153607160>]}
[0m19:34:49.616680 [info ] [MainThread]: 
[0m19:34:49.617127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:49.617495 [info ] [MainThread]: 
[0m19:34:49.618039 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:49.623877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:34:49.624639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:50.643115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:34:50.644817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:51.650229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa77588-9306-4058-8a1f-45ec9a0b4a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15357ef10>]}
[0m19:34:51.650868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:51.655964 [debug] [Thread-1  ]: Began running node test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7
[0m19:34:51.656481 [info ] [Thread-1  ]: 1 of 12 START test dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL  [RUN]
[0m19:34:51.657004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7)
[0m19:34:51.657417 [debug] [Thread-1  ]: Began compiling node test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7
[0m19:34:51.670473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:51.708523 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:34:51.709475 [error] [Thread-1  ]: 1 of 12 ERROR dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL  [[31mERROR[0m in 0.05s]
[0m19:34:51.710176 [debug] [Thread-1  ]: Finished running node test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7
[0m19:34:51.710654 [debug] [Thread-1  ]: Began running node test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a
[0m19:34:51.711143 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:34:51.711555 [info ] [Thread-1  ]: 2 of 12 START test dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5  [RUN]
[0m19:34:51.712208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL.a3f3c9c8c7, now test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a)
[0m19:34:51.712603 [debug] [Thread-1  ]: Began compiling node test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a
[0m19:34:51.719102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:51.727819 [debug] [Thread-1  ]: Compilation Error in test dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5 (models/raw/sources.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:34:51.728550 [error] [Thread-1  ]: 2 of 12 ERROR dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5  [[31mERROR[0m in 0.02s]
[0m19:34:51.729133 [debug] [Thread-1  ]: Finished running node test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a
[0m19:34:51.729565 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:34:51.730332 [debug] [Thread-4  ]: Marking all children of 'test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5 (models/raw/sources.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:34:51.729958 [info ] [Thread-1  ]: 3 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:34:51.731388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5.a4d3a2962a, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:34:51.731980 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:34:51.742467 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:34:51.743980 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:34:51.769412 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:34:51.770557 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:51.771048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:53.155706 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4fc29222-9337-41a4-91ce-b03f4bfabf16&page=queryresults
[0m19:34:54.280290 [info ] [Thread-1  ]: 3 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.55s]
[0m19:34:54.281133 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:34:54.281595 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:34:54.282069 [info ] [Thread-1  ]: 4 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:34:54.282623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:34:54.283029 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:34:54.288624 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:34:54.289538 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:34:54.292780 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:34:54.293745 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:54.294224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:55.808242 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:00a092e5-b2fb-407c-9f66-7e3384926d5f&page=queryresults
[0m19:34:56.596891 [info ] [Thread-1  ]: 4 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.31s]
[0m19:34:56.598142 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:34:56.598878 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:34:56.599649 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:34:56.600605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:34:56.601295 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:34:56.609182 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:34:56.610540 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:34:56.614228 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:34:56.615352 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:56.615870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:58.049644 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8640fcfa-d04a-4755-a391-20bd0cdfee76&page=queryresults
[0m19:34:58.932912 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.33s]
[0m19:34:58.933668 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:34:58.934118 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:34:58.934636 [info ] [Thread-1  ]: 6 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:34:58.935209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:34:58.935632 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:34:58.941880 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:34:58.943447 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:34:58.947120 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:34:58.948345 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:34:58.948842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:00.148239 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d7c745b6-422d-4930-9f2b-9e2aeddbde3e&page=queryresults
[0m19:35:01.020874 [info ] [Thread-1  ]: 6 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.09s]
[0m19:35:01.022592 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:35:01.023436 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:35:01.024502 [info ] [Thread-1  ]: 7 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:35:01.025501 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:35:01.028108 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:35:01.035644 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:35:01.036667 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:35:01.039551 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:35:01.040321 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:35:01.040746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:02.263445 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f03ec0d4-0a11-4c80-b3de-5b0c60ba892e&page=queryresults
[0m19:35:03.060421 [info ] [Thread-1  ]: 7 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.03s]
[0m19:35:03.061741 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:35:03.062450 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:35:03.063228 [info ] [Thread-1  ]: 8 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:35:03.064179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:35:03.064864 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:35:03.072387 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:35:03.074681 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:35:03.078300 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:35:03.079222 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:35:03.079673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:04.240143 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7ddc813e-d1c2-48be-8ebb-9db9bcc29d56&page=queryresults
[0m19:35:05.033110 [info ] [Thread-1  ]: 8 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 1.97s]
[0m19:35:05.034527 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:35:05.035214 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:35:05.036014 [info ] [Thread-1  ]: 9 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:35:05.036933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:35:05.037612 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:35:05.047970 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:35:05.049297 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:35:05.052617 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:35:05.053603 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:35:05.054124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:06.266376 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6ef9af73-d43f-449a-927a-c96dae1e3b54&page=queryresults
[0m19:35:07.067646 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.03s]
[0m19:35:07.068682 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:35:07.069257 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:35:07.069839 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_author_insights_author_id ...................... [RUN]
[0m19:35:07.070516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:35:07.070981 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:35:07.077802 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:35:07.079163 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:35:07.083420 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:35:07.084190 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:35:07.084620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:08.605329 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:c58bb5f8-8792-444a-83a6-ea9d4ad07f75&page=queryresults
[0m19:35:09.433200 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_author_insights_author_id ............................ [[32mPASS[0m in 2.36s]
[0m19:35:09.434639 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:35:09.435383 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:35:09.436197 [info ] [Thread-1  ]: 11 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:35:09.437288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:35:09.438003 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:35:09.444186 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:35:09.445310 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:35:09.448470 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:35:09.449312 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:35:09.449798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:11.053515 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:deae82d7-f0d9-4d33-baa6-a6bb50302c8d&page=queryresults
[0m19:35:11.923449 [info ] [Thread-1  ]: 11 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.49s]
[0m19:35:11.925049 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:35:11.925817 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:35:11.926431 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:35:11.927176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:35:11.927724 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:35:11.935182 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:35:11.937525 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:35:11.940968 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:35:11.941944 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:35:11.942459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:13.337483 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:df97525e-5b56-46da-b0e5-345242f59530&page=queryresults
[0m19:35:14.211034 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.28s]
[0m19:35:14.212013 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:35:14.213240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:14.215341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:14.215728 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:35:14.216122 [info ] [MainThread]: 
[0m19:35:14.216511 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 24.60 seconds (24.60s).
[0m19:35:14.218811 [debug] [MainThread]: Command end result
[0m19:35:14.250230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:35:14.252466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:35:14.260766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:35:14.261145 [info ] [MainThread]: 
[0m19:35:14.261559 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:35:14.261911 [info ] [MainThread]: 
[0m19:35:14.262317 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL (models/staging/schema.yml)[0m
[0m19:35:14.262721 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_stg_food_reviews_rating__rating_BETWEEN_1_AND_5_OR_rating_IS_NULL (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:35:14.263054 [info ] [MainThread]: 
[0m19:35:14.263434 [error] [MainThread]: [31mFailure in test dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5 (models/raw/sources.yml)[0m
[0m19:35:14.263814 [error] [MainThread]:   Compilation Error in test dbt_utils_source_expression_is_true_raw_data_food_reviews_Rating__Rating_BETWEEN_0_AND_5 (models/raw/sources.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:35:14.264147 [info ] [MainThread]: 
[0m19:35:14.264483 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m19:35:14.268861 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 29.648928, "process_in_blocks": "0", "process_kernel_time": 1.001632, "process_mem_max_rss": "363479040", "process_out_blocks": "0", "process_user_time": 6.189748}
[0m19:35:14.269384 [debug] [MainThread]: Command `dbt test` failed at 19:35:14.269296 after 29.65 seconds
[0m19:35:14.269793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d51550>]}
[0m19:35:14.270195 [debug] [MainThread]: Flushing usage events
[0m19:35:16.736630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:44.864463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103122280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417d400>]}


============================== 19:35:44.870290 | 1bd17337-0f6e-4abc-bfa7-eede2faffa31 ==============================
[0m19:35:44.870290 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:35:44.871107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:48.194858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6db280>]}
[0m19:35:48.254979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7293d0>]}
[0m19:35:48.255658 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:35:48.551205 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:35:48.752367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m19:35:48.753068 [debug] [MainThread]: Partial parsing: added file: dbt_core://macros/test_valid_rating.sql
[0m19:35:48.753927 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/sources.yml
[0m19:35:48.754409 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/staging/schema.yml
[0m19:35:49.328002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa89130>]}
[0m19:35:49.433101 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:35:49.437262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:35:49.471689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fccbfd0>]}
[0m19:35:49.472343 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 496 macros
[0m19:35:49.472787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f990c70>]}
[0m19:35:49.475011 [info ] [MainThread]: 
[0m19:35:49.475536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:49.475931 [info ] [MainThread]: 
[0m19:35:49.476536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:35:49.482203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_marts'
[0m19:35:49.482696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:50.777211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now list_dbtandbigquery-467100_staging)
[0m19:35:50.778175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:51.857760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd17337-0f6e-4abc-bfa7-eede2faffa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415d460>]}
[0m19:35:51.858778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:51.864760 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:35:51.865362 [info ] [Thread-1  ]: 1 of 12 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:35:51.865957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:35:51.866424 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:35:52.013280 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:35:52.015138 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:35:52.038656 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:35:52.039784 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:35:52.040364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:53.439589 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:af506138-873f-4278-b032-5bbc39ca63b3&page=queryresults
[0m19:35:54.791271 [info ] [Thread-1  ]: 1 of 12 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.92s]
[0m19:35:54.792681 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:35:54.793234 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:35:54.793742 [info ] [Thread-1  ]: 2 of 12 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:35:54.794374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:35:54.794867 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:35:54.799913 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:35:54.800849 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:35:54.804318 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:35:54.805147 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:35:54.805595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:59.143933 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8500c413-5a92-427d-834a-f204484d3624&page=queryresults
[0m19:35:59.949422 [info ] [Thread-1  ]: 2 of 12 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 5.15s]
[0m19:35:59.950270 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:35:59.950722 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:35:59.951205 [info ] [Thread-1  ]: 3 of 12 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:35:59.951783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:35:59.952225 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:35:59.958447 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:35:59.960037 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:35:59.963271 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:35:59.964424 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:35:59.964986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:01.137183 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:aa90367e-3d49-4550-9cb9-1074ff313143&page=queryresults
[0m19:36:02.005168 [info ] [Thread-1  ]: 3 of 12 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.05s]
[0m19:36:02.006419 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:36:02.007291 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:36:02.008164 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:36:02.009142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:36:02.009838 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:36:02.017215 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:36:02.018564 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:36:02.022055 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:36:02.023058 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:36:02.023639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:03.237862 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:1d719f46-3808-4aa4-8c06-308f1d7fe9fc&page=queryresults
[0m19:36:04.355671 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.35s]
[0m19:36:04.358048 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:36:04.359230 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:36:04.360103 [info ] [Thread-1  ]: 5 of 12 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:36:04.361056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:36:04.361892 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:36:04.370110 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:36:04.371324 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:36:04.374656 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:36:04.375840 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:36:04.376334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:06.198539 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:a03dd43c-c1c0-4aeb-8e99-4e49b888aa65&page=queryresults
[0m19:36:07.129414 [info ] [Thread-1  ]: 5 of 12 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.77s]
[0m19:36:07.130628 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:36:07.131339 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:36:07.132120 [info ] [Thread-1  ]: 6 of 12 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:36:07.133077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:36:07.133676 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:36:07.141466 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:36:07.143691 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:36:07.147176 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:36:07.148041 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:36:07.148480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:08.649482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e1069ae3-9130-400f-8f7e-2b55d97e7b00&page=queryresults
[0m19:36:09.511280 [info ] [Thread-1  ]: 6 of 12 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.38s]
[0m19:36:09.512272 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:36:09.512771 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:36:09.513239 [info ] [Thread-1  ]: 7 of 12 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:36:09.513852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:36:09.514322 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:36:09.521894 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:36:09.522827 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:36:09.525801 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:36:09.526639 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:36:09.527096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:10.853588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f22e0135-92d0-4dcb-8897-ba2e345eadba&page=queryresults
[0m19:36:11.683367 [info ] [Thread-1  ]: 7 of 12 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.17s]
[0m19:36:11.684155 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:36:11.684602 [debug] [Thread-1  ]: Began running node test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e
[0m19:36:11.685075 [info ] [Thread-1  ]: 8 of 12 START test source_valid_rating_raw_data_food_reviews_Rating__5__0 ...... [RUN]
[0m19:36:11.685681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e)
[0m19:36:11.686106 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e
[0m19:36:11.691283 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e"
[0m19:36:11.692389 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e
[0m19:36:11.695441 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e"
[0m19:36:11.696311 [debug] [Thread-1  ]: On test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

    select count(*)
    from `dbtandbigquery-467100`.`raw`.`food_reviews`
    where Rating is not null
      and (Rating < 0 or Rating > 5)


  
  
      
    ) dbt_internal_test
[0m19:36:11.696736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:12.927999 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:741855ab-d1be-4fad-bd73-4bf232b040e1&page=queryresults
[0m19:36:13.729777 [error] [Thread-1  ]: 8 of 12 FAIL 1 source_valid_rating_raw_data_food_reviews_Rating__5__0 .......... [[31mFAIL 1[0m in 2.04s]
[0m19:36:13.730903 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e
[0m19:36:13.731495 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:36:13.732119 [info ] [Thread-1  ]: 9 of 12 START test unique_mart_author_insights_author_id ....................... [RUN]
[0m19:36:13.732907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_valid_rating_raw_data_food_reviews_Rating__5__0.d20fe10d8e, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:36:13.733474 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:36:13.740003 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:36:13.741351 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:36:13.744828 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:36:13.745711 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:36:13.746159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:15.380550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8116bfbf-acd8-4a9e-87c9-34ebc59ec73a&page=queryresults
[0m19:36:16.160894 [info ] [Thread-1  ]: 9 of 12 PASS unique_mart_author_insights_author_id ............................. [[32mPASS[0m in 2.43s]
[0m19:36:16.161938 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:36:16.162518 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:36:16.163140 [info ] [Thread-1  ]: 10 of 12 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:36:16.163948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:36:16.164456 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:36:16.170907 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:36:16.172130 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:36:16.175363 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:36:16.176397 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:36:16.176916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:17.467244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:48dfaa83-f2f9-4ae0-ac44-7264ccfc7ac9&page=queryresults
[0m19:36:18.600464 [info ] [Thread-1  ]: 10 of 12 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.44s]
[0m19:36:18.601750 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:36:18.602376 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:36:18.602865 [info ] [Thread-1  ]: 11 of 12 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:36:18.603417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:36:18.603824 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:36:18.609873 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:36:18.611213 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:36:18.614221 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:36:18.615033 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:36:18.615473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:21.510460 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7c9a61a7-23ad-455a-865a-4447c3945cf5&page=queryresults
[0m19:36:22.321996 [info ] [Thread-1  ]: 11 of 12 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 3.72s]
[0m19:36:22.323530 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:36:22.324580 [debug] [Thread-1  ]: Began running node test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb
[0m19:36:22.325420 [info ] [Thread-1  ]: 12 of 12 START test valid_rating_stg_food_reviews_rating__5__1 ................. [RUN]
[0m19:36:22.326326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_stg_food_reviews_review_id.6b56770236, now test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb)
[0m19:36:22.326899 [debug] [Thread-1  ]: Began compiling node test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb
[0m19:36:22.333824 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb"
[0m19:36:22.335053 [debug] [Thread-1  ]: Began executing node test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb
[0m19:36:22.338457 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb"
[0m19:36:22.339410 [debug] [Thread-1  ]: On test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

    select count(*)
    from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    where rating is not null
      and (rating < 1 or rating > 5)


  
  
      
    ) dbt_internal_test
[0m19:36:22.339991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:23.521718 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:c90e135d-6bbb-4bd5-9da1-9645b42cf829&page=queryresults
[0m19:36:24.494426 [error] [Thread-1  ]: 12 of 12 FAIL 1 valid_rating_stg_food_reviews_rating__5__1 ..................... [[31mFAIL 1[0m in 2.17s]
[0m19:36:24.496052 [debug] [Thread-1  ]: Finished running node test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb
[0m19:36:24.498432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:24.503927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:24.504609 [debug] [MainThread]: Connection 'test.dbt_core.valid_rating_stg_food_reviews_rating__5__1.311d89b1fb' was properly closed.
[0m19:36:24.505036 [info ] [MainThread]: 
[0m19:36:24.505418 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 35.03 seconds (35.03s).
[0m19:36:24.507561 [debug] [MainThread]: Command end result
[0m19:36:24.541106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:36:24.547590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:36:24.555468 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:36:24.555836 [info ] [MainThread]: 
[0m19:36:24.556383 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:36:24.556845 [info ] [MainThread]: 
[0m19:36:24.557289 [error] [MainThread]: [31mFailure in test source_valid_rating_raw_data_food_reviews_Rating__5__0 (models/raw/sources.yml)[0m
[0m19:36:24.557689 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:36:24.558002 [info ] [MainThread]: 
[0m19:36:24.558372 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/raw/sources.yml/source_valid_rating_raw_data_food_reviews_Rating__5__0.sql
[0m19:36:24.558699 [info ] [MainThread]: 
[0m19:36:24.559073 [error] [MainThread]: [31mFailure in test valid_rating_stg_food_reviews_rating__5__1 (models/staging/schema.yml)[0m
[0m19:36:24.559439 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:36:24.559739 [info ] [MainThread]: 
[0m19:36:24.560097 [info ] [MainThread]:   compiled code at target/compiled/dbt_core/models/staging/schema.yml/valid_rating_stg_food_reviews_rating__5__1.sql
[0m19:36:24.560425 [info ] [MainThread]: 
[0m19:36:24.560771 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=12
[0m19:36:24.565432 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 39.79985, "process_in_blocks": "0", "process_kernel_time": 1.005883, "process_mem_max_rss": "361693184", "process_out_blocks": "0", "process_user_time": 6.168662}
[0m19:36:24.565927 [debug] [MainThread]: Command `dbt test` failed at 19:36:24.565839 after 39.80 seconds
[0m19:36:24.566325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103122280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f755190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380a3ee0>]}
[0m19:36:24.566718 [debug] [MainThread]: Flushing usage events
[0m19:36:25.928150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:50.427827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206fabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206fa1f0>]}


============================== 19:36:50.432050 | 69805d73-2fa4-447f-9bc1-5c6a52b20a21 ==============================
[0m19:36:50.432050 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:36:50.432640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation query --args {"sql": "SELECT Rating FROM dbtandbigquery-467100.raw.food_reviews WHERE Rating < 0 OR Rating > 5 LIMIT 10"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:36:53.317101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69805d73-2fa4-447f-9bc1-5c6a52b20a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a2ef40>]}
[0m19:36:53.376913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69805d73-2fa4-447f-9bc1-5c6a52b20a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12069d460>]}
[0m19:36:53.377702 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:36:53.658960 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:36:53.860541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:53.860987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:53.919791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69805d73-2fa4-447f-9bc1-5c6a52b20a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1432ac130>]}
[0m19:36:54.032424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:36:54.035015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:36:54.052783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69805d73-2fa4-447f-9bc1-5c6a52b20a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143209790>]}
[0m19:36:54.053345 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 496 macros
[0m19:36:54.053736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69805d73-2fa4-447f-9bc1-5c6a52b20a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14329c8e0>]}
[0m19:36:54.054295 [debug] [MainThread]: Acquiring new bigquery connection 'macro_query'
[0m19:36:54.054705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:54.056986 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "query" in any package
[0m19:36:54.065240 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
  File "/Users/bi006217/Documents/study/dbt_bigquery/.venv/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 1271, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "query" in any package

[0m19:36:54.065759 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt could not find a macro with the name 'query' in any package. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:36:54.069818 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 3.7198524, "process_in_blocks": "0", "process_kernel_time": 0.747273, "process_mem_max_rss": "348143616", "process_out_blocks": "0", "process_user_time": 3.682514}
[0m19:36:54.070305 [debug] [MainThread]: Command `dbt run-operation` failed at 19:36:54.070207 after 3.72 seconds
[0m19:36:54.070665 [debug] [MainThread]: Connection 'macro_query' was properly closed.
[0m19:36:54.071031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143209400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1432d0370>]}
[0m19:36:54.071418 [debug] [MainThread]: Flushing usage events
[0m19:36:55.715413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:31.832667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e61ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e614f0>]}


============================== 19:37:31.838009 | 0fbb460d-323b-4649-9d2a-0f6e1b05c310 ==============================
[0m19:37:31.838009 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:37:31.838790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:37:35.488037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104112610>]}
[0m19:37:35.557990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2c7f0>]}
[0m19:37:35.558865 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:37:36.270388 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:37:36.497735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:37:36.498674 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/staging/schema.yml
[0m19:37:36.499293 [debug] [MainThread]: Partial parsing: updated file: dbt_core://models/raw/sources.yml
[0m19:37:37.333232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159be6130>]}
[0m19:37:37.466250 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:37:37.469189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:37:37.643128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159c33d90>]}
[0m19:37:37.643809 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 496 macros
[0m19:37:37.644275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429af40>]}
[0m19:37:37.646325 [info ] [MainThread]: 
[0m19:37:37.646790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:37.647171 [info ] [MainThread]: 
[0m19:37:37.647718 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:37.653636 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:37:37.654154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:39.870408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:37:39.871767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:41.334785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbb460d-323b-4649-9d2a-0f6e1b05c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104251790>]}
[0m19:37:41.335907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:41.342365 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:37:41.342919 [info ] [Thread-1  ]: 1 of 11 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:37:41.343466 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now test.dbt_core.not_null_mart_author_insights_author_id.9029733503)
[0m19:37:41.343874 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:37:41.363826 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:37:41.365098 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:37:41.390873 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:37:41.392492 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:37:41.393005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:42.627674 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9e2162d7-b6d6-4c4c-b031-a142044df291&page=queryresults
[0m19:37:43.581974 [info ] [Thread-1  ]: 1 of 11 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.24s]
[0m19:37:43.583708 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:37:43.584180 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:37:43.584703 [info ] [Thread-1  ]: 2 of 11 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:37:43.585419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:37:43.585863 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:37:43.591879 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:37:43.592929 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:37:43.595887 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:37:43.596622 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:37:43.597040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:44.801775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:c48dadeb-247e-43ca-a37c-aaa3f5bdbe57&page=queryresults
[0m19:37:45.625211 [info ] [Thread-1  ]: 2 of 11 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.04s]
[0m19:37:45.626869 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:37:45.627819 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:37:45.628522 [info ] [Thread-1  ]: 3 of 11 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:37:45.629748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:37:45.630501 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:37:45.638450 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:37:45.640078 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:37:45.644270 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:37:45.645296 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:37:45.645841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:47.212946 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:39dc1feb-d64d-4caa-a9fe-fb03fa0cc771&page=queryresults
[0m19:37:48.021597 [info ] [Thread-1  ]: 3 of 11 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.39s]
[0m19:37:48.023128 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:37:48.023940 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:37:48.024713 [info ] [Thread-1  ]: 4 of 11 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:37:48.025645 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:37:48.026299 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:37:48.035104 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:37:48.036294 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:37:48.039811 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:37:48.040964 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:37:48.041478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:49.166955 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:49cbe4f5-7218-41bf-bb00-621bccfada52&page=queryresults
[0m19:37:50.104438 [info ] [Thread-1  ]: 4 of 11 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.08s]
[0m19:37:50.105533 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:37:50.106106 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:37:50.106607 [info ] [Thread-1  ]: 5 of 11 START test source_not_null_raw_data_food_reviews_Rating ................ [RUN]
[0m19:37:50.107117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af)
[0m19:37:50.107512 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:37:50.112880 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:37:50.113919 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:37:50.116829 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:37:50.117780 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Rating
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where Rating is null



  
  
      
    ) dbt_internal_test
[0m19:37:50.118249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:51.692568 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:deda58c3-18da-4abd-9709-cfdd6450c38b&page=queryresults
[0m19:37:52.506141 [info ] [Thread-1  ]: 5 of 11 PASS source_not_null_raw_data_food_reviews_Rating ...................... [[32mPASS[0m in 2.40s]
[0m19:37:52.508067 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:37:52.509048 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:37:52.509891 [info ] [Thread-1  ]: 6 of 11 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:37:52.510902 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:37:52.511628 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:37:52.519408 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:37:52.521027 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:37:52.524685 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:37:52.525864 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:37:52.526422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:53.944130 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9414f35f-0258-4ff7-9b10-5a015d977a24&page=queryresults
[0m19:37:54.758835 [info ] [Thread-1  ]: 6 of 11 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.25s]
[0m19:37:54.760128 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:37:54.760843 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:37:54.761578 [info ] [Thread-1  ]: 7 of 11 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:37:54.762548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:37:54.763233 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:37:54.772570 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:37:54.775196 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:37:54.778451 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:37:54.779265 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:37:54.779706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:55.899268 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:99570303-0be4-4c36-b71d-b1aef9d24b6b&page=queryresults
[0m19:37:56.783283 [info ] [Thread-1  ]: 7 of 11 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.02s]
[0m19:37:56.784336 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:37:56.784935 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:37:56.785578 [info ] [Thread-1  ]: 8 of 11 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:37:56.786395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:37:56.786923 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:37:56.796288 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:37:56.797299 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:37:56.800226 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:37:56.801266 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:37:56.801697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:58.159418 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:286f13c3-c8ee-4b43-995d-f6b29ac52f07&page=queryresults
[0m19:37:58.907272 [info ] [Thread-1  ]: 8 of 11 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.12s]
[0m19:37:58.908191 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:37:58.908679 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:37:58.909165 [info ] [Thread-1  ]: 9 of 11 START test unique_mart_author_insights_author_id ....................... [RUN]
[0m19:37:58.910057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:37:58.910740 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:37:58.918106 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:37:58.919214 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:37:58.924259 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:37:58.925636 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:37:58.926188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:00.100871 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:fd368a9e-b048-41eb-8ece-3e59b0a24c73&page=queryresults
[0m19:38:00.969414 [info ] [Thread-1  ]: 9 of 11 PASS unique_mart_author_insights_author_id ............................. [[32mPASS[0m in 2.06s]
[0m19:38:00.970264 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:38:00.970728 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:38:00.971395 [info ] [Thread-1  ]: 10 of 11 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:38:00.972018 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:38:00.972457 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:38:00.979597 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:38:00.980531 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:38:00.983426 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:38:00.984231 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:38:00.984674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:02.122639 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4c9400d5-34d4-411f-a8bf-0a4d678798fd&page=queryresults
[0m19:38:02.891683 [info ] [Thread-1  ]: 10 of 11 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 1.92s]
[0m19:38:02.892969 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:38:02.893484 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:38:02.893949 [info ] [Thread-1  ]: 11 of 11 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:38:02.894457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:38:02.894857 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:38:02.899868 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:38:02.900848 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:38:02.903805 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:38:02.904588 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:38:02.905028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:04.041982 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8483ed98-3add-46f2-a147-5a2d8c0d5324&page=queryresults
[0m19:38:04.955400 [info ] [Thread-1  ]: 11 of 11 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.06s]
[0m19:38:04.970710 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:38:04.998913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:05.003640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:05.004072 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:38:05.004486 [info ] [MainThread]: 
[0m19:38:05.005372 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 27.36 seconds (27.36s).
[0m19:38:05.007917 [debug] [MainThread]: Command end result
[0m19:38:05.047733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:38:05.053688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:38:05.062052 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:38:05.062442 [info ] [MainThread]: 
[0m19:38:05.062863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:05.063213 [info ] [MainThread]: 
[0m19:38:05.063581 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:38:05.068146 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 33.32557, "process_in_blocks": "0", "process_kernel_time": 1.042036, "process_mem_max_rss": "346013696", "process_out_blocks": "0", "process_user_time": 6.927809}
[0m19:38:05.068706 [debug] [MainThread]: Command `dbt test` succeeded at 19:38:05.068613 after 33.33 seconds
[0m19:38:05.069129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065aef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104112610>]}
[0m19:38:05.069562 [debug] [MainThread]: Flushing usage events
[0m19:38:05.960336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:17.485075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ba190>]}


============================== 19:38:17.489400 | c59348e6-67dd-482e-82de-3f5e05a40f22 ==============================
[0m19:38:17.489400 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:38:17.489990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:38:20.395402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ca8b0>]}
[0m19:38:20.455804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fff9040>]}
[0m19:38:20.456518 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:38:20.744091 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:38:20.946811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:20.947260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:21.005725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151028130>]}
[0m19:38:21.119564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:38:21.122143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:38:21.144330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150f82bb0>]}
[0m19:38:21.144888 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 496 macros
[0m19:38:21.145292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508d5700>]}
[0m19:38:21.146709 [info ] [MainThread]: 
[0m19:38:21.147095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:21.147412 [info ] [MainThread]: 
[0m19:38:21.147891 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:38:21.152771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m19:38:21.153212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:23.357830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:25.354911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_marts'
[0m19:38:25.355813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:29.207898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now list_dbtandbigquery-467100_staging)
[0m19:38:29.208892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:30.225100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a93d0>]}
[0m19:38:30.226127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:30.231080 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m19:38:30.231741 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.stg_food_reviews .......................... [RUN]
[0m19:38:30.232298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now model.dbt_core.stg_food_reviews)
[0m19:38:30.232741 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m19:38:30.244676 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m19:38:30.245629 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m19:38:30.261918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:35.273913 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m19:38:35.275319 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- 🥈 STAGING LAYER (Silver)
-- Responsible for: Cleaning, Standardization, Renaming, Validation



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- Standardized IDs
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- String cleaning
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Rating standardization
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 is invalid
            ELSE NULL
        END AS rating,
        
        -- Date standardization
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Calculated fields
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Quality flags
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filter only valid reviews
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL
    );
  
[0m19:38:35.797172 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:e939bc32-ae88-4fd4-9646-f2d85bbf956e&page=queryresults
[0m19:38:46.039871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060674f0>]}
[0m19:38:46.041042 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.stg_food_reviews ..................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 15.80s]
[0m19:38:46.041725 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m19:38:46.042494 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m19:38:46.043074 [info ] [Thread-1  ]: 2 of 3 START sql table model marts.mart_author_insights ........................ [RUN]
[0m19:38:46.043595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.stg_food_reviews, now model.dbt_core.mart_author_insights)
[0m19:38:46.044006 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m19:38:46.048924 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m19:38:46.050107 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m19:38:46.052902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:47.339530 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m19:38:47.341094 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Author Insights - Reviewer Behavior and Patterns



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Activity Metrics
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Rating Patterns
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Activity Categorization
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Active'
            WHEN COUNT(*) >= 20 THEN 'Very Active'
            WHEN COUNT(*) >= 10 THEN 'Active'
            WHEN COUNT(*) >= 5 THEN 'Moderate'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Behavior Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Optimistic'
            WHEN AVG(rating) <= 2.5 THEN 'Critical'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistent'
            ELSE 'Varied'
        END AS rating_behavior,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Only authors with at least 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m19:38:47.844421 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4c8539a4-fd03-4ee3-8c33-2774401febcb&page=queryresults
[0m19:38:53.987019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151550550>]}
[0m19:38:53.988360 [info ] [Thread-1  ]: 2 of 3 OK created sql table model marts.mart_author_insights ................... [[32mCREATE TABLE (42.2k rows, 70.3 MiB processed)[0m in 7.94s]
[0m19:38:53.989458 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m19:38:53.990078 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m19:38:53.990864 [info ] [Thread-1  ]: 3 of 3 START sql table model marts.mart_review_metrics ......................... [RUN]
[0m19:38:53.991688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m19:38:53.992234 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m19:38:53.997596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m19:38:53.999719 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m19:38:54.002606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:55.764963 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m19:38:55.767590 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Review Metrics by Recipe - Ready for BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Volume Metrics
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Rating Distribution
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Popularity Categorization
        CASE 
            WHEN COUNT(*) >= 100 THEN 'High'
            WHEN COUNT(*) >= 50 THEN 'Medium'
            WHEN COUNT(*) >= 10 THEN 'Low'
            ELSE 'Very Low'
        END AS popularity_category,
        
        -- Quality Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excellent'
            WHEN AVG(rating) >= 4.0 THEN 'Very Good'
            WHEN AVG(rating) >= 3.5 THEN 'Good'
            WHEN AVG(rating) >= 3.0 THEN 'Fair'
            ELSE 'Poor'
        END AS quality_category,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m19:38:56.231929 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:d1e6df39-0d1c-45a8-88c0-94423ad806e2&page=queryresults
[0m19:39:03.552160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59348e6-67dd-482e-82de-3f5e05a40f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060674f0>]}
[0m19:39:03.553835 [info ] [Thread-1  ]: 3 of 3 OK created sql table model marts.mart_review_metrics .................... [[32mCREATE TABLE (265.8k rows, 54.2 MiB processed)[0m in 9.56s]
[0m19:39:03.555662 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m19:39:03.558193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:03.562207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:03.562955 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100' was properly closed.
[0m19:39:03.563522 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m19:39:03.564185 [info ] [MainThread]: 
[0m19:39:03.564825 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 42.42 seconds (42.42s).
[0m19:39:03.566456 [debug] [MainThread]: Command end result
[0m19:39:03.604845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:39:03.608113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:39:03.615686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:39:03.616102 [info ] [MainThread]: 
[0m19:39:03.616527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:03.616873 [info ] [MainThread]: 
[0m19:39:03.617233 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:39:03.624558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.220818, "process_in_blocks": "0", "process_kernel_time": 0.87095, "process_mem_max_rss": "346161152", "process_out_blocks": "0", "process_user_time": 4.592302}
[0m19:39:03.625191 [debug] [MainThread]: Command `dbt run` succeeded at 19:39:03.625089 after 46.22 seconds
[0m19:39:03.625614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffe41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150f82c70>]}
[0m19:39:03.626047 [debug] [MainThread]: Flushing usage events
[0m19:39:05.302660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:08.243455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037622b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bd460>]}


============================== 19:39:08.247487 | 9ddc47f4-360f-4ded-b2cb-43ea699e44b6 ==============================
[0m19:39:08.247487 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:39:08.248064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:11.198656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10212d5e0>]}
[0m19:39:11.268365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2e9f10>]}
[0m19:39:11.269123 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:39:11.593273 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:39:11.825240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:11.825774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:11.894239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f16fee0>]}
[0m19:39:12.046601 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:39:12.049118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:39:12.081879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2d6340>]}
[0m19:39:12.082509 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 496 macros
[0m19:39:12.082984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2b7e80>]}
[0m19:39:12.085098 [info ] [MainThread]: 
[0m19:39:12.085564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:12.085939 [info ] [MainThread]: 
[0m19:39:12.086506 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:12.092501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:39:12.093033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:13.119558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:39:13.121133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:14.231559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ddc47f4-360f-4ded-b2cb-43ea699e44b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021e4490>]}
[0m19:39:14.232934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:14.241589 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:39:14.242517 [info ] [Thread-1  ]: 1 of 11 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:39:14.243547 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.dbt_core.not_null_mart_author_insights_author_id.9029733503'
[0m19:39:14.244183 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:39:14.269551 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:39:14.270968 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:39:14.294742 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:39:14.295918 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:14.296383 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:39:15.811728 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3dc463eb-c5a0-4af4-b11b-af4127cccf98&page=queryresults
[0m19:39:16.763537 [info ] [Thread-1  ]: 1 of 11 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.52s]
[0m19:39:16.764476 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:39:16.765000 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:39:16.765546 [info ] [Thread-1  ]: 2 of 11 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:39:16.766229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:39:16.766741 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:39:16.772981 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:39:16.775858 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:39:16.779032 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:39:16.779912 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:16.780359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:18.078882 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b70b49b7-3242-42b9-a4f2-ec8fba1ebec5&page=queryresults
[0m19:39:18.999099 [info ] [Thread-1  ]: 2 of 11 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 2.23s]
[0m19:39:19.000951 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:39:19.001733 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:39:19.002539 [info ] [Thread-1  ]: 3 of 11 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:39:19.003870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:39:19.004685 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:39:19.013339 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:39:19.014458 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:39:19.017781 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:39:19.018674 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:19.019167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:20.340057 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:4ae63963-3b4f-4c2c-bede-3f46874948e9&page=queryresults
[0m19:39:21.376200 [info ] [Thread-1  ]: 3 of 11 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.37s]
[0m19:39:21.377679 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:39:21.378508 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:39:21.379833 [info ] [Thread-1  ]: 4 of 11 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:39:21.380941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:39:21.381641 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:39:21.390272 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:39:21.391718 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:39:21.395248 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:39:21.396391 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:39:21.396896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:22.659557 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2d8e27d7-8fe8-44ab-808e-251d7d34a20c&page=queryresults
[0m19:39:23.479243 [info ] [Thread-1  ]: 4 of 11 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 2.10s]
[0m19:39:23.480505 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:39:23.481224 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:39:23.481995 [info ] [Thread-1  ]: 5 of 11 START test source_not_null_raw_data_food_reviews_Rating ................ [RUN]
[0m19:39:23.482936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af)
[0m19:39:23.483758 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:39:23.491370 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:39:23.492633 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:39:23.496031 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:39:23.497043 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Rating
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where Rating is null



  
  
      
    ) dbt_internal_test
[0m19:39:23.497618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:24.846274 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:3b55e832-3a76-45a8-b03d-f830d30d6925&page=queryresults
[0m19:39:25.621533 [info ] [Thread-1  ]: 5 of 11 PASS source_not_null_raw_data_food_reviews_Rating ...................... [[32mPASS[0m in 2.14s]
[0m19:39:25.623265 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:39:25.624180 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:39:25.625136 [info ] [Thread-1  ]: 6 of 11 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:39:25.626097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:39:25.626756 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:39:25.637042 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:39:25.639392 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:39:25.642643 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:39:25.643620 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:39:25.644074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:27.012798 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:aa73ef37-8c51-4e74-82c0-5faf25bb26b6&page=queryresults
[0m19:39:28.161993 [info ] [Thread-1  ]: 6 of 11 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.54s]
[0m19:39:28.163230 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:39:28.163945 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:39:28.164710 [info ] [Thread-1  ]: 7 of 11 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:39:28.165635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:39:28.166405 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:39:28.173873 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:39:28.175529 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:39:28.179019 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:39:28.179890 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:39:28.180392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:29.467788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2b6c558c-741f-491c-9e0d-a97e2ea5d379&page=queryresults
[0m19:39:30.620185 [info ] [Thread-1  ]: 7 of 11 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.45s]
[0m19:39:30.621908 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:39:30.622874 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:39:30.623671 [info ] [Thread-1  ]: 8 of 11 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:39:30.624407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:39:30.624888 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:39:30.632654 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:39:30.633733 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:39:30.636648 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:39:30.637565 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:30.638101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:31.975192 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f330556c-d8ce-4574-8ad5-b2f0e1c1170d&page=queryresults
[0m19:39:32.777488 [info ] [Thread-1  ]: 8 of 11 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 2.15s]
[0m19:39:32.779158 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:39:32.780073 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:39:32.780860 [info ] [Thread-1  ]: 9 of 11 START test unique_mart_author_insights_author_id ....................... [RUN]
[0m19:39:32.781813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:39:32.782469 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:39:32.791616 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:39:32.793244 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:39:32.799589 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:39:32.800592 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:32.801121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:36.887898 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5dea6eb0-a6c0-45df-9326-d82695c80f03&page=queryresults
[0m19:39:37.690516 [info ] [Thread-1  ]: 9 of 11 PASS unique_mart_author_insights_author_id ............................. [[32mPASS[0m in 4.91s]
[0m19:39:37.692258 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:39:37.693084 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:39:37.693924 [info ] [Thread-1  ]: 10 of 11 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:39:37.694939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:39:37.695825 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:39:37.704274 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:39:37.705877 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:39:37.709995 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:39:37.710930 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:37.711446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:39.591879 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:878aad9f-dce9-44e7-b00a-59b41bacbe0f&page=queryresults
[0m19:39:40.426675 [info ] [Thread-1  ]: 10 of 11 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.73s]
[0m19:39:40.428361 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:39:40.429179 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:39:40.429942 [info ] [Thread-1  ]: 11 of 11 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:39:40.430821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:39:40.431525 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:39:40.437312 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:39:40.438614 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:39:40.441857 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:39:40.442661 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:39:40.443107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:42.273990 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:7a0a47a8-2f7c-476a-b566-3149f32a60d0&page=queryresults
[0m19:39:43.054493 [info ] [Thread-1  ]: 11 of 11 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 2.62s]
[0m19:39:43.055805 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:39:43.057475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:43.060436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:43.060977 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_marts' was properly closed.
[0m19:39:43.061418 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:39:43.062468 [info ] [MainThread]: 
[0m19:39:43.063075 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 30.98 seconds (30.98s).
[0m19:39:43.065598 [debug] [MainThread]: Command end result
[0m19:39:43.098237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:39:43.100698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:39:43.108729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:39:43.109098 [info ] [MainThread]: 
[0m19:39:43.109518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:43.109859 [info ] [MainThread]: 
[0m19:39:43.110202 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:39:43.114252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 34.947243, "process_in_blocks": "0", "process_kernel_time": 0.953444, "process_mem_max_rss": "356417536", "process_out_blocks": "0", "process_user_time": 5.675787}
[0m19:39:43.114730 [debug] [MainThread]: Command `dbt test` succeeded at 19:39:43.114649 after 34.95 seconds
[0m19:39:43.115138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037622b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2d68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2d6190>]}
[0m19:39:43.115915 [debug] [MainThread]: Flushing usage events
[0m19:39:44.442170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:34.614572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d061c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111361b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111361160>]}


============================== 19:44:34.618849 | 0cc1d534-6698-495d-993c-3b1ff5486f6a ==============================
[0m19:44:34.618849 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:44:34.619444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:44:37.522890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11066b5e0>]}
[0m19:44:37.581602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11066b280>]}
[0m19:44:37.582282 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m19:44:37.868579 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:44:38.071381 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m19:44:38.071914 [debug] [MainThread]: Partial parsing: deleted file: dbt_core://macros/test_valid_rating.sql
[0m19:44:38.185340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143dd6eb0>]}
[0m19:44:38.297304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:44:38.301199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:44:38.330121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144028be0>]}
[0m19:44:38.330691 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 495 macros
[0m19:44:38.331067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143dcaa90>]}
[0m19:44:38.332876 [info ] [MainThread]: 
[0m19:44:38.333268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:38.333582 [info ] [MainThread]: 
[0m19:44:38.334073 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:38.339223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m19:44:38.339662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:39.593763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m19:44:39.594969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:43.362228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1d534-6698-495d-993c-3b1ff5486f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142657790>]}
[0m19:44:43.364180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:43.372238 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:44:43.372866 [info ] [Thread-1  ]: 1 of 11 START test not_null_mart_author_insights_author_id ..................... [RUN]
[0m19:44:43.373544 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.dbt_core.not_null_mart_author_insights_author_id.9029733503'
[0m19:44:43.374021 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:44:43.397019 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:44:43.398246 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:44:43.422137 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"
[0m19:44:43.423391 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_author_insights_author_id.9029733503: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_author_insights_author_id.9029733503"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select author_id
from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
where author_id is null



  
  
      
    ) dbt_internal_test
[0m19:44:43.423873 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:44:45.049357 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:30457f93-6942-4df8-a19d-babf6083690f&page=queryresults
[0m19:44:46.069766 [info ] [Thread-1  ]: 1 of 11 PASS not_null_mart_author_insights_author_id ........................... [[32mPASS[0m in 2.70s]
[0m19:44:46.071175 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_author_insights_author_id.9029733503
[0m19:44:46.071745 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:44:46.072307 [info ] [Thread-1  ]: 2 of 11 START test not_null_mart_review_metrics_recipe_id ...................... [RUN]
[0m19:44:46.072915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_author_insights_author_id.9029733503, now test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf)
[0m19:44:46.073324 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:44:46.079527 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:44:46.081388 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:44:46.084820 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"
[0m19:44:46.085748 [debug] [Thread-1  ]: On test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:44:46.086213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:48.499609 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:ecf3ddeb-e76f-4024-97fd-ba3b48b91ae3&page=queryresults
[0m19:44:49.407098 [info ] [Thread-1  ]: 2 of 11 PASS not_null_mart_review_metrics_recipe_id ............................ [[32mPASS[0m in 3.33s]
[0m19:44:49.408348 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf
[0m19:44:49.409015 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:44:49.409903 [info ] [Thread-1  ]: 3 of 11 START test not_null_stg_food_reviews_recipe_id ......................... [RUN]
[0m19:44:49.410887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_mart_review_metrics_recipe_id.01d77fe0bf, now test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1)
[0m19:44:49.411547 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:44:49.419305 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:44:49.420906 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:44:49.424118 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"
[0m19:44:49.425007 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recipe_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where recipe_id is null



  
  
      
    ) dbt_internal_test
[0m19:44:49.425460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:50.881937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:6c113149-7723-4a46-8b5e-e8e69d4b43d8&page=queryresults
[0m19:44:51.907521 [info ] [Thread-1  ]: 3 of 11 PASS not_null_stg_food_reviews_recipe_id ............................... [[32mPASS[0m in 2.50s]
[0m19:44:51.908894 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1
[0m19:44:51.909549 [debug] [Thread-1  ]: Began running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:44:51.910246 [info ] [Thread-1  ]: 4 of 11 START test not_null_stg_food_reviews_review_id ......................... [RUN]
[0m19:44:51.911224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_recipe_id.ffdda314b1, now test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf)
[0m19:44:51.911935 [debug] [Thread-1  ]: Began compiling node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:44:51.920275 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:44:51.921690 [debug] [Thread-1  ]: Began executing node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:44:51.926137 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"
[0m19:44:51.927253 [debug] [Thread-1  ]: On test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
where review_id is null



  
  
      
    ) dbt_internal_test
[0m19:44:51.927721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:55.466853 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:19b5d8cb-88cd-46c5-8fb8-b5915e854291&page=queryresults
[0m19:44:56.415093 [info ] [Thread-1  ]: 4 of 11 PASS not_null_stg_food_reviews_review_id ............................... [[32mPASS[0m in 4.50s]
[0m19:44:56.418073 [debug] [Thread-1  ]: Finished running node test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf
[0m19:44:56.418606 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:44:56.419057 [info ] [Thread-1  ]: 5 of 11 START test source_not_null_raw_data_food_reviews_Rating ................ [RUN]
[0m19:44:56.419606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.not_null_stg_food_reviews_review_id.f5355cfbaf, now test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af)
[0m19:44:56.420007 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:44:56.425663 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:44:56.427008 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:44:56.430533 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"
[0m19:44:56.431397 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Rating
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where Rating is null



  
  
      
    ) dbt_internal_test
[0m19:44:56.431827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:57.637574 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2a0efe8e-a9e8-4680-bbf8-306a15604d54&page=queryresults
[0m19:44:58.898874 [info ] [Thread-1  ]: 5 of 11 PASS source_not_null_raw_data_food_reviews_Rating ...................... [[32mPASS[0m in 2.48s]
[0m19:44:58.900724 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af
[0m19:44:58.901717 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:44:58.902597 [info ] [Thread-1  ]: 6 of 11 START test source_not_null_raw_data_food_reviews_RecipeId .............. [RUN]
[0m19:44:58.903726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_Rating.8992e9b9af, now test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e)
[0m19:44:58.905148 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:44:58.935914 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:44:58.937031 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:44:58.941329 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"
[0m19:44:58.944063 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select RecipeId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where RecipeId is null



  
  
      
    ) dbt_internal_test
[0m19:44:58.945866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:00.613785 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:2a1d119d-7201-4b4e-b15f-27a16ac5ef97&page=queryresults
[0m19:45:01.749827 [info ] [Thread-1  ]: 6 of 11 PASS source_not_null_raw_data_food_reviews_RecipeId .................... [[32mPASS[0m in 2.85s]
[0m19:45:01.751322 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e
[0m19:45:01.752099 [debug] [Thread-1  ]: Began running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:45:01.752860 [info ] [Thread-1  ]: 7 of 11 START test source_not_null_raw_data_food_reviews_ReviewId .............. [RUN]
[0m19:45:01.753677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_RecipeId.f1dfac0b5e, now test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078)
[0m19:45:01.754312 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:45:01.763787 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:45:01.765227 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:45:01.769886 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"
[0m19:45:01.770769 [debug] [Thread-1  ]: On test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ReviewId
from `dbtandbigquery-467100`.`raw`.`food_reviews`
where ReviewId is null



  
  
      
    ) dbt_internal_test
[0m19:45:01.771230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:03.064468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:73041b12-c51c-429b-9d31-62226ed72cb3&page=queryresults
[0m19:45:04.212750 [info ] [Thread-1  ]: 7 of 11 PASS source_not_null_raw_data_food_reviews_ReviewId .................... [[32mPASS[0m in 2.46s]
[0m19:45:04.214053 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078
[0m19:45:04.214770 [debug] [Thread-1  ]: Began running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:45:04.215548 [info ] [Thread-1  ]: 8 of 11 START test source_unique_raw_data_food_reviews_ReviewId ................ [RUN]
[0m19:45:04.216416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_not_null_raw_data_food_reviews_ReviewId.eabe571078, now test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd)
[0m19:45:04.216960 [debug] [Thread-1  ]: Began compiling node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:45:04.227295 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:45:04.229055 [debug] [Thread-1  ]: Began executing node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:45:04.232405 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"
[0m19:45:04.233329 [debug] [Thread-1  ]: On test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ReviewId as unique_field
  from `dbtandbigquery-467100`.`raw`.`food_reviews`
  where ReviewId is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:45:04.233809 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:08.250986 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:9206d9e9-f544-410e-8752-ee7309bb74c9&page=queryresults
[0m19:45:09.057232 [info ] [Thread-1  ]: 8 of 11 PASS source_unique_raw_data_food_reviews_ReviewId ...................... [[32mPASS[0m in 4.84s]
[0m19:45:09.058902 [debug] [Thread-1  ]: Finished running node test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd
[0m19:45:09.059929 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:45:09.060848 [info ] [Thread-1  ]: 9 of 11 START test unique_mart_author_insights_author_id ....................... [RUN]
[0m19:45:09.061938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.source_unique_raw_data_food_reviews_ReviewId.3a2ffc71cd, now test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d)
[0m19:45:09.062687 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:45:09.073725 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:45:09.075274 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:45:09.079672 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"
[0m19:45:09.081182 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select author_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_author_insights`
  where author_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:45:09.081740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:10.584900 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:f1e5bc6a-778f-4cd2-acce-a810ccc114d6&page=queryresults
[0m19:45:11.407449 [info ] [Thread-1  ]: 9 of 11 PASS unique_mart_author_insights_author_id ............................. [[32mPASS[0m in 2.35s]
[0m19:45:11.409079 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d
[0m19:45:11.410141 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:45:11.410949 [info ] [Thread-1  ]: 10 of 11 START test unique_mart_review_metrics_recipe_id ....................... [RUN]
[0m19:45:11.411922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_author_insights_author_id.f1a6e3199d, now test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53)
[0m19:45:11.412518 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:45:11.421871 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:45:11.423546 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:45:11.429502 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"
[0m19:45:11.430518 [debug] [Thread-1  ]: On test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select recipe_id as unique_field
  from `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
  where recipe_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:45:11.431051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:13.001291 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b58817a3-983c-45a2-b43a-e5c92e3d8689&page=queryresults
[0m19:45:13.880047 [info ] [Thread-1  ]: 10 of 11 PASS unique_mart_review_metrics_recipe_id ............................. [[32mPASS[0m in 2.47s]
[0m19:45:13.881790 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53
[0m19:45:13.882711 [debug] [Thread-1  ]: Began running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:45:13.883517 [info ] [Thread-1  ]: 11 of 11 START test unique_stg_food_reviews_review_id .......................... [RUN]
[0m19:45:13.884435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_core.unique_mart_review_metrics_recipe_id.c8e3343d53, now test.dbt_core.unique_stg_food_reviews_review_id.6b56770236)
[0m19:45:13.885074 [debug] [Thread-1  ]: Began compiling node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:45:13.893937 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:45:13.895638 [debug] [Thread-1  ]: Began executing node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:45:13.899434 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"
[0m19:45:13.900515 [debug] [Thread-1  ]: On test.dbt_core.unique_stg_food_reviews_review_id.6b56770236: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "test.dbt_core.unique_stg_food_reviews_review_id.6b56770236"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select review_id as unique_field
  from `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
  where review_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:45:13.901064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:15.035147 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:8170050e-10c3-4899-ad03-174050e9016c&page=queryresults
[0m19:45:15.875841 [info ] [Thread-1  ]: 11 of 11 PASS unique_stg_food_reviews_review_id ................................ [[32mPASS[0m in 1.99s]
[0m19:45:15.877669 [debug] [Thread-1  ]: Finished running node test.dbt_core.unique_stg_food_reviews_review_id.6b56770236
[0m19:45:15.880604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:15.885484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:15.886218 [debug] [MainThread]: Connection 'list_dbtandbigquery-467100_marts' was properly closed.
[0m19:45:15.886762 [debug] [MainThread]: Connection 'test.dbt_core.unique_stg_food_reviews_review_id.6b56770236' was properly closed.
[0m19:45:15.887458 [info ] [MainThread]: 
[0m19:45:15.888086 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 37.55 seconds (37.55s).
[0m19:45:15.892089 [debug] [MainThread]: Command end result
[0m19:45:15.927215 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m19:45:15.930692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m19:45:15.939814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m19:45:15.940330 [info ] [MainThread]: 
[0m19:45:15.940960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:15.941337 [info ] [MainThread]: 
[0m19:45:15.941719 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:45:15.946871 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 41.410423, "process_in_blocks": "0", "process_kernel_time": 0.935098, "process_mem_max_rss": "354582528", "process_out_blocks": "0", "process_user_time": 5.336957}
[0m19:45:15.947811 [debug] [MainThread]: Command `dbt test` succeeded at 19:45:15.947671 after 41.41 seconds
[0m19:45:15.948340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d061c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11066b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144043c40>]}
[0m19:45:15.948843 [debug] [MainThread]: Flushing usage events
[0m19:45:17.483228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:56.134197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10360f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104685bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046851c0>]}


============================== 20:04:56.138594 | 60aca9a0-7df5-407b-9398-48ee28178643 ==============================
[0m20:04:56.138594 [info ] [MainThread]: Running with dbt=1.10.5
[0m20:04:56.139157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bi006217/Documents/study/dbt_bigquery/dbt_core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:04:59.120663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020d5250>]}
[0m20:04:59.179858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a28e0>]}
[0m20:04:59.180527 [info ] [MainThread]: Registered adapter: bigquery=1.10.0
[0m20:04:59.473985 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m20:04:59.677699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:59.678137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:59.737657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee31eb0>]}
[0m20:04:59.854021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m20:04:59.856651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m20:04:59.878644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee4fa30>]}
[0m20:04:59.879193 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 495 macros
[0m20:04:59.879569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee17d90>]}
[0m20:04:59.880982 [info ] [MainThread]: 
[0m20:04:59.881379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:04:59.881695 [info ] [MainThread]: 
[0m20:04:59.882168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:04:59.887063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100'
[0m20:04:59.887516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:01.031829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:02.331775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100, now create_dbtandbigquery-467100_staging)
[0m20:05:02.333251 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "staging"
"
[0m20:05:02.349414 [debug] [ThreadPool]: On create_dbtandbigquery-467100_staging: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_staging"} */
create schema if not exists `dbtandbigquery-467100`.`staging`
  
[0m20:05:02.350003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:03.803296 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:5c6b59ee-b7fc-4edf-ac9a-cc16660ab717&page=queryresults
[0m20:05:04.733150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbtandbigquery-467100_staging, now create_dbtandbigquery-467100_marts)
[0m20:05:04.733785 [debug] [ThreadPool]: Creating schema "database: "dbtandbigquery-467100"
schema: "marts"
"
[0m20:05:04.736407 [debug] [ThreadPool]: On create_dbtandbigquery-467100_marts: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "connection_name": "create_dbtandbigquery-467100_marts"} */
create schema if not exists `dbtandbigquery-467100`.`marts`
  
[0m20:05:04.736784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:05.835261 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:17df6933-fae9-4592-b147-41cdb8d8c305&page=queryresults
[0m20:05:06.924548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbtandbigquery-467100_staging'
[0m20:05:06.937707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:08.570295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_staging, now list_dbtandbigquery-467100_marts)
[0m20:05:08.571358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:09.666713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ee1ca0>]}
[0m20:05:09.668394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:09.679420 [debug] [Thread-1  ]: Began running node model.dbt_core.stg_food_reviews
[0m20:05:09.680613 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.stg_food_reviews .......................... [RUN]
[0m20:05:09.681494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbtandbigquery-467100_marts, now model.dbt_core.stg_food_reviews)
[0m20:05:09.682151 [debug] [Thread-1  ]: Began compiling node model.dbt_core.stg_food_reviews
[0m20:05:09.696042 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.stg_food_reviews"
[0m20:05:09.697426 [debug] [Thread-1  ]: Began executing node model.dbt_core.stg_food_reviews
[0m20:05:09.737936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.stg_food_reviews"
[0m20:05:09.738996 [debug] [Thread-1  ]: On model.dbt_core.stg_food_reviews: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.stg_food_reviews"} */

  
    

    create or replace table `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
      
    
    

    
    OPTIONS()
    as (
      -- 🥈 STAGING LAYER (Silver)
-- Responsible for: Cleaning, Standardization, Renaming, Validation



WITH source_data AS (
    SELECT *
    FROM `dbtandbigquery-467100`.`raw`.`food_reviews`
),

cleaned_data AS (
    SELECT
        -- Standardized IDs
        ReviewId AS review_id,
        RecipeId AS recipe_id,
        AuthorId AS author_id,
        
        -- String cleaning
        TRIM(AuthorName) AS author_name,
        TRIM(Review) AS review_text,
        
        -- Rating standardization
        CASE 
            WHEN Rating BETWEEN 1 AND 5 THEN Rating
            WHEN Rating = 0 THEN NULL  -- Rating 0 is invalid
            ELSE NULL
        END AS rating,
        
        -- Date standardization
        CASE 
            WHEN DateSubmitted IS NOT NULL 
            THEN CAST(DateSubmitted AS TIMESTAMP)
            ELSE NULL
        END AS submitted_at,
        
        CASE 
            WHEN DateModified IS NOT NULL 
            THEN CAST(DateModified AS TIMESTAMP)
            ELSE NULL
        END AS modified_at,
        
        -- Calculated fields
        LENGTH(TRIM(Review)) AS review_length,
        
        -- Quality flags
        CASE 
            WHEN TRIM(Review) = '' OR Review IS NULL THEN FALSE
            ELSE TRUE
        END AS has_review_text,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS loaded_at
        
    FROM source_data
)

SELECT *
FROM cleaned_data
-- Filter only valid reviews
WHERE review_id IS NOT NULL
  AND recipe_id IS NOT NULL
    );
  
[0m20:05:09.739496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:11.121071 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:b09afc2a-6353-4c20-a11a-9b97d54c5f81&page=queryresults
[0m20:05:22.848327 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3d49d0>]}
[0m20:05:22.849569 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.stg_food_reviews ..................... [[32mCREATE TABLE (1.4m rows, 451.1 MiB processed)[0m in 13.16s]
[0m20:05:22.850228 [debug] [Thread-1  ]: Finished running node model.dbt_core.stg_food_reviews
[0m20:05:22.851219 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_author_insights
[0m20:05:22.851790 [info ] [Thread-1  ]: 2 of 3 START sql table model marts.mart_author_insights ........................ [RUN]
[0m20:05:22.852302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.stg_food_reviews, now model.dbt_core.mart_author_insights)
[0m20:05:22.852703 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_author_insights
[0m20:05:22.857901 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_author_insights"
[0m20:05:22.859287 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_author_insights
[0m20:05:22.862694 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_author_insights"
[0m20:05:22.863549 [debug] [Thread-1  ]: On model.dbt_core.mart_author_insights: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_author_insights"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_author_insights`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Author Insights - Reviewer Behavior and Patterns



WITH author_behavior AS (
    SELECT
        author_id,
        author_name,
        
        -- Activity Metrics
        COUNT(*) AS total_reviews_written,
        COUNT(DISTINCT recipe_id) AS unique_recipes_reviewed,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating_given,
        STDDEV(rating) AS rating_variability,
        
        -- Rating Patterns
        COUNTIF(rating = 5) AS five_star_reviews,
        COUNTIF(rating = 1) AS one_star_reviews,
        ROUND(COUNTIF(rating >= 4) / COUNT(*) * 100, 1) AS positive_review_rate,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        MAX(review_length) AS longest_review,
        COUNTIF(has_review_text) AS reviews_with_text,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS reviewing_span_days,
        
        -- Activity Categorization
        CASE 
            WHEN COUNT(*) >= 50 THEN 'Super Active'
            WHEN COUNT(*) >= 20 THEN 'Very Active'
            WHEN COUNT(*) >= 10 THEN 'Active'
            WHEN COUNT(*) >= 5 THEN 'Moderate'
            ELSE 'Casual'
        END AS activity_level,
        
        -- Behavior Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Optimistic'
            WHEN AVG(rating) <= 2.5 THEN 'Critical'
            WHEN STDDEV(rating) <= 0.5 THEN 'Consistent'
            ELSE 'Varied'
        END AS rating_behavior,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE author_id IS NOT NULL
      AND rating IS NOT NULL
    GROUP BY author_id, author_name
)

SELECT *
FROM author_behavior
WHERE total_reviews_written >= 3  -- Only authors with at least 3 reviews
ORDER BY total_reviews_written DESC
    );
  
[0m20:05:22.864064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:25.029610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:af0e6272-1222-4162-b03c-a1f33de678ba&page=queryresults
[0m20:05:31.983190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f545040>]}
[0m20:05:31.986046 [info ] [Thread-1  ]: 2 of 3 OK created sql table model marts.mart_author_insights ................... [[32mCREATE TABLE (42.2k rows, 70.3 MiB processed)[0m in 9.13s]
[0m20:05:31.987311 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_author_insights
[0m20:05:31.988061 [debug] [Thread-1  ]: Began running node model.dbt_core.mart_review_metrics
[0m20:05:31.988990 [info ] [Thread-1  ]: 3 of 3 START sql table model marts.mart_review_metrics ......................... [RUN]
[0m20:05:31.989940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_core.mart_author_insights, now model.dbt_core.mart_review_metrics)
[0m20:05:31.990616 [debug] [Thread-1  ]: Began compiling node model.dbt_core.mart_review_metrics
[0m20:05:31.999975 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_core.mart_review_metrics"
[0m20:05:32.001343 [debug] [Thread-1  ]: Began executing node model.dbt_core.mart_review_metrics
[0m20:05:32.005243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_core.mart_review_metrics"
[0m20:05:32.006361 [debug] [Thread-1  ]: On model.dbt_core.mart_review_metrics: /* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "dbt_core", "target_name": "dev", "node_id": "model.dbt_core.mart_review_metrics"} */

  
    

    create or replace table `dbtandbigquery-467100`.`marts`.`mart_review_metrics`
      
    
    

    
    OPTIONS()
    as (
      -- 🥇 MARTS LAYER (Gold)
-- Review Metrics by Recipe - Ready for BI/Dashboards



WITH recipe_metrics AS (
    SELECT
        recipe_id,
        
        -- Volume Metrics
        COUNT(*) AS total_reviews,
        COUNT(DISTINCT author_id) AS unique_reviewers,
        
        -- Rating Metrics
        ROUND(AVG(rating), 2) AS avg_rating,
        MIN(rating) AS min_rating,
        MAX(rating) AS max_rating,
        
        -- Rating Distribution
        COUNTIF(rating = 5) AS rating_5_count,
        COUNTIF(rating = 4) AS rating_4_count,
        COUNTIF(rating = 3) AS rating_3_count,
        COUNTIF(rating = 2) AS rating_2_count,
        COUNTIF(rating = 1) AS rating_1_count,
        
        -- Text Metrics
        ROUND(AVG(review_length), 0) AS avg_review_length,
        COUNTIF(has_review_text) AS reviews_with_text,
        ROUND(COUNTIF(has_review_text) / COUNT(*) * 100, 1) AS text_completion_rate,
        
        -- Temporal Metrics
        MIN(submitted_at) AS first_review_date,
        MAX(submitted_at) AS latest_review_date,
        DATE_DIFF(MAX(submitted_at), MIN(submitted_at), DAY) AS review_span_days,
        
        -- Popularity Categorization
        CASE 
            WHEN COUNT(*) >= 100 THEN 'High'
            WHEN COUNT(*) >= 50 THEN 'Medium'
            WHEN COUNT(*) >= 10 THEN 'Low'
            ELSE 'Very Low'
        END AS popularity_category,
        
        -- Quality Categorization
        CASE 
            WHEN AVG(rating) >= 4.5 THEN 'Excellent'
            WHEN AVG(rating) >= 4.0 THEN 'Very Good'
            WHEN AVG(rating) >= 3.5 THEN 'Good'
            WHEN AVG(rating) >= 3.0 THEN 'Fair'
            ELSE 'Poor'
        END AS quality_category,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS calculated_at
        
    FROM `dbtandbigquery-467100`.`staging`.`stg_food_reviews`
    WHERE rating IS NOT NULL
    GROUP BY recipe_id
)

SELECT *
FROM recipe_metrics
ORDER BY total_reviews DESC
    );
  
[0m20:05:32.006890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:34.073552 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbtandbigquery-467100&j=bq:us-central1:cf095062-b284-45ab-a230-9d926156287a&page=queryresults
[0m20:05:43.312505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60aca9a0-7df5-407b-9398-48ee28178643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f545040>]}
[0m20:05:43.315069 [info ] [Thread-1  ]: 3 of 3 OK created sql table model marts.mart_review_metrics .................... [[32mCREATE TABLE (265.8k rows, 54.2 MiB processed)[0m in 11.32s]
[0m20:05:43.316481 [debug] [Thread-1  ]: Finished running node model.dbt_core.mart_review_metrics
[0m20:05:43.318968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:43.324163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:43.324948 [debug] [MainThread]: Connection 'create_dbtandbigquery-467100_marts' was properly closed.
[0m20:05:43.325517 [debug] [MainThread]: Connection 'model.dbt_core.mart_review_metrics' was properly closed.
[0m20:05:43.326282 [info ] [MainThread]: 
[0m20:05:43.326949 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 43.44 seconds (43.44s).
[0m20:05:43.328875 [debug] [MainThread]: Command end result
[0m20:05:43.366938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/manifest.json
[0m20:05:43.371882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/semantic_manifest.json
[0m20:05:43.381306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bi006217/Documents/study/dbt_bigquery/dbt_core/target/run_results.json
[0m20:05:43.381705 [info ] [MainThread]: 
[0m20:05:43.382123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:43.382468 [info ] [MainThread]: 
[0m20:05:43.382919 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:05:43.391136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 47.332756, "process_in_blocks": "0", "process_kernel_time": 0.87503, "process_mem_max_rss": "328597504", "process_out_blocks": "0", "process_user_time": 4.703365}
[0m20:05:43.392117 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:43.392018 after 47.33 seconds
[0m20:05:43.393024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10360f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128588700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f9f10>]}
[0m20:05:43.393443 [debug] [MainThread]: Flushing usage events
[0m20:05:45.626615 [debug] [MainThread]: An error was encountered while trying to flush usage events
